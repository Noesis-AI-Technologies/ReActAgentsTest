2025-06-23 18:52:25,266 - __main__ - INFO - Redis初始化成功
2025-06-23 18:52:25,588 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-23 18:52:25,589 - __main__ - INFO - Chat模型初始化成功
2025-06-23 18:52:25,865 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-23 18:52:25,913 - __main__ - INFO - 长期记忆store初始化成功
2025-06-23 18:52:29,124 - __main__ - INFO - Agent初始化成功
2025-06-23 18:52:29,125 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-23 18:52:42,863 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-23 18:52:42,868 - __main__ - INFO - 返回当前系统状态信息:sessions_count=0 active_users={}
2025-06-23 18:52:45,615 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:user_1750675962
2025-06-23 18:52:45,617 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750675962
2025-06-23 18:52:45,618 - __main__ - ERROR - 用户 user_1750675962 的会话不存在
2025-06-23 18:52:45,622 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750675962:04b61489-dc5a-440c-b639-e4bed49f1806
2025-06-23 18:52:45,623 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750675962
2025-06-23 18:52:45,624 - __main__ - ERROR - 用户 user_1750675962:04b61489-dc5a-440c-b639-e4bed49f1806 的会话不存在
2025-06-23 18:54:11,917 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750675962' session_id='04b61489-dc5a-440c-b639-e4bed49f1806' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-23 18:54:11,949 - __main__ - INFO - 成功获取用户ID: user_1750675962 的长期记忆，内容长度: 0 字符
2025-06-23 18:54:11,950 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-23 18:54:11,954 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750675962
2025-06-23 18:54:13,104 - __main__ - ERROR - 处理请求时出错: session_id='04b61489-dc5a-440c-b639-e4bed49f1806' status='error' timestamp=1750676053.1042802 message="处理请求时出错: Error code: 401 - {'error': {'message': '无效的令牌 (request id: 20250623185354456954453aX6W5Pty)', 'type': 'new_api_error'}}" result=None interrupt_data=None
2025-06-23 18:54:13,141 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750675962:04b61489-dc5a-440c-b639-e4bed49f1806
2025-06-23 18:54:13,143 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750675962' session_id='04b61489-dc5a-440c-b639-e4bed49f1806' status='error' message=None last_query='你好' last_updated=1750676053.133924 last_response=AgentResponse(session_id='04b61489-dc5a-440c-b639-e4bed49f1806', status='error', timestamp=1750676053.1042802, message="处理请求时出错: Error code: 401 - {'error': {'message': '无效的令牌 (request id: 20250623185354456954453aX6W5Pty)', 'type': 'new_api_error'}}", result=None, interrupt_data=None)
2025-06-23 18:55:47,260 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-23 18:55:47,266 - __main__ - INFO - 返回当前系统状态信息:sessions_count=1 active_users={'user_1750675962': ['04b61489-dc5a-440c-b639-e4bed49f1806']}
2025-06-23 18:55:48,385 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:user_1750676147
2025-06-23 18:55:48,386 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750676147
2025-06-23 18:55:48,387 - __main__ - ERROR - 用户 user_1750676147 的会话不存在
2025-06-23 18:55:48,390 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750676147:3d976be6-65da-461b-9c2b-bb08f600011b
2025-06-23 18:55:48,392 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750676147
2025-06-23 18:55:48,393 - __main__ - ERROR - 用户 user_1750676147:3d976be6-65da-461b-9c2b-bb08f600011b 的会话不存在
2025-06-23 18:55:52,349 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750676147' session_id='3d976be6-65da-461b-9c2b-bb08f600011b' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-23 18:55:52,354 - __main__ - INFO - 成功获取用户ID: user_1750676147 的长期记忆，内容长度: 0 字符
2025-06-23 18:55:52,354 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-23 18:55:52,355 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750676147
2025-06-23 18:55:53,210 - __main__ - ERROR - 处理请求时出错: session_id='3d976be6-65da-461b-9c2b-bb08f600011b' status='error' timestamp=1750676153.2108607 message="处理请求时出错: Error code: 401 - {'error': {'message': '无效的令牌 (request id: 20250623185534561352730EdGUJXHI)', 'type': 'new_api_error'}}" result=None interrupt_data=None
2025-06-23 18:55:53,220 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750676147:3d976be6-65da-461b-9c2b-bb08f600011b
2025-06-23 18:55:53,222 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750676147' session_id='3d976be6-65da-461b-9c2b-bb08f600011b' status='error' message=None last_query='你好' last_updated=1750676153.2126398 last_response=AgentResponse(session_id='3d976be6-65da-461b-9c2b-bb08f600011b', status='error', timestamp=1750676153.2108607, message="处理请求时出错: Error code: 401 - {'error': {'message': '无效的令牌 (request id: 20250623185534561352730EdGUJXHI)', 'type': 'new_api_error'}}", result=None, interrupt_data=None)
2025-06-23 18:58:24,358 - __main__ - INFO - Redis初始化成功
2025-06-23 18:58:24,744 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-23 18:58:24,745 - __main__ - INFO - Chat模型初始化成功
2025-06-23 18:58:24,803 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-23 18:58:24,816 - __main__ - ERROR - 初始化失败: tuple indices must be integers or slices, not str
2025-06-23 18:58:24,818 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-23 19:00:45,027 - __main__ - INFO - Redis初始化成功
2025-06-23 19:00:45,342 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-23 19:00:45,343 - __main__ - INFO - Chat模型初始化成功
2025-06-23 19:00:45,388 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-23 19:00:45,409 - __main__ - ERROR - 初始化失败: tuple indices must be integers or slices, not str
2025-06-23 19:00:45,411 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-23 19:03:06,264 - __main__ - INFO - Redis初始化成功
2025-06-23 19:03:06,591 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-23 19:03:06,592 - __main__ - INFO - Chat模型初始化成功
2025-06-23 19:03:06,657 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-23 19:03:06,660 - __main__ - INFO - 长期记忆store初始化成功
2025-06-23 19:03:10,405 - __main__ - INFO - Agent初始化成功
2025-06-23 19:03:10,408 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-23 19:03:25,045 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-23 19:03:25,055 - __main__ - INFO - 返回当前系统状态信息:sessions_count=2 active_users={'user_1750676147': ['3d976be6-65da-461b-9c2b-bb08f600011b'], 'user_1750675962': ['04b61489-dc5a-440c-b639-e4bed49f1806']}
2025-06-23 19:03:29,915 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:user_1750676605
2025-06-23 19:03:29,917 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750676605
2025-06-23 19:03:29,917 - __main__ - ERROR - 用户 user_1750676605 的会话不存在
2025-06-23 19:03:29,921 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750676605:d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1
2025-06-23 19:03:29,922 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750676605
2025-06-23 19:03:29,923 - __main__ - ERROR - 用户 user_1750676605:d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1 的会话不存在
2025-06-23 19:03:32,660 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750676605' session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-23 19:03:32,665 - __main__ - INFO - 成功获取用户ID: user_1750676605 的长期记忆，内容长度: 0 字符
2025-06-23 19:03:32,666 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-23 19:03:32,667 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750676605
2025-06-23 19:03:33,756 - __main__ - INFO - 最终智能体回复结果:session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' status='completed' timestamp=1750676613.7566047 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='af1d7df4-ae62-45ba-b712-c6c67832a979'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='0ecbf85d-9aec-491b-888e-97570442e9b4'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1361, 'total_tokens': 1372, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZFVIY5hL5NJdg4Kg5QIUjuj729U', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--5972ea4a-9e63-4b53-ae58-26c97f1b5bb0-0', usage_metadata={'input_tokens': 1361, 'output_tokens': 11, 'total_tokens': 1372, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-23 19:03:33,766 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750676605:d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1
2025-06-23 19:03:33,768 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750676605' session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' status='completed' message=None last_query='你好' last_updated=1750676613.7586262 last_response=AgentResponse(session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1', status='completed', timestamp=1750676613.7566047, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'af1d7df4-ae62-45ba-b712-c6c67832a979'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '0ecbf85d-9aec-491b-888e-97570442e9b4', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1361, 'total_tokens': 1372, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZFVIY5hL5NJdg4Kg5QIUjuj729U', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--5972ea4a-9e63-4b53-ae58-26c97f1b5bb0-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1361, 'output_tokens': 11, 'total_tokens': 1372, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-23 19:05:01,965 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750676605' session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' query='预定酒店' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-23 19:05:01,972 - __main__ - INFO - 成功获取用户ID: user_1750676605 的长期记忆，内容长度: 0 字符
2025-06-23 19:05:01,973 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-23 19:05:03,272 - __main__ - INFO - 最终智能体回复结果:session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' status='completed' timestamp=1750676703.2722385 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='af1d7df4-ae62-45ba-b712-c6c67832a979'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='0ecbf85d-9aec-491b-888e-97570442e9b4'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1361, 'total_tokens': 1372, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZFVIY5hL5NJdg4Kg5QIUjuj729U', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--5972ea4a-9e63-4b53-ae58-26c97f1b5bb0-0', usage_metadata={'input_tokens': 1361, 'output_tokens': 11, 'total_tokens': 1372, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='60d6063a-84b2-4b23-bffe-2a2d90e5c65d'), HumanMessage(content='预定酒店', additional_kwargs={}, response_metadata={}, id='10414822-cf1a-47df-adfb-e6a9be7ec3a2'), AIMessage(content='请告诉我您想预定的酒店名称。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 13, 'prompt_tokens': 1402, 'total_tokens': 1415, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZGwlc3oU3roiJDAHpMMiNyfkOEM', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--9998582e-1e87-4f8c-aee3-7d627439c909-0', usage_metadata={'input_tokens': 1402, 'output_tokens': 13, 'total_tokens': 1415, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-23 19:05:03,282 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750676605:d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1
2025-06-23 19:05:03,285 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750676605' session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' status='completed' message=None last_query='预定酒店' last_updated=1750676703.2742307 last_response=AgentResponse(session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1', status='completed', timestamp=1750676703.2722385, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'af1d7df4-ae62-45ba-b712-c6c67832a979'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '0ecbf85d-9aec-491b-888e-97570442e9b4', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1361, 'total_tokens': 1372, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZFVIY5hL5NJdg4Kg5QIUjuj729U', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--5972ea4a-9e63-4b53-ae58-26c97f1b5bb0-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1361, 'output_tokens': 11, 'total_tokens': 1372, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '60d6063a-84b2-4b23-bffe-2a2d90e5c65d'}, {'content': '预定酒店', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '10414822-cf1a-47df-adfb-e6a9be7ec3a2', 'example': False}, {'content': '请告诉我您想预定的酒店名称。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 13, 'prompt_tokens': 1402, 'total_tokens': 1415, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZGwlc3oU3roiJDAHpMMiNyfkOEM', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--9998582e-1e87-4f8c-aee3-7d627439c909-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1402, 'output_tokens': 13, 'total_tokens': 1415, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-23 19:05:07,606 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750676605' session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' query='汉庭酒店' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-23 19:05:07,611 - __main__ - INFO - 成功获取用户ID: user_1750676605 的长期记忆，内容长度: 0 字符
2025-06-23 19:05:07,611 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-23 19:05:09,056 - __main__ - INFO - 当前触发工具调用中断:session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' status='interrupted' timestamp=1750676709.056847 message=None result=None interrupt_data={'action_request': {'action': 'book_hotel', 'args': {'hotel_name': '汉庭酒店'}}, 'config': None, 'description': "准备调用 book_hotel 工具：\n- 参数为: {'hotel_name': '汉庭酒店'}\n\n是否允许继续？\n输入 'yes' 接受工具调用\n输入 'no' 拒绝工具调用\n输入 'edit' 修改工具参数后调用工具\n输入 'response' 不调用工具直接反馈信息", 'interrupt_type': 'unknown'}
2025-06-23 19:05:20,579 - __main__ - INFO - 调用/agent/resume接口，恢复被中断的智能体运行并等待运行完成或再次中断，接受到前端用户请求:user_id='user_1750676605' session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' response_type='accept' args=None
2025-06-23 19:05:20,588 - utils.tools - INFO - response: {'type': 'accept'}
2025-06-23 19:05:20,589 - utils.tools - INFO - 工具调用已批准，执行中...
2025-06-23 19:05:20,589 - utils.tools - INFO - 调用工具: book_hotel, 参数: {'hotel_name': '汉庭酒店'}
2025-06-23 19:05:20,590 - utils.tools - INFO - 成功预定了在汉庭酒店的住宿。
2025-06-23 19:05:21,913 - __main__ - INFO - 最终智能体回复结果:session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' status='completed' timestamp=1750676721.9129581 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='af1d7df4-ae62-45ba-b712-c6c67832a979'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='0ecbf85d-9aec-491b-888e-97570442e9b4'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1361, 'total_tokens': 1372, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZFVIY5hL5NJdg4Kg5QIUjuj729U', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--5972ea4a-9e63-4b53-ae58-26c97f1b5bb0-0', usage_metadata={'input_tokens': 1361, 'output_tokens': 11, 'total_tokens': 1372, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='60d6063a-84b2-4b23-bffe-2a2d90e5c65d'), HumanMessage(content='预定酒店', additional_kwargs={}, response_metadata={}, id='10414822-cf1a-47df-adfb-e6a9be7ec3a2'), AIMessage(content='请告诉我您想预定的酒店名称。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 13, 'prompt_tokens': 1402, 'total_tokens': 1415, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZGwlc3oU3roiJDAHpMMiNyfkOEM', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--9998582e-1e87-4f8c-aee3-7d627439c909-0', usage_metadata={'input_tokens': 1402, 'output_tokens': 13, 'total_tokens': 1415, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='df8edf3c-4527-4924-8e12-71bd36010e30'), HumanMessage(content='汉庭酒店', additional_kwargs={}, response_metadata={}, id='96f224ad-6c07-4578-a3c0-a5fddf2679a9'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_du0USAEcNWqIJmRlTtj3nW7R', 'function': {'arguments': '{"hotel_name":"汉庭酒店"}', 'name': 'book_hotel'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 19, 'prompt_tokens': 1445, 'total_tokens': 1464, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlZH2Qk3qSKG56UswOp9kJ1dO8PPm', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, id='run--7ff8e094-b2e6-4416-9bd6-9e45951018a0-0', tool_calls=[{'name': 'book_hotel', 'args': {'hotel_name': '汉庭酒店'}, 'id': 'call_du0USAEcNWqIJmRlTtj3nW7R', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1445, 'output_tokens': 19, 'total_tokens': 1464, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='成功预定了在汉庭酒店的住宿。', name='book_hotel', id='4aa3e6f6-94ee-47ce-830c-bb7f7628962c', tool_call_id='call_du0USAEcNWqIJmRlTtj3nW7R'), AIMessage(content='您已成功预定了汉庭酒店的住宿。如果您需要其他帮助，请随时告诉我！', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 24, 'prompt_tokens': 1483, 'total_tokens': 1507, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlZHFsd2ncxww5hOBEjebe4TheLLu', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--51cb7b8e-a047-4cce-ab48-199c81c4a799-0', usage_metadata={'input_tokens': 1483, 'output_tokens': 24, 'total_tokens': 1507, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-23 19:05:21,922 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750676605:d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1
2025-06-23 19:05:21,924 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750676605' session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1' status='completed' message=None last_query='汉庭酒店' last_updated=1750676721.9149826 last_response=AgentResponse(session_id='d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1', status='completed', timestamp=1750676721.9129581, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'af1d7df4-ae62-45ba-b712-c6c67832a979'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '0ecbf85d-9aec-491b-888e-97570442e9b4', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1361, 'total_tokens': 1372, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZFVIY5hL5NJdg4Kg5QIUjuj729U', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--5972ea4a-9e63-4b53-ae58-26c97f1b5bb0-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1361, 'output_tokens': 11, 'total_tokens': 1372, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '60d6063a-84b2-4b23-bffe-2a2d90e5c65d'}, {'content': '预定酒店', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '10414822-cf1a-47df-adfb-e6a9be7ec3a2', 'example': False}, {'content': '请告诉我您想预定的酒店名称。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 13, 'prompt_tokens': 1402, 'total_tokens': 1415, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZGwlc3oU3roiJDAHpMMiNyfkOEM', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--9998582e-1e87-4f8c-aee3-7d627439c909-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1402, 'output_tokens': 13, 'total_tokens': 1415, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'df8edf3c-4527-4924-8e12-71bd36010e30'}, {'content': '汉庭酒店', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '96f224ad-6c07-4578-a3c0-a5fddf2679a9', 'example': False}, {'content': '', 'additional_kwargs': {'tool_calls': [{'id': 'call_du0USAEcNWqIJmRlTtj3nW7R', 'function': {'arguments': '{"hotel_name":"汉庭酒店"}', 'name': 'book_hotel'}, 'type': 'function'}], 'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 19, 'prompt_tokens': 1445, 'total_tokens': 1464, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlZH2Qk3qSKG56UswOp9kJ1dO8PPm', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--7ff8e094-b2e6-4416-9bd6-9e45951018a0-0', 'example': False, 'tool_calls': [{'name': 'book_hotel', 'args': {'hotel_name': '汉庭酒店'}, 'id': 'call_du0USAEcNWqIJmRlTtj3nW7R', 'type': 'tool_call'}], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1445, 'output_tokens': 19, 'total_tokens': 1464, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '成功预定了在汉庭酒店的住宿。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'tool', 'name': 'book_hotel', 'id': '4aa3e6f6-94ee-47ce-830c-bb7f7628962c', 'tool_call_id': 'call_du0USAEcNWqIJmRlTtj3nW7R', 'artifact': None, 'status': 'success'}, {'content': '您已成功预定了汉庭酒店的住宿。如果您需要其他帮助，请随时告诉我！', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 24, 'prompt_tokens': 1483, 'total_tokens': 1507, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlZHFsd2ncxww5hOBEjebe4TheLLu', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--51cb7b8e-a047-4cce-ab48-199c81c4a799-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1483, 'output_tokens': 24, 'total_tokens': 1507, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-23 19:16:06,523 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-23 19:16:15,565 - __main__ - INFO - Redis初始化成功
2025-06-23 19:16:15,882 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-23 19:16:15,883 - __main__ - INFO - Chat模型初始化成功
2025-06-23 19:16:15,948 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-23 19:16:15,951 - __main__ - INFO - 长期记忆store初始化成功
2025-06-23 19:16:19,950 - __main__ - INFO - Agent初始化成功
2025-06-23 19:16:19,950 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-23 19:16:20,013 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:user_1750677376
2025-06-23 19:16:20,016 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750677376
2025-06-23 19:16:20,017 - __main__ - ERROR - 用户 user_1750677376 的会话不存在
2025-06-23 19:16:20,020 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750677376:8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d
2025-06-23 19:16:20,021 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750677376
2025-06-23 19:16:20,022 - __main__ - ERROR - 用户 user_1750677376:8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d 的会话不存在
2025-06-23 19:16:22,685 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750677376' session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d' query='生成图像' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-23 19:16:22,690 - __main__ - INFO - 成功获取用户ID: user_1750677376 的长期记忆，内容长度: 0 字符
2025-06-23 19:16:22,691 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-23 19:16:22,692 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750677376
2025-06-23 19:16:23,995 - __main__ - INFO - 最终智能体回复结果:session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d' status='completed' timestamp=1750677383.995667 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='424ae7f0-eee9-4905-b014-61d2cbfb8d10'), HumanMessage(content='生成图像', additional_kwargs={}, response_metadata={}, id='c37b1460-dd19-46e9-a6ef-5e0df61b4f5e'), AIMessage(content='抱歉，我无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 31, 'prompt_tokens': 1314, 'total_tokens': 1345, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZRvJ31y0gfFuyVVN7r6eqDkwFeK', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--67091af3-c2bb-4e6f-8439-fc8d991735b7-0', usage_metadata={'input_tokens': 1314, 'output_tokens': 31, 'total_tokens': 1345, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-23 19:16:24,005 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750677376:8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d
2025-06-23 19:16:24,008 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750677376' session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d' status='completed' message=None last_query='生成图像' last_updated=1750677383.9978867 last_response=AgentResponse(session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d', status='completed', timestamp=1750677383.995667, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '424ae7f0-eee9-4905-b014-61d2cbfb8d10'}, {'content': '生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c37b1460-dd19-46e9-a6ef-5e0df61b4f5e', 'example': False}, {'content': '抱歉，我无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 31, 'prompt_tokens': 1314, 'total_tokens': 1345, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZRvJ31y0gfFuyVVN7r6eqDkwFeK', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--67091af3-c2bb-4e6f-8439-fc8d991735b7-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1314, 'output_tokens': 31, 'total_tokens': 1345, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-23 19:16:43,627 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750677376' session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d' query='预定酒店' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-23 19:16:43,631 - __main__ - INFO - 成功获取用户ID: user_1750677376 的长期记忆，内容长度: 0 字符
2025-06-23 19:16:43,631 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-23 19:16:46,099 - __main__ - INFO - 最终智能体回复结果:session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d' status='completed' timestamp=1750677406.0988636 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='424ae7f0-eee9-4905-b014-61d2cbfb8d10'), HumanMessage(content='生成图像', additional_kwargs={}, response_metadata={}, id='c37b1460-dd19-46e9-a6ef-5e0df61b4f5e'), AIMessage(content='抱歉，我无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 31, 'prompt_tokens': 1314, 'total_tokens': 1345, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZRvJ31y0gfFuyVVN7r6eqDkwFeK', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--67091af3-c2bb-4e6f-8439-fc8d991735b7-0', usage_metadata={'input_tokens': 1314, 'output_tokens': 31, 'total_tokens': 1345, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='120e18cd-ef1b-43e8-97ad-01cb8f4aa0dc'), HumanMessage(content='预定酒店', additional_kwargs={}, response_metadata={}, id='33be0fec-1f59-466e-b6b2-04b693a53602'), AIMessage(content='请提供以下信息，以便我帮助你预定酒店：\n\n1. 目的地城市\n2. 入住日期\n3. 退房日期\n4. 房间数量\n5. 需要的房间类型（如单人间、双人间、套房等）\n6. 预算范围（如果有的话）\n\n提供这些信息后，我将尽力帮助你找到合适的酒店。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 89, 'prompt_tokens': 1375, 'total_tokens': 1464, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZSGYrxrNCOlkqVlu5Xs73jq3vWP', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--2092147c-33b7-490d-bfb7-66b1163326a9-0', usage_metadata={'input_tokens': 1375, 'output_tokens': 89, 'total_tokens': 1464, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-23 19:16:46,110 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750677376:8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d
2025-06-23 19:16:46,113 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750677376' session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d' status='completed' message=None last_query='预定酒店' last_updated=1750677406.1013157 last_response=AgentResponse(session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d', status='completed', timestamp=1750677406.0988636, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '424ae7f0-eee9-4905-b014-61d2cbfb8d10'}, {'content': '生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c37b1460-dd19-46e9-a6ef-5e0df61b4f5e', 'example': False}, {'content': '抱歉，我无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 31, 'prompt_tokens': 1314, 'total_tokens': 1345, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZRvJ31y0gfFuyVVN7r6eqDkwFeK', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--67091af3-c2bb-4e6f-8439-fc8d991735b7-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1314, 'output_tokens': 31, 'total_tokens': 1345, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '120e18cd-ef1b-43e8-97ad-01cb8f4aa0dc'}, {'content': '预定酒店', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '33be0fec-1f59-466e-b6b2-04b693a53602', 'example': False}, {'content': '请提供以下信息，以便我帮助你预定酒店：\n\n1. 目的地城市\n2. 入住日期\n3. 退房日期\n4. 房间数量\n5. 需要的房间类型（如单人间、双人间、套房等）\n6. 预算范围（如果有的话）\n\n提供这些信息后，我将尽力帮助你找到合适的酒店。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 89, 'prompt_tokens': 1375, 'total_tokens': 1464, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZSGYrxrNCOlkqVlu5Xs73jq3vWP', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--2092147c-33b7-490d-bfb7-66b1163326a9-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1375, 'output_tokens': 89, 'total_tokens': 1464, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-23 19:17:07,277 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-23 19:17:19,769 - __main__ - INFO - Redis初始化成功
2025-06-23 19:17:20,126 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-23 19:17:20,127 - __main__ - INFO - Chat模型初始化成功
2025-06-23 19:17:20,194 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-23 19:17:20,197 - __main__ - INFO - 长期记忆store初始化成功
2025-06-23 19:17:23,759 - __main__ - INFO - Agent初始化成功
2025-06-23 19:17:23,759 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-23 19:17:26,099 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750677376' session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d' query='生成图像' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-23 19:17:26,104 - __main__ - INFO - 成功获取用户ID: user_1750677376 的长期记忆，内容长度: 0 字符
2025-06-23 19:17:26,105 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-23 19:17:27,640 - __main__ - INFO - 最终智能体回复结果:session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d' status='completed' timestamp=1750677447.6404688 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='424ae7f0-eee9-4905-b014-61d2cbfb8d10'), HumanMessage(content='生成图像', additional_kwargs={}, response_metadata={}, id='c37b1460-dd19-46e9-a6ef-5e0df61b4f5e'), AIMessage(content='抱歉，我无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 31, 'prompt_tokens': 1314, 'total_tokens': 1345, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZRvJ31y0gfFuyVVN7r6eqDkwFeK', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--67091af3-c2bb-4e6f-8439-fc8d991735b7-0', usage_metadata={'input_tokens': 1314, 'output_tokens': 31, 'total_tokens': 1345, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='120e18cd-ef1b-43e8-97ad-01cb8f4aa0dc'), HumanMessage(content='预定酒店', additional_kwargs={}, response_metadata={}, id='33be0fec-1f59-466e-b6b2-04b693a53602'), AIMessage(content='请提供以下信息，以便我帮助你预定酒店：\n\n1. 目的地城市\n2. 入住日期\n3. 退房日期\n4. 房间数量\n5. 需要的房间类型（如单人间、双人间、套房等）\n6. 预算范围（如果有的话）\n\n提供这些信息后，我将尽力帮助你找到合适的酒店。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 89, 'prompt_tokens': 1375, 'total_tokens': 1464, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZSGYrxrNCOlkqVlu5Xs73jq3vWP', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--2092147c-33b7-490d-bfb7-66b1163326a9-0', usage_metadata={'input_tokens': 1375, 'output_tokens': 89, 'total_tokens': 1464, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='45b52027-bcec-47e7-b136-0409b5b0984b'), HumanMessage(content='生成图像', additional_kwargs={}, response_metadata={}, id='742b70e6-3b62-49fb-8d74-9d2942008b48'), AIMessage(content='抱歉，我无法生成图像。如果你有其他问题或需要帮助的地方，请告诉我！', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 23, 'prompt_tokens': 1494, 'total_tokens': 1517, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlZSwbc76YP5U25Q9AbiZ3tnEl4Z9', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--93d5a59b-84bf-49ee-9cac-46790be32b46-0', usage_metadata={'input_tokens': 1494, 'output_tokens': 23, 'total_tokens': 1517, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-23 19:17:27,650 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750677376:8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d
2025-06-23 19:17:27,652 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750677376' session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d' status='completed' message=None last_query='生成图像' last_updated=1750677447.6426442 last_response=AgentResponse(session_id='8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d', status='completed', timestamp=1750677447.6404688, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '424ae7f0-eee9-4905-b014-61d2cbfb8d10'}, {'content': '生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c37b1460-dd19-46e9-a6ef-5e0df61b4f5e', 'example': False}, {'content': '抱歉，我无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 31, 'prompt_tokens': 1314, 'total_tokens': 1345, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZRvJ31y0gfFuyVVN7r6eqDkwFeK', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--67091af3-c2bb-4e6f-8439-fc8d991735b7-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1314, 'output_tokens': 31, 'total_tokens': 1345, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '120e18cd-ef1b-43e8-97ad-01cb8f4aa0dc'}, {'content': '预定酒店', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '33be0fec-1f59-466e-b6b2-04b693a53602', 'example': False}, {'content': '请提供以下信息，以便我帮助你预定酒店：\n\n1. 目的地城市\n2. 入住日期\n3. 退房日期\n4. 房间数量\n5. 需要的房间类型（如单人间、双人间、套房等）\n6. 预算范围（如果有的话）\n\n提供这些信息后，我将尽力帮助你找到合适的酒店。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 89, 'prompt_tokens': 1375, 'total_tokens': 1464, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZSGYrxrNCOlkqVlu5Xs73jq3vWP', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--2092147c-33b7-490d-bfb7-66b1163326a9-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1375, 'output_tokens': 89, 'total_tokens': 1464, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '45b52027-bcec-47e7-b136-0409b5b0984b'}, {'content': '生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '742b70e6-3b62-49fb-8d74-9d2942008b48', 'example': False}, {'content': '抱歉，我无法生成图像。如果你有其他问题或需要帮助的地方，请告诉我！', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 23, 'prompt_tokens': 1494, 'total_tokens': 1517, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlZSwbc76YP5U25Q9AbiZ3tnEl4Z9', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--93d5a59b-84bf-49ee-9cac-46790be32b46-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1494, 'output_tokens': 23, 'total_tokens': 1517, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-23 19:17:53,315 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-23 19:17:53,327 - __main__ - INFO - 返回当前系统状态信息:sessions_count=4 active_users={'user_1750677376': ['8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d'], 'user_1750676147': ['3d976be6-65da-461b-9c2b-bb08f600011b'], 'user_1750676605': ['d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1'], 'user_1750675962': ['04b61489-dc5a-440c-b639-e4bed49f1806']}
2025-06-23 19:17:55,957 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-23 19:18:00,126 - __main__ - INFO - Redis初始化成功
2025-06-23 19:18:00,468 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-23 19:18:00,469 - __main__ - INFO - Chat模型初始化成功
2025-06-23 19:18:00,512 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-23 19:18:00,547 - __main__ - INFO - 长期记忆store初始化成功
2025-06-23 19:18:04,116 - __main__ - INFO - Agent初始化成功
2025-06-23 19:18:04,117 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-23 19:18:05,807 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-23 19:18:05,819 - __main__ - INFO - 返回当前系统状态信息:sessions_count=4 active_users={'user_1750677376': ['8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d'], 'user_1750676147': ['3d976be6-65da-461b-9c2b-bb08f600011b'], 'user_1750676605': ['d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1'], 'user_1750675962': ['04b61489-dc5a-440c-b639-e4bed49f1806']}
2025-06-23 19:18:06,359 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:user_1750677485
2025-06-23 19:18:06,360 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750677485
2025-06-23 19:18:06,361 - __main__ - ERROR - 用户 user_1750677485 的会话不存在
2025-06-23 19:18:06,364 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750677485:9c4064ce-2944-4f9f-9b85-75c6e142e7b5
2025-06-23 19:18:06,365 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750677485
2025-06-23 19:18:06,366 - __main__ - ERROR - 用户 user_1750677485:9c4064ce-2944-4f9f-9b85-75c6e142e7b5 的会话不存在
2025-06-23 19:18:11,108 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750677485' session_id='9c4064ce-2944-4f9f-9b85-75c6e142e7b5' query='给我生成图像' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-23 19:18:11,112 - __main__ - INFO - 成功获取用户ID: user_1750677485 的长期记忆，内容长度: 0 字符
2025-06-23 19:18:11,113 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-23 19:18:11,114 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750677485
2025-06-23 19:18:12,594 - __main__ - INFO - 最终智能体回复结果:session_id='9c4064ce-2944-4f9f-9b85-75c6e142e7b5' status='completed' timestamp=1750677492.5938368 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='bfa5d5d1-52bb-4840-8a14-44d8148ae9b3'), HumanMessage(content='给我生成图像', additional_kwargs={}, response_metadata={}, id='c47d4df6-48be-4a3f-8f14-37007189093d'), AIMessage(content='抱歉，我无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 31, 'prompt_tokens': 1316, 'total_tokens': 1347, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1152}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZTfK4sloGgAG4nxzslEaqvbPSIE', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--1e267955-f4e1-4046-92d3-33bd959adb7d-0', usage_metadata={'input_tokens': 1316, 'output_tokens': 31, 'total_tokens': 1347, 'input_token_details': {'audio': 0, 'cache_read': 1152}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-23 19:18:12,604 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750677485:9c4064ce-2944-4f9f-9b85-75c6e142e7b5
2025-06-23 19:18:12,606 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750677485' session_id='9c4064ce-2944-4f9f-9b85-75c6e142e7b5' status='completed' message=None last_query='给我生成图像' last_updated=1750677492.5959759 last_response=AgentResponse(session_id='9c4064ce-2944-4f9f-9b85-75c6e142e7b5', status='completed', timestamp=1750677492.5938368, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'bfa5d5d1-52bb-4840-8a14-44d8148ae9b3'}, {'content': '给我生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c47d4df6-48be-4a3f-8f14-37007189093d', 'example': False}, {'content': '抱歉，我无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 31, 'prompt_tokens': 1316, 'total_tokens': 1347, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1152}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BlZTfK4sloGgAG4nxzslEaqvbPSIE', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--1e267955-f4e1-4046-92d3-33bd959adb7d-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1316, 'output_tokens': 31, 'total_tokens': 1347, 'input_token_details': {'audio': 0, 'cache_read': 1152}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:24:11,217 - __main__ - INFO - Redis初始化成功
2025-06-24 10:24:11,556 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 10:24:11,557 - __main__ - INFO - Chat模型初始化成功
2025-06-24 10:24:11,630 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 10:24:11,634 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 10:24:14,915 - __main__ - INFO - Agent初始化成功
2025-06-24 10:24:14,915 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 10:25:40,937 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 10:25:45,005 - __main__ - INFO - Redis初始化成功
2025-06-24 10:25:45,330 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 10:25:45,331 - __main__ - INFO - Chat模型初始化成功
2025-06-24 10:25:45,385 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 10:25:45,408 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 10:25:49,004 - __main__ - INFO - Agent初始化成功
2025-06-24 10:25:49,005 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 10:26:15,151 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 10:26:15,154 - __main__ - INFO - Removed expired session_id 8c1caf56-4a4b-47a4-a124-d3c4a7f14b9d for user user_1750677376
2025-06-24 10:26:15,155 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750677376
2025-06-24 10:26:15,156 - __main__ - INFO - Removed expired session_id 3d976be6-65da-461b-9c2b-bb08f600011b for user user_1750676147
2025-06-24 10:26:15,157 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750676147
2025-06-24 10:26:15,158 - __main__ - INFO - Removed expired session_id 9c4064ce-2944-4f9f-9b85-75c6e142e7b5 for user user_1750677485
2025-06-24 10:26:15,159 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750677485
2025-06-24 10:26:15,160 - __main__ - INFO - Removed expired session_id d2a100b5-e4ad-4cb7-b34a-c44b18ca87a1 for user user_1750676605
2025-06-24 10:26:15,160 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750676605
2025-06-24 10:26:15,162 - __main__ - INFO - Removed expired session_id 04b61489-dc5a-440c-b639-e4bed49f1806 for user user_1750675962
2025-06-24 10:26:15,162 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750675962
2025-06-24 10:26:15,164 - __main__ - INFO - 返回当前系统状态信息:sessions_count=0 active_users={}
2025-06-24 10:26:16,667 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:user_1750731975
2025-06-24 10:26:16,669 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750731975
2025-06-24 10:26:16,670 - __main__ - ERROR - 用户 user_1750731975 的会话不存在
2025-06-24 10:26:16,673 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750731975:8dd00a70-dc21-4542-b632-962c7a8ec849
2025-06-24 10:26:16,674 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750731975
2025-06-24 10:26:16,675 - __main__ - ERROR - 用户 user_1750731975:8dd00a70-dc21-4542-b632-962c7a8ec849 的会话不存在
2025-06-24 10:26:21,864 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750731975' session_id='8dd00a70-dc21-4542-b632-962c7a8ec849' query='给我生成图像' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:26:21,869 - __main__ - INFO - 成功获取用户ID: user_1750731975 的长期记忆，内容长度: 0 字符
2025-06-24 10:26:21,870 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:26:21,871 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750731975
2025-06-24 10:26:23,025 - __main__ - INFO - 最终智能体回复结果:session_id='8dd00a70-dc21-4542-b632-962c7a8ec849' status='completed' timestamp=1750731983.025003 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='575d9a18-9002-44da-bbba-eb043c38264d'), HumanMessage(content='给我生成图像', additional_kwargs={}, response_metadata={}, id='c72e172c-f9a9-4a4e-9c55-2054eb26f388'), AIMessage(content='请提供您想要生成的图像的描述或主题。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 16, 'prompt_tokens': 1386, 'total_tokens': 1402, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlneY2dpZXL20tHTl8amb63Tg1ofD', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--8fcf9125-be4a-4d84-9859-1a6ee0bc3aa9-0', usage_metadata={'input_tokens': 1386, 'output_tokens': 16, 'total_tokens': 1402, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 10:26:23,035 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750731975:8dd00a70-dc21-4542-b632-962c7a8ec849
2025-06-24 10:26:23,037 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750731975' session_id='8dd00a70-dc21-4542-b632-962c7a8ec849' status='completed' message=None last_query='给我生成图像' last_updated=1750731983.0269191 last_response=AgentResponse(session_id='8dd00a70-dc21-4542-b632-962c7a8ec849', status='completed', timestamp=1750731983.025003, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '575d9a18-9002-44da-bbba-eb043c38264d'}, {'content': '给我生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c72e172c-f9a9-4a4e-9c55-2054eb26f388', 'example': False}, {'content': '请提供您想要生成的图像的描述或主题。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 16, 'prompt_tokens': 1386, 'total_tokens': 1402, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlneY2dpZXL20tHTl8amb63Tg1ofD', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--8fcf9125-be4a-4d84-9859-1a6ee0bc3aa9-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1386, 'output_tokens': 16, 'total_tokens': 1402, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:26:27,564 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='user_1750731975' session_id='8dd00a70-dc21-4542-b632-962c7a8ec849' query='小猫' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:26:27,568 - __main__ - INFO - 成功获取用户ID: user_1750731975 的长期记忆，内容长度: 0 字符
2025-06-24 10:26:27,569 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:26:28,759 - __main__ - INFO - 当前触发工具调用中断:session_id='8dd00a70-dc21-4542-b632-962c7a8ec849' status='interrupted' timestamp=1750731988.7593603 message=None result=None interrupt_data={'action_request': {'action': 'generate_image', 'args': {'prompt': 'A cute kitten playing with a ball of yarn in a cozy living room, with soft sunlight streaming through the window.'}}, 'config': None, 'description': "准备调用 generate_image 工具：\n- 参数为: {'prompt': 'A cute kitten playing with a ball of yarn in a cozy living room, with soft sunlight streaming through the window.'}\n\n是否允许继续？\n输入 'yes' 接受工具调用\n输入 'no' 拒绝工具调用\n输入 'edit' 修改工具参数后调用工具\n输入 'response' 不调用工具直接反馈信息", 'interrupt_type': 'unknown'}
2025-06-24 10:26:41,052 - __main__ - INFO - 调用/agent/resume接口，恢复被中断的智能体运行并等待运行完成或再次中断，接受到前端用户请求:user_id='user_1750731975' session_id='8dd00a70-dc21-4542-b632-962c7a8ec849' response_type='accept' args=None
2025-06-24 10:26:41,062 - utils.tools - INFO - response: {'type': 'accept'}
2025-06-24 10:26:41,063 - utils.tools - INFO - 工具调用已批准，执行中...
2025-06-24 10:26:41,063 - utils.tools - INFO - 调用工具: generate_image, 参数: {'prompt': 'A cute kitten playing with a ball of yarn in a cozy living room, with soft sunlight streaming through the window.'}
2025-06-24 10:26:41,064 - utils.tools - INFO - {'text': '已生成2张图像', 'images': ['https://example.com/image1.jpg', 'https://example.com/image2.jpg'], 'type': 'image_generation'}
2025-06-24 10:26:43,393 - __main__ - INFO - 最终智能体回复结果:session_id='8dd00a70-dc21-4542-b632-962c7a8ec849' status='completed' timestamp=1750732003.393199 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='575d9a18-9002-44da-bbba-eb043c38264d'), HumanMessage(content='给我生成图像', additional_kwargs={}, response_metadata={}, id='c72e172c-f9a9-4a4e-9c55-2054eb26f388'), AIMessage(content='请提供您想要生成的图像的描述或主题。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 16, 'prompt_tokens': 1386, 'total_tokens': 1402, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlneY2dpZXL20tHTl8amb63Tg1ofD', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--8fcf9125-be4a-4d84-9859-1a6ee0bc3aa9-0', usage_metadata={'input_tokens': 1386, 'output_tokens': 16, 'total_tokens': 1402, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='9fae193e-42b6-4280-99ba-cdf62feb5576'), HumanMessage(content='小猫', additional_kwargs={}, response_metadata={}, id='34306150-9166-4438-b3a5-7bde6298d124'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_zrG7RkDEEz94XALqAtf2ZCTg', 'function': {'arguments': '{"prompt":"A cute kitten playing with a ball of yarn in a cozy living room, with soft sunlight streaming through the window."}', 'name': 'generate_image'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 37, 'prompt_tokens': 1431, 'total_tokens': 1468, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blned6G1MECqIPR1MOKuZohpThKPj', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, id='run--75ba6439-86d3-4e72-b351-015989be356d-0', tool_calls=[{'name': 'generate_image', 'args': {'prompt': 'A cute kitten playing with a ball of yarn in a cozy living room, with soft sunlight streaming through the window.'}, 'id': 'call_zrG7RkDEEz94XALqAtf2ZCTg', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1431, 'output_tokens': 37, 'total_tokens': 1468, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='{"text": "已生成2张图像", "images": ["https://example.com/image1.jpg", "https://example.com/image2.jpg"], "type": "image_generation"}', name='generate_image', id='15df45c5-7d2b-401c-a5f0-061fd577d838', tool_call_id='call_zrG7RkDEEz94XALqAtf2ZCTg'), AIMessage(content='我已生成两张关于小猫的图像。您可以查看以下链接：\n\n1. ![图像1](https://example.com/image1.jpg)\n2. ![图像2](https://example.com/image2.jpg)\n\n请查看这些图像！如果您需要其他主题或风格，请告诉我。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 70, 'prompt_tokens': 1514, 'total_tokens': 1584, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blner6nmWnel4L93RQnpXAE2RNhAG', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--73dfe40d-7840-4863-97e1-c269d6a3fcf4-0', usage_metadata={'input_tokens': 1514, 'output_tokens': 70, 'total_tokens': 1584, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 10:26:43,407 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750731975:8dd00a70-dc21-4542-b632-962c7a8ec849
2025-06-24 10:26:43,410 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750731975' session_id='8dd00a70-dc21-4542-b632-962c7a8ec849' status='completed' message=None last_query='小猫' last_updated=1750732003.3973732 last_response=AgentResponse(session_id='8dd00a70-dc21-4542-b632-962c7a8ec849', status='completed', timestamp=1750732003.393199, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '575d9a18-9002-44da-bbba-eb043c38264d'}, {'content': '给我生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c72e172c-f9a9-4a4e-9c55-2054eb26f388', 'example': False}, {'content': '请提供您想要生成的图像的描述或主题。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 16, 'prompt_tokens': 1386, 'total_tokens': 1402, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlneY2dpZXL20tHTl8amb63Tg1ofD', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--8fcf9125-be4a-4d84-9859-1a6ee0bc3aa9-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1386, 'output_tokens': 16, 'total_tokens': 1402, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '9fae193e-42b6-4280-99ba-cdf62feb5576'}, {'content': '小猫', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '34306150-9166-4438-b3a5-7bde6298d124', 'example': False}, {'content': '', 'additional_kwargs': {'tool_calls': [{'id': 'call_zrG7RkDEEz94XALqAtf2ZCTg', 'function': {'arguments': '{"prompt":"A cute kitten playing with a ball of yarn in a cozy living room, with soft sunlight streaming through the window."}', 'name': 'generate_image'}, 'type': 'function'}], 'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 37, 'prompt_tokens': 1431, 'total_tokens': 1468, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blned6G1MECqIPR1MOKuZohpThKPj', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--75ba6439-86d3-4e72-b351-015989be356d-0', 'example': False, 'tool_calls': [{'name': 'generate_image', 'args': {'prompt': 'A cute kitten playing with a ball of yarn in a cozy living room, with soft sunlight streaming through the window.'}, 'id': 'call_zrG7RkDEEz94XALqAtf2ZCTg', 'type': 'tool_call'}], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1431, 'output_tokens': 37, 'total_tokens': 1468, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '{"text": "已生成2张图像", "images": ["https://example.com/image1.jpg", "https://example.com/image2.jpg"], "type": "image_generation"}', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'tool', 'name': 'generate_image', 'id': '15df45c5-7d2b-401c-a5f0-061fd577d838', 'tool_call_id': 'call_zrG7RkDEEz94XALqAtf2ZCTg', 'artifact': None, 'status': 'success'}, {'content': '我已生成两张关于小猫的图像。您可以查看以下链接：\n\n1. ![图像1](https://example.com/image1.jpg)\n2. ![图像2](https://example.com/image2.jpg)\n\n请查看这些图像！如果您需要其他主题或风格，请告诉我。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 70, 'prompt_tokens': 1514, 'total_tokens': 1584, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blner6nmWnel4L93RQnpXAE2RNhAG', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--73dfe40d-7840-4863-97e1-c269d6a3fcf4-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1514, 'output_tokens': 70, 'total_tokens': 1584, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:34:45,742 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 10:34:50,652 - __main__ - INFO - Redis初始化成功
2025-06-24 10:34:50,989 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 10:34:50,990 - __main__ - INFO - Chat模型初始化成功
2025-06-24 10:34:51,030 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 10:34:51,063 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 10:34:54,551 - __main__ - INFO - Agent初始化成功
2025-06-24 10:34:54,552 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 10:34:56,704 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 10:34:56,711 - __main__ - INFO - 返回当前系统状态信息:sessions_count=1 active_users={'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849']}
2025-06-24 10:34:58,685 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:user_1750732496
2025-06-24 10:34:58,687 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750732496
2025-06-24 10:34:58,687 - __main__ - ERROR - 用户 user_1750732496 的会话不存在
2025-06-24 10:34:58,691 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750732496:281afed9-c8ca-4fff-8e22-8db79e29d6a0
2025-06-24 10:34:58,692 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750732496
2025-06-24 10:34:58,693 - __main__ - ERROR - 用户 user_1750732496:281afed9-c8ca-4fff-8e22-8db79e29d6a0 的会话不存在
2025-06-24 10:35:01,977 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='user_1750732496' session_id='281afed9-c8ca-4fff-8e22-8db79e29d6a0' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:35:01,983 - __main__ - INFO - 成功获取用户ID: user_1750732496 的长期记忆，内容长度: 0 字符
2025-06-24 10:35:01,984 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:35:01,985 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750732496
2025-06-24 10:35:02,943 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750732496:281afed9-c8ca-4fff-8e22-8db79e29d6a0
2025-06-24 10:35:02,947 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750732496' session_id='281afed9-c8ca-4fff-8e22-8db79e29d6a0' status='error' message=None last_query='你好' last_updated=1750732502.9392004 last_response=AgentResponse(session_id='281afed9-c8ca-4fff-8e22-8db79e29d6a0', status='error', timestamp=1750732502.9391851, message="处理请求时出错: string indices must be integers, not 'str'", result=None, interrupt_data=None)
2025-06-24 10:37:10,373 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='test_user' session_id='test_session_001' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:37:10,378 - __main__ - INFO - 成功获取用户ID: test_user 的长期记忆，内容长度: 0 字符
2025-06-24 10:37:10,378 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:37:10,379 - __main__ - INFO - Deleted empty user_sessions collection for user test_user
2025-06-24 10:37:11,289 - __main__ - ERROR - 流式处理时出错: string indices must be integers, not 'str'
2025-06-24 10:38:15,888 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='test_user' session_id='test_session_002' query='你好，请介绍一下你自己' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:38:15,892 - __main__ - INFO - 成功获取用户ID: test_user 的长期记忆，内容长度: 0 字符
2025-06-24 10:38:15,893 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:38:17,272 - __main__ - ERROR - 流式处理时出错: string indices must be integers, not 'str'
2025-06-24 10:39:01,503 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='test_user' session_id='test_session_003' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:39:01,509 - __main__ - INFO - 成功获取用户ID: test_user 的长期记忆，内容长度: 0 字符
2025-06-24 10:39:01,509 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:39:02,472 - __main__ - ERROR - 流式处理时出错: string indices must be integers, not 'str'
2025-06-24 10:40:27,198 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='test_user' session_id='test_session_004' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:40:27,205 - __main__ - INFO - 成功获取用户ID: test_user 的长期记忆，内容长度: 0 字符
2025-06-24 10:40:27,205 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:40:28,278 - __main__ - ERROR - 流式处理时出错: string indices must be integers, not 'str'
2025-06-24 10:41:52,513 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='test_user' session_id='test_session_005' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:41:52,517 - __main__ - INFO - 成功获取用户ID: test_user 的长期记忆，内容长度: 0 字符
2025-06-24 10:41:52,518 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:41:53,535 - __main__ - ERROR - 流式处理时出错: string indices must be integers, not 'str'
2025-06-24 10:42:03,513 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='test_user' session_id='test_session_regular' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:42:03,516 - __main__ - INFO - 成功获取用户ID: test_user 的长期记忆，内容长度: 0 字符
2025-06-24 10:42:03,517 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:42:04,953 - __main__ - INFO - 最终智能体回复结果:session_id='test_session_regular' status='completed' timestamp=1750732924.95309 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='6fd99e36-efd7-4b73-9fa4-3a3aed1a609a'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='19f077c2-d764-491d-8a0b-652481ebe830'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1382, 'total_tokens': 1393, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blntj57d7J8Q4KiZB1An8N1t7HlN4', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--378c1f47-8ebc-400c-813f-92111e2f82cb-0', usage_metadata={'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 10:43:27,179 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 10:43:48,407 - __main__ - INFO - Redis初始化成功
2025-06-24 10:43:48,730 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 10:43:48,731 - __main__ - INFO - Chat模型初始化成功
2025-06-24 10:43:48,779 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 10:43:48,799 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 10:43:52,290 - __main__ - INFO - Agent初始化成功
2025-06-24 10:43:52,290 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 10:43:54,501 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='user_1750732496' session_id='281afed9-c8ca-4fff-8e22-8db79e29d6a0' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:43:54,506 - __main__ - INFO - 成功获取用户ID: user_1750732496 的长期记忆，内容长度: 0 字符
2025-06-24 10:43:54,507 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:43:54,511 - __main__ - INFO - 开始流式处理（简化版本）
2025-06-24 10:43:55,787 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750732496:281afed9-c8ca-4fff-8e22-8db79e29d6a0
2025-06-24 10:43:55,789 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750732496' session_id='281afed9-c8ca-4fff-8e22-8db79e29d6a0' status='completed' message=None last_query='你好' last_updated=1750733035.7803054 last_response=AgentResponse(session_id='281afed9-c8ca-4fff-8e22-8db79e29d6a0', status='completed', timestamp=1750733035.7802744, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '4ac96441-ef56-4a03-a5d8-97ddf2b38c64'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '385a781e-8eca-4ee1-bf6a-620793cf7872', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--07de3b5b-c9d7-4167-97c2-8d9af0fd61a1', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'a25d6d2b-2f67-45ef-add5-1d414fc01ab6'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'aa05188e-cdc8-4e05-9c68-11634521c9a3', 'example': False}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '4194277d-0e6f-4060-b282-aaad98773ded'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '4530aab0-eb06-4e48-8186-b5bfcfb4ea89', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1447, 'total_tokens': 1458, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlnvXz7s4RZgkH2RVd9qT47aIoKPV', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--eabf29d0-66de-4e9e-be0a-e7739958a52c-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1447, 'output_tokens': 11, 'total_tokens': 1458, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:44:13,942 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='user_1750732496' session_id='281afed9-c8ca-4fff-8e22-8db79e29d6a0' query='给我输出200字的文字，随便内容' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:44:13,947 - __main__ - INFO - 成功获取用户ID: user_1750732496 的长期记忆，内容长度: 0 字符
2025-06-24 10:44:13,947 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:44:13,950 - __main__ - INFO - 开始流式处理（简化版本）
2025-06-24 10:44:23,764 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750732496:281afed9-c8ca-4fff-8e22-8db79e29d6a0
2025-06-24 10:44:23,767 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750732496' session_id='281afed9-c8ca-4fff-8e22-8db79e29d6a0' status='completed' message=None last_query='给我输出200字的文字，随便内容' last_updated=1750733063.7582777 last_response=AgentResponse(session_id='281afed9-c8ca-4fff-8e22-8db79e29d6a0', status='completed', timestamp=1750733063.7582405, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '4ac96441-ef56-4a03-a5d8-97ddf2b38c64'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '385a781e-8eca-4ee1-bf6a-620793cf7872', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--07de3b5b-c9d7-4167-97c2-8d9af0fd61a1', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'a25d6d2b-2f67-45ef-add5-1d414fc01ab6'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'aa05188e-cdc8-4e05-9c68-11634521c9a3', 'example': False}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '4194277d-0e6f-4060-b282-aaad98773ded'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '4530aab0-eb06-4e48-8186-b5bfcfb4ea89', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1447, 'total_tokens': 1458, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlnvXz7s4RZgkH2RVd9qT47aIoKPV', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--eabf29d0-66de-4e9e-be0a-e7739958a52c-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1447, 'output_tokens': 11, 'total_tokens': 1458, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '4e583969-754f-47bd-b7d5-17348c43b5b6'}, {'content': '给我输出200字的文字，随便内容', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'f9ee9f8b-c3d8-4b71-8171-c2c2d1b9bc95', 'example': False}, {'content': '在一个阳光明媚的早晨，小镇上的人们开始了一天的忙碌。街道两旁的花朵竞相开放，散发出迷人的香气。孩子们在公园里嬉戏，欢声笑语回荡在空气中。老奶奶坐在长椅上，手中拿着一本书，时不时抬头欣赏周围的美景。\n\n镇上的咖啡馆里，顾客们享受着香浓的咖啡和新鲜出炉的面包。店主热情地招呼着每一位客人，脸上挂着温暖的笑容。人们在这里交流着生活的点滴，分享着彼此的故事。\n\n随着时间的推移，阳光逐渐升高，照耀着整个小镇。商店的门口挂起了五彩斑斓的招牌，吸引着路过的行人。小镇的生活就这样在平凡中流淌，充满了温馨与快乐。每个人都在为自己的梦想而努力，尽管生活有时会遇到挑战，但他们始终相信，明天会更好。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 266, 'prompt_tokens': 1496, 'total_tokens': 1762, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BlnvqjOZroRlnd1Y21JXZXiu1mOuf', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--921d377a-a48b-4b94-a592-2ac9ab58f667-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1496, 'output_tokens': 266, 'total_tokens': 1762, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:48:27,483 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 10:48:33,410 - __main__ - INFO - Redis初始化成功
2025-06-24 10:48:33,756 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 10:48:33,757 - __main__ - INFO - Chat模型初始化成功
2025-06-24 10:48:33,822 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 10:48:33,836 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 10:48:37,537 - __main__ - INFO - Agent初始化成功
2025-06-24 10:48:37,538 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 10:48:40,484 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 10:48:40,498 - __main__ - INFO - 返回当前系统状态信息:sessions_count=8 active_users={'user_1750732496': ['281afed9-c8ca-4fff-8e22-8db79e29d6a0'], 'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849'], 'test_user': ['test_session_003', 'test_session_002', 'test_session_004', 'test_session_regular', 'test_session_001', 'test_session_005']}
2025-06-24 10:48:44,155 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:你好
2025-06-24 10:48:44,157 - __main__ - INFO - Deleted empty user_sessions collection for user 你好
2025-06-24 10:48:44,158 - __main__ - ERROR - 用户 你好 的会话不存在
2025-06-24 10:48:44,161 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:你好:c3319805-49d6-4e6f-9a0c-21ef94b55d67
2025-06-24 10:48:44,163 - __main__ - INFO - Deleted empty user_sessions collection for user 你好
2025-06-24 10:48:44,163 - __main__ - ERROR - 用户 你好:c3319805-49d6-4e6f-9a0c-21ef94b55d67 的会话不存在
2025-06-24 10:48:48,864 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='你好' session_id='c3319805-49d6-4e6f-9a0c-21ef94b55d67' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:48:48,869 - __main__ - INFO - 成功获取用户ID: 你好 的长期记忆，内容长度: 0 字符
2025-06-24 10:48:48,870 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:48:48,871 - __main__ - INFO - Deleted empty user_sessions collection for user 你好
2025-06-24 10:48:48,873 - __main__ - INFO - 开始LangGraph官方推荐的流式处理
2025-06-24 10:48:50,019 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,019 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,019 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,021 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,031 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,041 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,056 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,066 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,096 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,097 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,102 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:50,124 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:48:51,704 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:你好:c3319805-49d6-4e6f-9a0c-21ef94b55d67
2025-06-24 10:48:51,707 - __main__ - INFO - 返回当前用户的会话状态:user_id='你好' session_id='c3319805-49d6-4e6f-9a0c-21ef94b55d67' status='completed' message=None last_query='你好' last_updated=1750733331.697829 last_response=AgentResponse(session_id='c3319805-49d6-4e6f-9a0c-21ef94b55d67', status='completed', timestamp=1750733331.6978087, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '04bea028-7642-4f2f-a9a0-a6052c5fd70d'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'b1a5d877-4dbb-4ba5-aaba-831f38b7ad61', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--d2c33ded-ea0b-491c-96f2-664ab357a2d7', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'c6029fb0-11e7-4d40-9fef-d42766c31f04'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'dba908ee-dac9-4046-9c88-72ff51d81d3e', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo0I5bt5resLmZRuoobI5bAfX3Z7', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--e16d4a6b-3cea-4a14-88c3-84e04effbeda-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:49:02,597 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='你好' session_id='c3319805-49d6-4e6f-9a0c-21ef94b55d67' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:49:02,602 - __main__ - INFO - 成功获取用户ID: 你好 的长期记忆，内容长度: 0 字符
2025-06-24 10:49:02,603 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:49:02,606 - __main__ - INFO - 开始LangGraph官方推荐的流式处理
2025-06-24 10:49:03,277 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,278 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,281 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,287 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,295 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,303 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,318 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,319 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,328 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,336 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,346 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:03,372 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:04,393 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:你好:c3319805-49d6-4e6f-9a0c-21ef94b55d67
2025-06-24 10:49:04,396 - __main__ - INFO - 返回当前用户的会话状态:user_id='你好' session_id='c3319805-49d6-4e6f-9a0c-21ef94b55d67' status='completed' message=None last_query='你好' last_updated=1750733344.3874671 last_response=AgentResponse(session_id='c3319805-49d6-4e6f-9a0c-21ef94b55d67', status='completed', timestamp=1750733344.3874469, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '04bea028-7642-4f2f-a9a0-a6052c5fd70d'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'b1a5d877-4dbb-4ba5-aaba-831f38b7ad61', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--d2c33ded-ea0b-491c-96f2-664ab357a2d7', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'c6029fb0-11e7-4d40-9fef-d42766c31f04'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'dba908ee-dac9-4046-9c88-72ff51d81d3e', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo0I5bt5resLmZRuoobI5bAfX3Z7', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--e16d4a6b-3cea-4a14-88c3-84e04effbeda-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '8a946fd0-25ec-49bd-b856-4958a955dd85'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c8c16504-cad2-4686-b341-13d06a081742', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--52fd40b7-a026-4b43-9440-a489c769a885', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1460, 'output_tokens': 11, 'total_tokens': 1471, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '1fb07705-b398-4a01-bea8-59fc157f86de'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'ac5b6545-c6d6-4a5d-9558-2372cfb935bc', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1499, 'total_tokens': 1510, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo0VkG8QvVhqvqiT02VOobnu9sUK', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--6b07e25b-0d2f-4eca-9567-0143b6e3dd0f-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1499, 'output_tokens': 11, 'total_tokens': 1510, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:49:22,637 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='你好' session_id='c3319805-49d6-4e6f-9a0c-21ef94b55d67' query='输出一段文字，200字' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:49:22,641 - __main__ - INFO - 成功获取用户ID: 你好 的长期记忆，内容长度: 0 字符
2025-06-24 10:49:22,641 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:49:22,645 - __main__ - INFO - 开始LangGraph官方推荐的流式处理
2025-06-24 10:49:23,675 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,675 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,685 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,695 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,716 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,726 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,761 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,762 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,787 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,813 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,860 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,918 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:23,983 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,040 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,099 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,114 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,128 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,149 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,154 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,177 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,185 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,201 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,213 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,228 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,246 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,258 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,278 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,281 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,308 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,314 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,333 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,357 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,359 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,382 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,392 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,408 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,425 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,436 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,451 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,462 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,481 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,491 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,508 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,522 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,547 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,547 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,563 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,573 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,582 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,604 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,614 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,627 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,644 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,658 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,673 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,684 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,740 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,743 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,747 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,748 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,748 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,753 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,761 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,771 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,812 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,819 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,837 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,848 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,855 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,866 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,878 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,889 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,902 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,914 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,934 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,946 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,950 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,960 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,984 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:24,986 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,004 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,013 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,025 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,039 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,052 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,056 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,069 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,081 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,089 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,100 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,106 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,118 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,125 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,138 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,145 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,157 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,166 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,173 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,192 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,194 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,207 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,225 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,227 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,323 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,324 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,325 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,327 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,327 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,328 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,348 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,349 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,350 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,409 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,411 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,412 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,413 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,437 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,444 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,458 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,474 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,494 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,502 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,520 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,532 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,556 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,562 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,575 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,602 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,617 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,626 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,652 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,665 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,674 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,692 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,736 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,747 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,750 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,821 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,876 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:25,936 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,001 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,024 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,042 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,071 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,081 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,094 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,121 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,130 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,150 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,166 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,186 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,194 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,210 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,223 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,243 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,254 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,286 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,323 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,325 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,327 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,339 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,361 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,365 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,383 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,411 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,417 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,455 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,456 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,504 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,555 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,556 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,574 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,594 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,602 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,616 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,634 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,645 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,664 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,673 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,693 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,706 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,723 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,742 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,750 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,759 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,774 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,786 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,802 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,815 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,827 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,840 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,852 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,864 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,878 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,893 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,922 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,933 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,954 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,962 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,972 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,991 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:26,994 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,011 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,027 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,039 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,047 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,059 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,079 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,094 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,111 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,121 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,135 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,147 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,163 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,175 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:27,196 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:49:31,997 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:你好:c3319805-49d6-4e6f-9a0c-21ef94b55d67
2025-06-24 10:49:32,000 - __main__ - INFO - 返回当前用户的会话状态:user_id='你好' session_id='c3319805-49d6-4e6f-9a0c-21ef94b55d67' status='completed' message=None last_query='输出一段文字，200字' last_updated=1750733371.991168 last_response=AgentResponse(session_id='c3319805-49d6-4e6f-9a0c-21ef94b55d67', status='completed', timestamp=1750733371.9911504, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '04bea028-7642-4f2f-a9a0-a6052c5fd70d'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'b1a5d877-4dbb-4ba5-aaba-831f38b7ad61', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--d2c33ded-ea0b-491c-96f2-664ab357a2d7', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'c6029fb0-11e7-4d40-9fef-d42766c31f04'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'dba908ee-dac9-4046-9c88-72ff51d81d3e', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo0I5bt5resLmZRuoobI5bAfX3Z7', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--e16d4a6b-3cea-4a14-88c3-84e04effbeda-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '8a946fd0-25ec-49bd-b856-4958a955dd85'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c8c16504-cad2-4686-b341-13d06a081742', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--52fd40b7-a026-4b43-9440-a489c769a885', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1460, 'output_tokens': 11, 'total_tokens': 1471, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '1fb07705-b398-4a01-bea8-59fc157f86de'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'ac5b6545-c6d6-4a5d-9558-2372cfb935bc', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1499, 'total_tokens': 1510, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo0VkG8QvVhqvqiT02VOobnu9sUK', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--6b07e25b-0d2f-4eca-9567-0143b6e3dd0f-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1499, 'output_tokens': 11, 'total_tokens': 1510, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '93e179c2-ff47-49ae-b3cf-79e9d6cb2e2c'}, {'content': '输出一段文字，200字', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '253f429a-bdd2-4cf3-b928-b4e88d73502a', 'example': False}, {'content': '在现代社会，科技的迅猛发展改变了我们的生活方式。智能手机、互联网和人工智能等技术的普及，使得信息获取变得更加便捷。人们可以随时随地通过手机浏览新闻、社交媒体，与朋友保持联系，甚至进行在线购物。这种便利性虽然提升了生活质量，但也带来了信息过载的问题。我们每天接收到大量的信息，如何筛选和处理这些信息成为了一项重要的技能。\n\n与此同时，科技的发展也在改变我们的工作方式。远程办公、在线会议和协作工具的兴起，使得人们可以在家中高效工作，打破了传统办公环境的限制。这种灵活性为员工提供了更多的选择，但也让工作与生活的界限变得模糊。\n\n总的来说，科技的进步为我们带来了许多机遇和挑战。我们需要不断适应这些变化，提升自身的能力，以更好地应对未来的生活和工作。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--5a06bee7-89cf-4c5e-8a80-6bc31842eb4a', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1544, 'output_tokens': 216, 'total_tokens': 1760, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'a4ce1b13-043f-463c-a439-11b9f4621fc7'}, {'content': '输出一段文字，200字', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'd9d9782e-594c-4266-be22-9de641f09afb', 'example': False}, {'content': '在当今快速发展的社会中，科技的进步深刻地影响着我们的日常生活。智能手机的普及使得信息获取变得前所未有的便捷。无论是社交媒体、在线购物还是即时通讯，科技都在不断地改变着我们的交流方式和消费习惯。同时，互联网的广泛应用也让我们能够轻松地获取全球各地的新闻和知识，拓宽了我们的视野。\n\n然而，科技带来的便利也伴随着一些挑战。信息过载成为了现代人面临的一大问题，如何在海量的信息中筛选出有价值的内容，成为了每个人都需要面对的课题。此外，随着远程办公的兴起，工作与生活的界限变得愈加模糊，如何平衡工作与个人生活也成为了许多人关注的焦点。\n\n总之，科技的进步为我们带来了机遇与挑战，我们需要不断适应这些变化，提升自身的能力，以更好地应对未来的生活和工作。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 230, 'prompt_tokens': 1794, 'total_tokens': 2024, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1664}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo0tN9pdg7NMNxKYIs2hBpr57KLL', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--646d1e1c-bbea-43b2-a6a0-0643e84c84fd-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1794, 'output_tokens': 230, 'total_tokens': 2024, 'input_token_details': {'audio': 0, 'cache_read': 1664}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:51:51,341 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 10:51:54,845 - __main__ - INFO - Redis初始化成功
2025-06-24 10:51:55,168 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 10:51:55,169 - __main__ - INFO - Chat模型初始化成功
2025-06-24 10:51:55,206 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 10:51:55,235 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 10:51:58,968 - __main__ - INFO - Agent初始化成功
2025-06-24 10:51:58,969 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 10:52:01,697 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 10:52:01,718 - __main__ - INFO - 返回当前系统状态信息:sessions_count=9 active_users={'user_1750732496': ['281afed9-c8ca-4fff-8e22-8db79e29d6a0'], '你好': ['c3319805-49d6-4e6f-9a0c-21ef94b55d67'], 'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849'], 'test_user': ['test_session_003', 'test_session_004', 'test_session_001', 'test_session_005', 'test_session_002', 'test_session_regular']}
2025-06-24 10:52:04,294 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:user_1750733521
2025-06-24 10:52:04,296 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750733521
2025-06-24 10:52:04,297 - __main__ - ERROR - 用户 user_1750733521 的会话不存在
2025-06-24 10:52:04,300 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750733521:cda5c313-6c91-400c-b85a-7cad2a2e9548
2025-06-24 10:52:04,301 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750733521
2025-06-24 10:52:04,302 - __main__ - ERROR - 用户 user_1750733521:cda5c313-6c91-400c-b85a-7cad2a2e9548 的会话不存在
2025-06-24 10:52:06,172 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='user_1750733521' session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:52:06,177 - __main__ - INFO - 成功获取用户ID: user_1750733521 的长期记忆，内容长度: 0 字符
2025-06-24 10:52:06,177 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:52:06,179 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750733521
2025-06-24 10:52:06,181 - __main__ - INFO - 开始LangGraph官方推荐的流式处理
2025-06-24 10:52:07,024 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,025 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,025 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,027 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,044 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,046 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,060 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,066 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,071 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,078 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,155 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:07,180 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:08,066 - __main__ - INFO - 发送完成信号，accumulated_content长度: 0
2025-06-24 10:52:08,074 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750733521:cda5c313-6c91-400c-b85a-7cad2a2e9548
2025-06-24 10:52:08,077 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750733521' session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548' status='completed' message=None last_query='你好' last_updated=1750733528.0674086 last_response=AgentResponse(session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548', status='completed', timestamp=1750733528.0673842, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '0d818188-1f20-4f8c-9192-87234bbcc5e2'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '08dbdc10-972a-4177-bf21-ba5f3bcfb7e4', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--05305f43-7f7c-460f-82ba-3f754e6d32f9', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '979ab747-e19c-417b-a069-672428e43417'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '62953287-17e8-4ca6-99d9-3a8582e3a4d8', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo3TmVYSTRDsfvawURN1h628JlJT', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--ba29e480-0855-4e64-8510-2e992386055c-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:52:18,865 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='user_1750733521' session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548' query='给我输出一段文本，200字' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:52:18,869 - __main__ - INFO - 成功获取用户ID: user_1750733521 的长期记忆，内容长度: 0 字符
2025-06-24 10:52:18,869 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:52:18,872 - __main__ - INFO - 开始LangGraph官方推荐的流式处理
2025-06-24 10:52:19,571 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,572 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,572 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,576 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,642 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,691 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,723 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,743 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,754 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,765 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,818 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,827 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,842 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,853 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,873 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,880 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,902 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,919 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,934 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,947 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,962 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,971 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:19,991 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,002 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,014 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,028 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,041 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,064 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,082 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,101 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,102 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,147 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,150 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,162 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,177 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,186 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,196 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,210 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,232 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,239 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,248 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,269 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,285 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,313 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,327 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,359 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,383 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,398 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,418 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,438 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,474 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,477 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,531 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,542 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,559 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,568 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,583 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,600 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,616 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,623 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,644 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,677 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,702 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,719 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,776 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,787 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,835 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,850 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,905 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,929 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,940 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,956 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,971 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,981 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:20,999 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,009 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,028 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,042 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,057 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,067 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,081 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,096 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,108 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,121 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,134 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,147 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,170 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,173 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,382 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,482 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,483 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,509 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,518 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,536 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,550 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,566 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,588 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,736 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,757 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,795 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,859 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,918 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:21,975 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,043 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,111 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,180 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,241 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,293 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,354 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,420 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,487 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,549 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,600 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,654 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,679 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,729 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,756 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,772 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,876 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,876 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,877 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,932 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:22,994 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,059 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,124 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,165 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,189 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,205 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,225 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,237 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,253 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,271 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,288 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,304 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,319 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,335 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,353 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,365 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,381 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,401 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,417 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,434 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,452 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,465 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,484 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,505 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,519 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,541 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,548 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,573 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,585 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,604 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,620 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,634 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,650 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,672 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,681 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,695 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,710 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,735 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,741 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,763 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,781 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,795 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,810 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,826 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,842 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,858 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,921 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,929 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,960 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,966 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:23,993 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,008 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,025 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,041 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,054 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,070 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,083 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,103 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,117 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,133 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,149 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,162 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,176 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,190 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,206 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,221 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,234 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,248 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,263 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,279 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,290 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,309 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,321 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,345 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,365 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,389 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,398 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,414 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,431 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,443 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,499 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,509 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,525 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,540 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,555 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,570 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,583 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,598 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,614 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,632 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,647 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,663 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,677 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,706 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,710 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:24,730 - __main__ - DEBUG - 流式消息类型: AIMessageChunk
2025-06-24 10:52:27,077 - __main__ - INFO - 发送完成信号，accumulated_content长度: 0
2025-06-24 10:52:27,086 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750733521:cda5c313-6c91-400c-b85a-7cad2a2e9548
2025-06-24 10:52:27,089 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750733521' session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548' status='completed' message=None last_query='给我输出一段文本，200字' last_updated=1750733547.0782866 last_response=AgentResponse(session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548', status='completed', timestamp=1750733547.0782695, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '0d818188-1f20-4f8c-9192-87234bbcc5e2'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '08dbdc10-972a-4177-bf21-ba5f3bcfb7e4', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--05305f43-7f7c-460f-82ba-3f754e6d32f9', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '979ab747-e19c-417b-a069-672428e43417'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '62953287-17e8-4ca6-99d9-3a8582e3a4d8', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo3TmVYSTRDsfvawURN1h628JlJT', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--ba29e480-0855-4e64-8510-2e992386055c-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'dd3115ec-d4fb-4196-9197-083f66834497'}, {'content': '给我输出一段文本，200字', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '31aa7c8d-0fda-4e44-baeb-d26fcc50b170', 'example': False}, {'content': '在现代社会，科技的迅猛发展改变了我们的生活方式。智能手机、互联网和人工智能等技术的普及，使得信息获取变得更加便捷。人们可以随时随地通过手机浏览新闻、社交媒体，与朋友保持联系，甚至进行在线购物。这种便利性虽然提升了生活质量，但也带来了信息过载的问题。我们每天接收到大量的信息，如何筛选和处理这些信息成为了一项重要的技能。\n\n与此同时，科技的发展也在改变我们的工作方式。远程办公、在线会议和协作工具的出现，使得团队可以跨越地理界限进行合作。这种灵活的工作模式为许多人提供了更好的工作与生活平衡。然而，长时间的在线工作也可能导致身心疲惫，如何保持工作效率和心理健康成为了新的挑战。\n\n总的来说，科技的进步为我们带来了许多便利，但也要求我们不断适应和调整，以应对随之而来的各种挑战。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--004f3036-15a7-449e-9216-75129eb77587', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1468, 'output_tokens': 218, 'total_tokens': 1686, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '7bb59bbd-ad99-4590-9e16-cc21a5becd67'}, {'content': '给我输出一段文本，200字', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '8a70c210-9f11-4f92-a17f-e030863d4c61', 'example': False}, {'content': '在当今快速发展的社会中，科技的进步深刻地影响着我们的生活。智能手机的普及使得信息获取变得前所未有的便捷。无论是新闻、社交媒体还是在线购物，用户都可以随时随地通过手机进行操作。这种便利性虽然提升了生活质量，但也带来了信息过载的问题。人们每天接收到大量的信息，如何有效地筛选和处理这些信息成为了一项重要的技能。\n\n与此同时，科技的发展也改变了我们的工作方式。远程办公和在线会议的兴起，使得团队可以跨越地理界限进行合作。这种灵活的工作模式为许多人提供了更好的工作与生活平衡。然而，长时间的在线工作也可能导致身心疲惫，如何保持工作效率和心理健康成为了新的挑战。\n\n总的来说，科技的进步为我们带来了许多便利，但也要求我们不断适应和调整，以应对随之而来的各种挑战。我们需要在享受科技带来的便利的同时，学会管理信息和保持身心健康。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 241, 'prompt_tokens': 1722, 'total_tokens': 1963, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo3lptdnZDTcoH4dQlLJtfpDp0S9', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--3cbbe2fd-1597-4631-b436-3980d8f7ccee-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1722, 'output_tokens': 241, 'total_tokens': 1963, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:55:05,363 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 10:55:10,762 - __main__ - INFO - Redis初始化成功
2025-06-24 10:55:11,088 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 10:55:11,089 - __main__ - INFO - Chat模型初始化成功
2025-06-24 10:55:11,147 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 10:55:11,161 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 10:55:14,286 - __main__ - INFO - Agent初始化成功
2025-06-24 10:55:14,286 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 10:55:14,813 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='user_1750733521' session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:55:14,818 - __main__ - INFO - 成功获取用户ID: user_1750733521 的长期记忆，内容长度: 0 字符
2025-06-24 10:55:14,818 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:55:14,822 - __main__ - INFO - 开始改进的流式处理
2025-06-24 10:55:16,050 - __main__ - INFO - 找到AI回复内容: 你好！有什么我可以帮助你的吗？...
2025-06-24 10:55:16,200 - __main__ - INFO - 找到AI回复内容: 你好！有什么我可以帮助你的吗？...
2025-06-24 10:55:16,354 - __main__ - INFO - 找到AI回复内容: 在现代社会，科技的迅猛发展改变了我们的生活方式。智能手机、互联网和人工智能等技术的普及，使得信息获取变得更加便捷。人们可以随时随地通过手机浏览新闻、社交媒体，与朋友保持联系，甚至进行在线购物。这种便利...
2025-06-24 10:55:19,780 - __main__ - INFO - 找到AI回复内容: 在当今快速发展的社会中，科技的进步深刻地影响着我们的生活。智能手机的普及使得信息获取变得前所未有的便捷。无论是新闻、社交媒体还是在线购物，用户都可以随时随地通过手机进行操作。这种便利性虽然提升了生活质...
2025-06-24 10:55:23,406 - __main__ - INFO - 找到AI回复内容: 你好！有什么我可以帮助你的吗？...
2025-06-24 10:55:23,558 - __main__ - INFO - 流式输出完成，总内容长度: 740
2025-06-24 10:55:23,559 - __main__ - INFO - 发送完成信号，accumulated_content长度: 740
2025-06-24 10:55:23,571 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750733521:cda5c313-6c91-400c-b85a-7cad2a2e9548
2025-06-24 10:55:23,574 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750733521' session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548' status='completed' message=None last_query='你好' last_updated=1750733723.5596206 last_response=AgentResponse(session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548', status='completed', timestamp=1750733723.559594, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '0d818188-1f20-4f8c-9192-87234bbcc5e2'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '08dbdc10-972a-4177-bf21-ba5f3bcfb7e4', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--05305f43-7f7c-460f-82ba-3f754e6d32f9', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '979ab747-e19c-417b-a069-672428e43417'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '62953287-17e8-4ca6-99d9-3a8582e3a4d8', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo3TmVYSTRDsfvawURN1h628JlJT', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--ba29e480-0855-4e64-8510-2e992386055c-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'dd3115ec-d4fb-4196-9197-083f66834497'}, {'content': '给我输出一段文本，200字', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '31aa7c8d-0fda-4e44-baeb-d26fcc50b170', 'example': False}, {'content': '在现代社会，科技的迅猛发展改变了我们的生活方式。智能手机、互联网和人工智能等技术的普及，使得信息获取变得更加便捷。人们可以随时随地通过手机浏览新闻、社交媒体，与朋友保持联系，甚至进行在线购物。这种便利性虽然提升了生活质量，但也带来了信息过载的问题。我们每天接收到大量的信息，如何筛选和处理这些信息成为了一项重要的技能。\n\n与此同时，科技的发展也在改变我们的工作方式。远程办公、在线会议和协作工具的出现，使得团队可以跨越地理界限进行合作。这种灵活的工作模式为许多人提供了更好的工作与生活平衡。然而，长时间的在线工作也可能导致身心疲惫，如何保持工作效率和心理健康成为了新的挑战。\n\n总的来说，科技的进步为我们带来了许多便利，但也要求我们不断适应和调整，以应对随之而来的各种挑战。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--004f3036-15a7-449e-9216-75129eb77587', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1468, 'output_tokens': 218, 'total_tokens': 1686, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '7bb59bbd-ad99-4590-9e16-cc21a5becd67'}, {'content': '给我输出一段文本，200字', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '8a70c210-9f11-4f92-a17f-e030863d4c61', 'example': False}, {'content': '在当今快速发展的社会中，科技的进步深刻地影响着我们的生活。智能手机的普及使得信息获取变得前所未有的便捷。无论是新闻、社交媒体还是在线购物，用户都可以随时随地通过手机进行操作。这种便利性虽然提升了生活质量，但也带来了信息过载的问题。人们每天接收到大量的信息，如何有效地筛选和处理这些信息成为了一项重要的技能。\n\n与此同时，科技的发展也改变了我们的工作方式。远程办公和在线会议的兴起，使得团队可以跨越地理界限进行合作。这种灵活的工作模式为许多人提供了更好的工作与生活平衡。然而，长时间的在线工作也可能导致身心疲惫，如何保持工作效率和心理健康成为了新的挑战。\n\n总的来说，科技的进步为我们带来了许多便利，但也要求我们不断适应和调整，以应对随之而来的各种挑战。我们需要在享受科技带来的便利的同时，学会管理信息和保持身心健康。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 241, 'prompt_tokens': 1722, 'total_tokens': 1963, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo3lptdnZDTcoH4dQlLJtfpDp0S9', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--3cbbe2fd-1597-4631-b436-3980d8f7ccee-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1722, 'output_tokens': 241, 'total_tokens': 1963, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'f82420c6-af77-4bda-9dca-e6766d1e32b6'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '88cb88dd-26eb-420e-b294-c5f336615420', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1991, 'total_tokens': 2002, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1408}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo6VkXyHtp4geZzqiE35EFXJ3bwq', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--c83d2983-9ba5-40ff-9190-6b84da5661a3-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1991, 'output_tokens': 11, 'total_tokens': 2002, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:55:38,877 - __main__ - INFO - 调用/agent/invoke/stream接口，运行智能体并返回流式结果，接受到前端用户请求:user_id='user_1750733521' session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548' query='给我生成200字的科幻短问' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:55:38,882 - __main__ - INFO - 成功获取用户ID: user_1750733521 的长期记忆，内容长度: 0 字符
2025-06-24 10:55:38,882 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:55:38,886 - __main__ - INFO - 开始改进的流式处理
2025-06-24 10:55:45,540 - __main__ - INFO - 找到AI回复内容: 你好！有什么我可以帮助你的吗？...
2025-06-24 10:55:45,690 - __main__ - INFO - 找到AI回复内容: 你好！有什么我可以帮助你的吗？...
2025-06-24 10:55:45,843 - __main__ - INFO - 找到AI回复内容: 在现代社会，科技的迅猛发展改变了我们的生活方式。智能手机、互联网和人工智能等技术的普及，使得信息获取变得更加便捷。人们可以随时随地通过手机浏览新闻、社交媒体，与朋友保持联系，甚至进行在线购物。这种便利...
2025-06-24 10:55:49,263 - __main__ - INFO - 找到AI回复内容: 在当今快速发展的社会中，科技的进步深刻地影响着我们的生活。智能手机的普及使得信息获取变得前所未有的便捷。无论是新闻、社交媒体还是在线购物，用户都可以随时随地通过手机进行操作。这种便利性虽然提升了生活质...
2025-06-24 10:55:52,884 - __main__ - INFO - 找到AI回复内容: 你好！有什么我可以帮助你的吗？...
2025-06-24 10:55:53,036 - __main__ - INFO - 找到AI回复内容: 在不远的未来，地球的资源日益枯竭，人类不得不寻找新的生存空间。科学家们在火星上建立了第一个人类殖民地，名为“新希望”。这个殖民地不仅是人类的第二家园，也是科学探索的前沿阵地。随着技术的进步，人工智能和...
2025-06-24 10:55:56,153 - __main__ - INFO - 流式输出完成，总内容长度: 1050
2025-06-24 10:55:56,154 - __main__ - INFO - 发送完成信号，accumulated_content长度: 1050
2025-06-24 10:55:56,163 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750733521:cda5c313-6c91-400c-b85a-7cad2a2e9548
2025-06-24 10:55:56,166 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750733521' session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548' status='completed' message=None last_query='给我生成200字的科幻短问' last_updated=1750733756.155125 last_response=AgentResponse(session_id='cda5c313-6c91-400c-b85a-7cad2a2e9548', status='completed', timestamp=1750733756.155102, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '0d818188-1f20-4f8c-9192-87234bbcc5e2'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '08dbdc10-972a-4177-bf21-ba5f3bcfb7e4', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--05305f43-7f7c-460f-82ba-3f754e6d32f9', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '979ab747-e19c-417b-a069-672428e43417'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '62953287-17e8-4ca6-99d9-3a8582e3a4d8', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo3TmVYSTRDsfvawURN1h628JlJT', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--ba29e480-0855-4e64-8510-2e992386055c-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'dd3115ec-d4fb-4196-9197-083f66834497'}, {'content': '给我输出一段文本，200字', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '31aa7c8d-0fda-4e44-baeb-d26fcc50b170', 'example': False}, {'content': '在现代社会，科技的迅猛发展改变了我们的生活方式。智能手机、互联网和人工智能等技术的普及，使得信息获取变得更加便捷。人们可以随时随地通过手机浏览新闻、社交媒体，与朋友保持联系，甚至进行在线购物。这种便利性虽然提升了生活质量，但也带来了信息过载的问题。我们每天接收到大量的信息，如何筛选和处理这些信息成为了一项重要的技能。\n\n与此同时，科技的发展也在改变我们的工作方式。远程办公、在线会议和协作工具的出现，使得团队可以跨越地理界限进行合作。这种灵活的工作模式为许多人提供了更好的工作与生活平衡。然而，长时间的在线工作也可能导致身心疲惫，如何保持工作效率和心理健康成为了新的挑战。\n\n总的来说，科技的进步为我们带来了许多便利，但也要求我们不断适应和调整，以应对随之而来的各种挑战。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--004f3036-15a7-449e-9216-75129eb77587', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1468, 'output_tokens': 218, 'total_tokens': 1686, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '7bb59bbd-ad99-4590-9e16-cc21a5becd67'}, {'content': '给我输出一段文本，200字', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '8a70c210-9f11-4f92-a17f-e030863d4c61', 'example': False}, {'content': '在当今快速发展的社会中，科技的进步深刻地影响着我们的生活。智能手机的普及使得信息获取变得前所未有的便捷。无论是新闻、社交媒体还是在线购物，用户都可以随时随地通过手机进行操作。这种便利性虽然提升了生活质量，但也带来了信息过载的问题。人们每天接收到大量的信息，如何有效地筛选和处理这些信息成为了一项重要的技能。\n\n与此同时，科技的发展也改变了我们的工作方式。远程办公和在线会议的兴起，使得团队可以跨越地理界限进行合作。这种灵活的工作模式为许多人提供了更好的工作与生活平衡。然而，长时间的在线工作也可能导致身心疲惫，如何保持工作效率和心理健康成为了新的挑战。\n\n总的来说，科技的进步为我们带来了许多便利，但也要求我们不断适应和调整，以应对随之而来的各种挑战。我们需要在享受科技带来的便利的同时，学会管理信息和保持身心健康。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 241, 'prompt_tokens': 1722, 'total_tokens': 1963, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo3lptdnZDTcoH4dQlLJtfpDp0S9', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--3cbbe2fd-1597-4631-b436-3980d8f7ccee-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1722, 'output_tokens': 241, 'total_tokens': 1963, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'f82420c6-af77-4bda-9dca-e6766d1e32b6'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '88cb88dd-26eb-420e-b294-c5f336615420', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1991, 'total_tokens': 2002, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1408}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo6VkXyHtp4geZzqiE35EFXJ3bwq', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--c83d2983-9ba5-40ff-9190-6b84da5661a3-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1991, 'output_tokens': 11, 'total_tokens': 2002, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'cdf4a4ff-5c72-4aea-aed6-cfe6d49978ca'}, {'content': '给我生成200字的科幻短问', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c5435e30-af82-4117-a2a9-095b7df6ba3c', 'example': False}, {'content': '在不远的未来，地球的资源日益枯竭，人类不得不寻找新的生存空间。科学家们在火星上建立了第一个人类殖民地，名为“新希望”。这个殖民地不仅是人类的第二家园，也是科学探索的前沿阵地。随着技术的进步，人工智能和生物工程的结合使得人类能够在火星上创造出适合生存的环境。\n\n然而，随着殖民地的扩展，神秘的火星生物开始显现出它们的存在。它们拥有超乎想象的智慧和能力，能够操控周围的环境。人类与这些生物的首次接触充满了紧张与期待。科学家们试图解读它们的语言，探索它们的文化，然而，双方的沟通却充满了误解。\n\n在这个充满未知的星球上，人类必须面对道德与生存的抉择：是继续扩张，还是与火星生物和平共处？在探索与冲突之间，未来的命运将如何揭晓？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 253, 'prompt_tokens': 2039, 'total_tokens': 2292, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo6tzoiUii8oEZG4BzupZDDLTMUR', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--36da30ce-fca4-4ef4-9e01-9a625131f205-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 2039, 'output_tokens': 253, 'total_tokens': 2292, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:56:02,803 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 10:56:56,504 - __main__ - INFO - Redis初始化成功
2025-06-24 10:56:56,848 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 10:56:56,848 - __main__ - INFO - Chat模型初始化成功
2025-06-24 10:56:56,909 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 10:56:56,921 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 10:57:00,671 - __main__ - INFO - Agent初始化成功
2025-06-24 10:57:00,671 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 10:57:19,328 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 10:57:19,343 - __main__ - INFO - 返回当前系统状态信息:sessions_count=10 active_users={'user_1750733521': ['cda5c313-6c91-400c-b85a-7cad2a2e9548'], 'user_1750732496': ['281afed9-c8ca-4fff-8e22-8db79e29d6a0'], '你好': ['c3319805-49d6-4e6f-9a0c-21ef94b55d67'], 'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849'], 'test_user': ['test_session_004', 'test_session_001', 'test_session_002', 'test_session_regular', 'test_session_005', 'test_session_003']}
2025-06-24 10:57:25,515 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:ztl
2025-06-24 10:57:25,517 - __main__ - INFO - Deleted empty user_sessions collection for user ztl
2025-06-24 10:57:25,518 - __main__ - ERROR - 用户 ztl 的会话不存在
2025-06-24 10:57:25,522 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:ztl:3f4250c8-65c9-4015-916a-5e14f259abee
2025-06-24 10:57:25,524 - __main__ - INFO - Deleted empty user_sessions collection for user ztl
2025-06-24 10:57:25,525 - __main__ - ERROR - 用户 ztl:3f4250c8-65c9-4015-916a-5e14f259abee 的会话不存在
2025-06-24 10:57:31,309 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='ztl' session_id='3f4250c8-65c9-4015-916a-5e14f259abee' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:57:31,314 - __main__ - INFO - 成功获取用户ID: ztl 的长期记忆，内容长度: 0 字符
2025-06-24 10:57:31,315 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:57:31,316 - __main__ - INFO - Deleted empty user_sessions collection for user ztl
2025-06-24 10:57:32,385 - __main__ - INFO - 最终智能体回复结果:session_id='3f4250c8-65c9-4015-916a-5e14f259abee' status='completed' timestamp=1750733852.3855748 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='220ba85f-6468-4d2e-b5e6-92e1ff0351c9'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='b2e7111f-d2ff-44e1-985a-bffeeca1e43f'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1312, 'total_tokens': 1323, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8hZ6hBjID48Serg1fmrW5w00uO', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--afde42b3-3d37-4aa9-8d72-3712b9e9618e-0', usage_metadata={'input_tokens': 1312, 'output_tokens': 11, 'total_tokens': 1323, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 10:57:32,399 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:ztl:3f4250c8-65c9-4015-916a-5e14f259abee
2025-06-24 10:57:32,402 - __main__ - INFO - 返回当前用户的会话状态:user_id='ztl' session_id='3f4250c8-65c9-4015-916a-5e14f259abee' status='completed' message=None last_query='你好' last_updated=1750733852.38823 last_response=AgentResponse(session_id='3f4250c8-65c9-4015-916a-5e14f259abee', status='completed', timestamp=1750733852.3855748, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '220ba85f-6468-4d2e-b5e6-92e1ff0351c9'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'b2e7111f-d2ff-44e1-985a-bffeeca1e43f', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1312, 'total_tokens': 1323, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8hZ6hBjID48Serg1fmrW5w00uO', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--afde42b3-3d37-4aa9-8d72-3712b9e9618e-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1312, 'output_tokens': 11, 'total_tokens': 1323, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:57:35,974 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='ztl' session_id='3f4250c8-65c9-4015-916a-5e14f259abee' query='给我生成图像' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:57:35,979 - __main__ - INFO - 成功获取用户ID: ztl 的长期记忆，内容长度: 0 字符
2025-06-24 10:57:35,979 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:57:37,744 - __main__ - INFO - 最终智能体回复结果:session_id='3f4250c8-65c9-4015-916a-5e14f259abee' status='completed' timestamp=1750733857.7446356 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='220ba85f-6468-4d2e-b5e6-92e1ff0351c9'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='b2e7111f-d2ff-44e1-985a-bffeeca1e43f'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1312, 'total_tokens': 1323, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8hZ6hBjID48Serg1fmrW5w00uO', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--afde42b3-3d37-4aa9-8d72-3712b9e9618e-0', usage_metadata={'input_tokens': 1312, 'output_tokens': 11, 'total_tokens': 1323, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='2b8685a8-7a89-4415-9d32-763eb2b39242'), HumanMessage(content='给我生成图像', additional_kwargs={}, response_metadata={}, id='74c6dd88-c546-44a1-8b87-63f8b681eeb4'), AIMessage(content='抱歉，我目前无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 32, 'prompt_tokens': 1355, 'total_tokens': 1387, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8m6x00eVSdIFHi3FcA1YCfwpJU', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--57ac7250-e9c8-4238-b137-97d5b778976a-0', usage_metadata={'input_tokens': 1355, 'output_tokens': 32, 'total_tokens': 1387, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 10:57:37,758 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:ztl:3f4250c8-65c9-4015-916a-5e14f259abee
2025-06-24 10:57:37,760 - __main__ - INFO - 返回当前用户的会话状态:user_id='ztl' session_id='3f4250c8-65c9-4015-916a-5e14f259abee' status='completed' message=None last_query='给我生成图像' last_updated=1750733857.747739 last_response=AgentResponse(session_id='3f4250c8-65c9-4015-916a-5e14f259abee', status='completed', timestamp=1750733857.7446356, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '220ba85f-6468-4d2e-b5e6-92e1ff0351c9'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'b2e7111f-d2ff-44e1-985a-bffeeca1e43f', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1312, 'total_tokens': 1323, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8hZ6hBjID48Serg1fmrW5w00uO', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--afde42b3-3d37-4aa9-8d72-3712b9e9618e-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1312, 'output_tokens': 11, 'total_tokens': 1323, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '2b8685a8-7a89-4415-9d32-763eb2b39242'}, {'content': '给我生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '74c6dd88-c546-44a1-8b87-63f8b681eeb4', 'example': False}, {'content': '抱歉，我目前无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 32, 'prompt_tokens': 1355, 'total_tokens': 1387, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8m6x00eVSdIFHi3FcA1YCfwpJU', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--57ac7250-e9c8-4238-b137-97d5b778976a-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1355, 'output_tokens': 32, 'total_tokens': 1387, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:58:02,829 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 10:58:07,801 - __main__ - INFO - Redis初始化成功
2025-06-24 10:58:08,123 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 10:58:08,124 - __main__ - INFO - Chat模型初始化成功
2025-06-24 10:58:08,171 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 10:58:08,192 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 10:58:11,380 - __main__ - INFO - Agent初始化成功
2025-06-24 10:58:11,381 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 10:58:14,366 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='ztl' session_id='3f4250c8-65c9-4015-916a-5e14f259abee' query='给我生成图像' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:58:14,372 - __main__ - INFO - 成功获取用户ID: ztl 的长期记忆，内容长度: 0 字符
2025-06-24 10:58:14,372 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:58:16,577 - __main__ - INFO - 最终智能体回复结果:session_id='3f4250c8-65c9-4015-916a-5e14f259abee' status='completed' timestamp=1750733896.5764968 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='220ba85f-6468-4d2e-b5e6-92e1ff0351c9'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='b2e7111f-d2ff-44e1-985a-bffeeca1e43f'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1312, 'total_tokens': 1323, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8hZ6hBjID48Serg1fmrW5w00uO', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--afde42b3-3d37-4aa9-8d72-3712b9e9618e-0', usage_metadata={'input_tokens': 1312, 'output_tokens': 11, 'total_tokens': 1323, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='2b8685a8-7a89-4415-9d32-763eb2b39242'), HumanMessage(content='给我生成图像', additional_kwargs={}, response_metadata={}, id='74c6dd88-c546-44a1-8b87-63f8b681eeb4'), AIMessage(content='抱歉，我目前无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 32, 'prompt_tokens': 1355, 'total_tokens': 1387, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8m6x00eVSdIFHi3FcA1YCfwpJU', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--57ac7250-e9c8-4238-b137-97d5b778976a-0', usage_metadata={'input_tokens': 1355, 'output_tokens': 32, 'total_tokens': 1387, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='6ddca838-6b81-466f-8f05-073784eb9a8e'), HumanMessage(content='给我生成图像', additional_kwargs={}, response_metadata={}, id='9ab9d83b-5141-41dc-b3ee-f231144a139e'), AIMessage(content='请告诉我你想要生成的图像的具体内容或主题，我将为你生成图像。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 25, 'prompt_tokens': 1489, 'total_tokens': 1514, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo9PHDLSgmQWZ8VeUC6cDbpAA92a', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--9c8534cf-8aad-4c6a-98c4-c2852b5f3516-0', usage_metadata={'input_tokens': 1489, 'output_tokens': 25, 'total_tokens': 1514, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 10:58:16,589 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:ztl:3f4250c8-65c9-4015-916a-5e14f259abee
2025-06-24 10:58:16,591 - __main__ - INFO - 返回当前用户的会话状态:user_id='ztl' session_id='3f4250c8-65c9-4015-916a-5e14f259abee' status='completed' message=None last_query='给我生成图像' last_updated=1750733896.5796485 last_response=AgentResponse(session_id='3f4250c8-65c9-4015-916a-5e14f259abee', status='completed', timestamp=1750733896.5764968, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '220ba85f-6468-4d2e-b5e6-92e1ff0351c9'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'b2e7111f-d2ff-44e1-985a-bffeeca1e43f', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1312, 'total_tokens': 1323, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8hZ6hBjID48Serg1fmrW5w00uO', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--afde42b3-3d37-4aa9-8d72-3712b9e9618e-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1312, 'output_tokens': 11, 'total_tokens': 1323, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '2b8685a8-7a89-4415-9d32-763eb2b39242'}, {'content': '给我生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '74c6dd88-c546-44a1-8b87-63f8b681eeb4', 'example': False}, {'content': '抱歉，我目前无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 32, 'prompt_tokens': 1355, 'total_tokens': 1387, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8m6x00eVSdIFHi3FcA1YCfwpJU', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--57ac7250-e9c8-4238-b137-97d5b778976a-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1355, 'output_tokens': 32, 'total_tokens': 1387, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '6ddca838-6b81-466f-8f05-073784eb9a8e'}, {'content': '给我生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '9ab9d83b-5141-41dc-b3ee-f231144a139e', 'example': False}, {'content': '请告诉我你想要生成的图像的具体内容或主题，我将为你生成图像。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 25, 'prompt_tokens': 1489, 'total_tokens': 1514, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo9PHDLSgmQWZ8VeUC6cDbpAA92a', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--9c8534cf-8aad-4c6a-98c4-c2852b5f3516-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1489, 'output_tokens': 25, 'total_tokens': 1514, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 10:58:26,865 - __main__ - INFO - 调用/agent/invoke接口，运行智能体并返回大模型结果或中断数据，接受到前端用户请求:user_id='ztl' session_id='3f4250c8-65c9-4015-916a-5e14f259abee' query='一个小猫' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 10:58:26,870 - __main__ - INFO - 成功获取用户ID: ztl 的长期记忆，内容长度: 0 字符
2025-06-24 10:58:26,870 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 10:58:28,263 - __main__ - INFO - 当前触发工具调用中断:session_id='3f4250c8-65c9-4015-916a-5e14f259abee' status='interrupted' timestamp=1750733908.2631836 message=None result=None interrupt_data={'action_request': {'action': 'generate_image', 'args': {'prompt': 'A cute little kitten, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment.'}}, 'config': None, 'description': "准备调用 generate_image 工具：\n- 参数为: {'prompt': 'A cute little kitten, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment.'}\n\n是否允许继续？\n输入 'yes' 接受工具调用\n输入 'no' 拒绝工具调用\n输入 'edit' 修改工具参数后调用工具\n输入 'response' 不调用工具直接反馈信息", 'interrupt_type': 'unknown'}
2025-06-24 10:59:08,597 - __main__ - INFO - 调用/agent/resume接口，恢复被中断的智能体运行并等待运行完成或再次中断，接受到前端用户请求:user_id='ztl' session_id='3f4250c8-65c9-4015-916a-5e14f259abee' response_type='response' args={'args': '改成小狗'}
2025-06-24 10:59:08,608 - utils.tools - INFO - response: {'type': 'response', 'args': {'args': '改成小狗'}}
2025-06-24 10:59:09,707 - __main__ - INFO - 当前触发工具调用中断:session_id='3f4250c8-65c9-4015-916a-5e14f259abee' status='interrupted' timestamp=1750733949.707507 message=None result=None interrupt_data={'action_request': {'action': 'generate_image', 'args': {'prompt': 'A cute little puppy, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment.'}}, 'config': None, 'description': "准备调用 generate_image 工具：\n- 参数为: {'prompt': 'A cute little puppy, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment.'}\n\n是否允许继续？\n输入 'yes' 接受工具调用\n输入 'no' 拒绝工具调用\n输入 'edit' 修改工具参数后调用工具\n输入 'response' 不调用工具直接反馈信息", 'interrupt_type': 'unknown'}
2025-06-24 10:59:14,614 - __main__ - INFO - 调用/agent/resume接口，恢复被中断的智能体运行并等待运行完成或再次中断，接受到前端用户请求:user_id='ztl' session_id='3f4250c8-65c9-4015-916a-5e14f259abee' response_type='accept' args=None
2025-06-24 10:59:14,623 - utils.tools - INFO - response: {'type': 'accept'}
2025-06-24 10:59:14,625 - utils.tools - INFO - 工具调用已批准，执行中...
2025-06-24 10:59:14,625 - utils.tools - INFO - 调用工具: generate_image, 参数: {'prompt': 'A cute little puppy, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment.'}
2025-06-24 10:59:14,626 - utils.tools - INFO - {'text': '已生成2张图像', 'images': ['https://example.com/image1.jpg', 'https://example.com/image2.jpg'], 'type': 'image_generation'}
2025-06-24 10:59:16,032 - __main__ - INFO - 最终智能体回复结果:session_id='3f4250c8-65c9-4015-916a-5e14f259abee' status='completed' timestamp=1750733956.0324519 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='220ba85f-6468-4d2e-b5e6-92e1ff0351c9'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='b2e7111f-d2ff-44e1-985a-bffeeca1e43f'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1312, 'total_tokens': 1323, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8hZ6hBjID48Serg1fmrW5w00uO', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--afde42b3-3d37-4aa9-8d72-3712b9e9618e-0', usage_metadata={'input_tokens': 1312, 'output_tokens': 11, 'total_tokens': 1323, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='2b8685a8-7a89-4415-9d32-763eb2b39242'), HumanMessage(content='给我生成图像', additional_kwargs={}, response_metadata={}, id='74c6dd88-c546-44a1-8b87-63f8b681eeb4'), AIMessage(content='抱歉，我目前无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 32, 'prompt_tokens': 1355, 'total_tokens': 1387, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8m6x00eVSdIFHi3FcA1YCfwpJU', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--57ac7250-e9c8-4238-b137-97d5b778976a-0', usage_metadata={'input_tokens': 1355, 'output_tokens': 32, 'total_tokens': 1387, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='6ddca838-6b81-466f-8f05-073784eb9a8e'), HumanMessage(content='给我生成图像', additional_kwargs={}, response_metadata={}, id='9ab9d83b-5141-41dc-b3ee-f231144a139e'), AIMessage(content='请告诉我你想要生成的图像的具体内容或主题，我将为你生成图像。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 25, 'prompt_tokens': 1489, 'total_tokens': 1514, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo9PHDLSgmQWZ8VeUC6cDbpAA92a', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--9c8534cf-8aad-4c6a-98c4-c2852b5f3516-0', usage_metadata={'input_tokens': 1489, 'output_tokens': 25, 'total_tokens': 1514, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='f2ba1e37-d30e-4e75-ab2f-973ee2072dd6'), HumanMessage(content='一个小猫', additional_kwargs={}, response_metadata={}, id='a0d1783b-6033-404e-85f5-813c47d7523f'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_CXaVMdzh4ZXXSTfQ1NphUSmD', 'function': {'arguments': '{"prompt":"A cute little kitten, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment."}', 'name': 'generate_image'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 39, 'prompt_tokens': 1544, 'total_tokens': 1583, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo9biczWF36rIxkMZZ3yQQrZ7PFa', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, id='run--8dfda7ca-e42f-418e-a636-cc73b8455787-0', tool_calls=[{'name': 'generate_image', 'args': {'prompt': 'A cute little kitten, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment.'}, 'id': 'call_CXaVMdzh4ZXXSTfQ1NphUSmD', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1544, 'output_tokens': 39, 'total_tokens': 1583, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='{"args": "改成小狗"}', name='generate_image', id='de7c2df7-9be8-4f0c-9fd6-f08032d38f6f', tool_call_id='call_CXaVMdzh4ZXXSTfQ1NphUSmD'), AIMessage(content='', additional_kwargs={'tool_calls': [{'id': 'call_iaVXJih10Oo6laNMod5vWUL7', 'function': {'arguments': '{"prompt":"A cute little puppy, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment."}', 'name': 'generate_image'}, 'type': 'function'}], 'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 39, 'prompt_tokens': 1599, 'total_tokens': 1638, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1408}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloAGQ83X38XIUIHAagbSZEq7H6HQ', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, id='run--827ee4cc-d48c-4798-8992-d6f8f4bff398-0', tool_calls=[{'name': 'generate_image', 'args': {'prompt': 'A cute little puppy, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment.'}, 'id': 'call_iaVXJih10Oo6laNMod5vWUL7', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1599, 'output_tokens': 39, 'total_tokens': 1638, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='{"text": "已生成2张图像", "images": ["https://example.com/image1.jpg", "https://example.com/image2.jpg"], "type": "image_generation"}', name='generate_image', id='67774483-75f7-47cb-b9cf-b681f5b38843', tool_call_id='call_iaVXJih10Oo6laNMod5vWUL7'), AIMessage(content='我已生成两张小狗的图像。你可以查看它们：\n\n1. ![小狗图像1](https://example.com/image1.jpg)\n2. ![小狗图像2](https://example.com/image2.jpg)\n\n如果你需要其他内容或不同的图像，请告诉我！', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 69, 'prompt_tokens': 1684, 'total_tokens': 1753, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloANVEgPCrGhEM5OsT19a6NisHWq', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--3ce3ec88-52a1-429d-a7ab-40f264d0282e-0', usage_metadata={'input_tokens': 1684, 'output_tokens': 69, 'total_tokens': 1753, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 10:59:16,045 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:ztl:3f4250c8-65c9-4015-916a-5e14f259abee
2025-06-24 10:59:16,047 - __main__ - INFO - 返回当前用户的会话状态:user_id='ztl' session_id='3f4250c8-65c9-4015-916a-5e14f259abee' status='completed' message=None last_query='一个小猫' last_updated=1750733956.0348303 last_response=AgentResponse(session_id='3f4250c8-65c9-4015-916a-5e14f259abee', status='completed', timestamp=1750733956.0324519, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '220ba85f-6468-4d2e-b5e6-92e1ff0351c9'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'b2e7111f-d2ff-44e1-985a-bffeeca1e43f', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1312, 'total_tokens': 1323, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8hZ6hBjID48Serg1fmrW5w00uO', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--afde42b3-3d37-4aa9-8d72-3712b9e9618e-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1312, 'output_tokens': 11, 'total_tokens': 1323, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '2b8685a8-7a89-4415-9d32-763eb2b39242'}, {'content': '给我生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '74c6dd88-c546-44a1-8b87-63f8b681eeb4', 'example': False}, {'content': '抱歉，我目前无法生成图像，但我可以帮助你处理文本、提供信息或回答问题。如果你有其他需求，请告诉我！', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 32, 'prompt_tokens': 1355, 'total_tokens': 1387, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo8m6x00eVSdIFHi3FcA1YCfwpJU', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--57ac7250-e9c8-4238-b137-97d5b778976a-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1355, 'output_tokens': 32, 'total_tokens': 1387, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '6ddca838-6b81-466f-8f05-073784eb9a8e'}, {'content': '给我生成图像', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '9ab9d83b-5141-41dc-b3ee-f231144a139e', 'example': False}, {'content': '请告诉我你想要生成的图像的具体内容或主题，我将为你生成图像。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 25, 'prompt_tokens': 1489, 'total_tokens': 1514, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-Blo9PHDLSgmQWZ8VeUC6cDbpAA92a', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--9c8534cf-8aad-4c6a-98c4-c2852b5f3516-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1489, 'output_tokens': 25, 'total_tokens': 1514, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'f2ba1e37-d30e-4e75-ab2f-973ee2072dd6'}, {'content': '一个小猫', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'a0d1783b-6033-404e-85f5-813c47d7523f', 'example': False}, {'content': '', 'additional_kwargs': {'tool_calls': [{'id': 'call_CXaVMdzh4ZXXSTfQ1NphUSmD', 'function': {'arguments': '{"prompt":"A cute little kitten, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment."}', 'name': 'generate_image'}, 'type': 'function'}], 'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 39, 'prompt_tokens': 1544, 'total_tokens': 1583, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-Blo9biczWF36rIxkMZZ3yQQrZ7PFa', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--8dfda7ca-e42f-418e-a636-cc73b8455787-0', 'example': False, 'tool_calls': [{'name': 'generate_image', 'args': {'prompt': 'A cute little kitten, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment.'}, 'id': 'call_CXaVMdzh4ZXXSTfQ1NphUSmD', 'type': 'tool_call'}], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1544, 'output_tokens': 39, 'total_tokens': 1583, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '{"args": "改成小狗"}', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'tool', 'name': 'generate_image', 'id': 'de7c2df7-9be8-4f0c-9fd6-f08032d38f6f', 'tool_call_id': 'call_CXaVMdzh4ZXXSTfQ1NphUSmD', 'artifact': None, 'status': 'success'}, {'content': '', 'additional_kwargs': {'tool_calls': [{'id': 'call_iaVXJih10Oo6laNMod5vWUL7', 'function': {'arguments': '{"prompt":"A cute little puppy, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment."}', 'name': 'generate_image'}, 'type': 'function'}], 'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 39, 'prompt_tokens': 1599, 'total_tokens': 1638, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1408}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloAGQ83X38XIUIHAagbSZEq7H6HQ', 'service_tier': None, 'finish_reason': 'tool_calls', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--827ee4cc-d48c-4798-8992-d6f8f4bff398-0', 'example': False, 'tool_calls': [{'name': 'generate_image', 'args': {'prompt': 'A cute little puppy, playful and fluffy, with big bright eyes and a soft fur coat, sitting in a cozy environment.'}, 'id': 'call_iaVXJih10Oo6laNMod5vWUL7', 'type': 'tool_call'}], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1599, 'output_tokens': 39, 'total_tokens': 1638, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '{"text": "已生成2张图像", "images": ["https://example.com/image1.jpg", "https://example.com/image2.jpg"], "type": "image_generation"}', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'tool', 'name': 'generate_image', 'id': '67774483-75f7-47cb-b9cf-b681f5b38843', 'tool_call_id': 'call_iaVXJih10Oo6laNMod5vWUL7', 'artifact': None, 'status': 'success'}, {'content': '我已生成两张小狗的图像。你可以查看它们：\n\n1. ![小狗图像1](https://example.com/image1.jpg)\n2. ![小狗图像2](https://example.com/image2.jpg)\n\n如果你需要其他内容或不同的图像，请告诉我！', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 69, 'prompt_tokens': 1684, 'total_tokens': 1753, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloANVEgPCrGhEM5OsT19a6NisHWq', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--3ce3ec88-52a1-429d-a7ab-40f264d0282e-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1684, 'output_tokens': 69, 'total_tokens': 1753, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 11:08:23,171 - __main__ - INFO - Redis初始化成功
2025-06-24 11:08:23,503 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 11:08:23,504 - __main__ - INFO - Chat模型初始化成功
2025-06-24 11:08:23,543 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 11:08:23,577 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 11:08:26,972 - __main__ - INFO - Agent初始化成功
2025-06-24 11:08:26,972 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 11:08:33,576 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 11:08:33,597 - __main__ - INFO - 返回当前系统状态信息:sessions_count=11 active_users={'user_1750733521': ['cda5c313-6c91-400c-b85a-7cad2a2e9548'], 'user_1750732496': ['281afed9-c8ca-4fff-8e22-8db79e29d6a0'], '你好': ['c3319805-49d6-4e6f-9a0c-21ef94b55d67'], 'ztl': ['3f4250c8-65c9-4015-916a-5e14f259abee'], 'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849'], 'test_user': ['test_session_regular', 'test_session_004', 'test_session_001', 'test_session_003', 'test_session_005', 'test_session_002']}
2025-06-24 11:08:36,266 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:user_1750734513
2025-06-24 11:08:36,268 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750734513
2025-06-24 11:08:36,268 - __main__ - ERROR - 用户 user_1750734513 的会话不存在
2025-06-24 11:08:36,272 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750734513:0677d90c-eb18-43ad-9e4a-355617689fe7
2025-06-24 11:08:36,273 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750734513
2025-06-24 11:08:36,274 - __main__ - ERROR - 用户 user_1750734513:0677d90c-eb18-43ad-9e4a-355617689fe7 的会话不存在
2025-06-24 11:08:41,413 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='user_1750734513' session_id='0677d90c-eb18-43ad-9e4a-355617689fe7' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:08:41,418 - __main__ - INFO - 成功获取用户ID: user_1750734513 的长期记忆，内容长度: 0 字符
2025-06-24 11:08:41,419 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:08:41,420 - __main__ - INFO - Deleted empty user_sessions collection for user user_1750734513
2025-06-24 11:08:43,584 - __main__ - INFO - 最终智能体回复结果:session_id='0677d90c-eb18-43ad-9e4a-355617689fe7' status='completed' timestamp=1750734523.584169 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='298cefdb-17b3-475a-8495-9132f496b59e'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='3a6ca268-100e-41e7-bfd5-66f01b1a45af'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--f20ff4c2-4a6c-48cf-9f45-40e6783bedbf', usage_metadata={'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='d49c77c9-e9d9-462a-a935-99519f50cede'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='bfba1dff-4376-4fa1-97ec-218836001315'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BloJW0QGMQcltONF4KvPcTdGQhBq5', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--0184d57a-c992-49cb-948c-0ca80d803435-0', usage_metadata={'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 11:08:43,593 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:user_1750734513:0677d90c-eb18-43ad-9e4a-355617689fe7
2025-06-24 11:08:43,596 - __main__ - INFO - 返回当前用户的会话状态:user_id='user_1750734513' session_id='0677d90c-eb18-43ad-9e4a-355617689fe7' status='completed' message=None last_query='你好' last_updated=1750734523.5864444 last_response=AgentResponse(session_id='0677d90c-eb18-43ad-9e4a-355617689fe7', status='completed', timestamp=1750734523.584169, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '298cefdb-17b3-475a-8495-9132f496b59e'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '3a6ca268-100e-41e7-bfd5-66f01b1a45af', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--f20ff4c2-4a6c-48cf-9f45-40e6783bedbf', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'd49c77c9-e9d9-462a-a935-99519f50cede'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'bfba1dff-4376-4fa1-97ec-218836001315', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BloJW0QGMQcltONF4KvPcTdGQhBq5', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--0184d57a-c992-49cb-948c-0ca80d803435-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 11:08:56,737 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='user_1750734513' session_id='0677d90c-eb18-43ad-9e4a-355617689fe7' query='给我生成200字的小文章' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:08:56,741 - __main__ - INFO - 成功获取用户ID: user_1750734513 的长期记忆，内容长度: 0 字符
2025-06-24 11:08:56,742 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:09:09,840 - __main__ - INFO - 当前触发工具调用中断:session_id='0677d90c-eb18-43ad-9e4a-355617689fe7' status='interrupted' timestamp=1750734549.8399851 message=None result=None interrupt_data={'action_request': {'action': 'generate_image', 'args': {'prompt': '在一个阳光明媚的早晨，小镇上的人们开始了一天的忙碌。街道两旁的花朵在微风中轻轻摇曳，散发出阵阵芬芳。孩子们在公园里嬉戏，欢声笑语回荡在空气中。老奶奶坐在长椅上，手中拿着一本书，时不时抬头欣赏周围的美景。小镇的咖啡馆里，顾客们享受着香浓的咖啡和新鲜出炉的面包。店主热情地招呼着每一位客人，脸上挂着温暖的笑容。人们在这里交流着生活的点滴，分享着彼此的故事。随着时间的推移，阳光渐渐升高，街道上的人流也越来越多。商店的橱窗里陈列着各式各样的商品，吸引着路过的行人。小镇的一天就这样在忙碌与欢笑中悄然流逝，留下了温暖的回忆。'}}, 'config': None, 'description': "准备调用 generate_image 工具：\n- 参数为: {'prompt': '在一个阳光明媚的早晨，小镇上的人们开始了一天的忙碌。街道两旁的花朵在微风中轻轻摇曳，散发出阵阵芬芳。孩子们在公园里嬉戏，欢声笑语回荡在空气中。老奶奶坐在长椅上，手中拿着一本书，时不时抬头欣赏周围的美景。小镇的咖啡馆里，顾客们享受着香浓的咖啡和新鲜出炉的面包。店主热情地招呼着每一位客人，脸上挂着温暖的笑容。人们在这里交流着生活的点滴，分享着彼此的故事。随着时间的推移，阳光渐渐升高，街道上的人流也越来越多。商店的橱窗里陈列着各式各样的商品，吸引着路过的行人。小镇的一天就这样在忙碌与欢笑中悄然流逝，留下了温暖的回忆。'}\n\n是否允许继续？\n输入 'yes' 接受工具调用\n输入 'no' 拒绝工具调用\n输入 'edit' 修改工具参数后调用工具\n输入 'response' 不调用工具直接反馈信息", 'interrupt_type': 'unknown'}
2025-06-24 11:09:34,634 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 11:09:34,655 - __main__ - INFO - 返回当前系统状态信息:sessions_count=12 active_users={'user_1750733521': ['cda5c313-6c91-400c-b85a-7cad2a2e9548'], 'user_1750732496': ['281afed9-c8ca-4fff-8e22-8db79e29d6a0'], '你好': ['c3319805-49d6-4e6f-9a0c-21ef94b55d67'], 'user_1750734513': ['0677d90c-eb18-43ad-9e4a-355617689fe7'], 'ztl': ['3f4250c8-65c9-4015-916a-5e14f259abee'], 'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849'], 'test_user': ['test_session_regular', 'test_session_004', 'test_session_001', 'test_session_003', 'test_session_005', 'test_session_002']}
2025-06-24 11:09:41,986 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:ztl-1-2-3
2025-06-24 11:09:41,988 - __main__ - INFO - Deleted empty user_sessions collection for user ztl-1-2-3
2025-06-24 11:09:41,989 - __main__ - ERROR - 用户 ztl-1-2-3 的会话不存在
2025-06-24 11:09:41,993 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:ztl-1-2-3:6b900b9d-5a0d-4486-b078-9f7e8338672e
2025-06-24 11:09:41,994 - __main__ - INFO - Deleted empty user_sessions collection for user ztl-1-2-3
2025-06-24 11:09:41,995 - __main__ - ERROR - 用户 ztl-1-2-3:6b900b9d-5a0d-4486-b078-9f7e8338672e 的会话不存在
2025-06-24 11:09:48,160 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='ztl-1-2-3' session_id='6b900b9d-5a0d-4486-b078-9f7e8338672e' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:09:48,164 - __main__ - INFO - 成功获取用户ID: ztl-1-2-3 的长期记忆，内容长度: 0 字符
2025-06-24 11:09:48,164 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:09:48,166 - __main__ - INFO - Deleted empty user_sessions collection for user ztl-1-2-3
2025-06-24 11:09:50,421 - __main__ - INFO - 最终智能体回复结果:session_id='6b900b9d-5a0d-4486-b078-9f7e8338672e' status='completed' timestamp=1750734590.4208665 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='e0da68a9-acf2-4c37-933d-397bd68926af'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='55f90dce-b9d0-48dd-a0b7-a00f69962f6f'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--d73d585b-8b7f-44f8-8922-e47c17b0ec90', usage_metadata={'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='fba7f5fb-b8a3-4da0-a13d-6d01a231fd0f'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='fdd766e6-bf1a-4d48-b95d-d9ba0f795e0c'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloKbrjud3YRZuzLn0w0gzrO5rPSn', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--c1faa9d1-3cbc-43f7-ba47-bcee09381c23-0', usage_metadata={'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 11:09:50,429 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:ztl-1-2-3:6b900b9d-5a0d-4486-b078-9f7e8338672e
2025-06-24 11:09:50,432 - __main__ - INFO - 返回当前用户的会话状态:user_id='ztl-1-2-3' session_id='6b900b9d-5a0d-4486-b078-9f7e8338672e' status='completed' message=None last_query='你好' last_updated=1750734590.4230225 last_response=AgentResponse(session_id='6b900b9d-5a0d-4486-b078-9f7e8338672e', status='completed', timestamp=1750734590.4208665, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'e0da68a9-acf2-4c37-933d-397bd68926af'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '55f90dce-b9d0-48dd-a0b7-a00f69962f6f', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--d73d585b-8b7f-44f8-8922-e47c17b0ec90', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'fba7f5fb-b8a3-4da0-a13d-6d01a231fd0f'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'fdd766e6-bf1a-4d48-b95d-d9ba0f795e0c', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1421, 'total_tokens': 1432, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1280}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloKbrjud3YRZuzLn0w0gzrO5rPSn', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--c1faa9d1-3cbc-43f7-ba47-bcee09381c23-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1421, 'output_tokens': 11, 'total_tokens': 1432, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 11:10:01,688 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='ztl-1-2-3' session_id='6b900b9d-5a0d-4486-b078-9f7e8338672e' query='给我生成200字的科幻小说' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:10:01,691 - __main__ - INFO - 成功获取用户ID: ztl-1-2-3 的长期记忆，内容长度: 0 字符
2025-06-24 11:10:01,692 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:10:14,412 - __main__ - INFO - 当前触发工具调用中断:session_id='6b900b9d-5a0d-4486-b078-9f7e8338672e' status='interrupted' timestamp=1750734614.4119165 message=None result=None interrupt_data={'action_request': {'action': 'generate_image', 'args': {'prompt': "A science fiction story of 200 words. In the near future, Earth is on the brink of collapse due to resource depletion. Humanity discovers a planet called 'New Hope' with abundant water and a suitable climate. A team of elite scientists and astronauts embarks on a journey aboard the 'Star Pioneer' spaceship. After years of cryogenic sleep, they awaken to find a highly advanced alien civilization welcoming them. The aliens share their technology and ecological knowledge, fostering a deep friendship. However, one team member begins to suspect the aliens' true intentions and uncovers hidden secrets that reveal a complex relationship between humanity and the alien civilization. The future of humanity hangs in the balance, as they must decide whether to coexist with the aliens or face destruction."}}, 'config': None, 'description': '准备调用 generate_image 工具：\n- 参数为: {\'prompt\': "A science fiction story of 200 words. In the near future, Earth is on the brink of collapse due to resource depletion. Humanity discovers a planet called \'New Hope\' with abundant water and a suitable climate. A team of elite scientists and astronauts embarks on a journey aboard the \'Star Pioneer\' spaceship. After years of cryogenic sleep, they awaken to find a highly advanced alien civilization welcoming them. The aliens share their technology and ecological knowledge, fostering a deep friendship. However, one team member begins to suspect the aliens\' true intentions and uncovers hidden secrets that reveal a complex relationship between humanity and the alien civilization. The future of humanity hangs in the balance, as they must decide whether to coexist with the aliens or face destruction."}\n\n是否允许继续？\n输入 \'yes\' 接受工具调用\n输入 \'no\' 拒绝工具调用\n输入 \'edit\' 修改工具参数后调用工具\n输入 \'response\' 不调用工具直接反馈信息', 'interrupt_type': 'unknown'}
2025-06-24 11:11:11,185 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 11:11:15,794 - __main__ - INFO - Redis初始化成功
2025-06-24 11:11:16,133 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 11:11:16,133 - __main__ - INFO - Chat模型初始化成功
2025-06-24 11:11:16,173 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 11:11:16,204 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 11:11:19,889 - __main__ - INFO - Agent初始化成功
2025-06-24 11:11:19,889 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 11:11:24,612 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 11:11:24,641 - __main__ - INFO - 返回当前系统状态信息:sessions_count=13 active_users={'user_1750733521': ['cda5c313-6c91-400c-b85a-7cad2a2e9548'], 'user_1750732496': ['281afed9-c8ca-4fff-8e22-8db79e29d6a0'], '你好': ['c3319805-49d6-4e6f-9a0c-21ef94b55d67'], 'user_1750734513': ['0677d90c-eb18-43ad-9e4a-355617689fe7'], 'ztl-1-2-3': ['6b900b9d-5a0d-4486-b078-9f7e8338672e'], 'ztl': ['3f4250c8-65c9-4015-916a-5e14f259abee'], 'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849'], 'test_user': ['test_session_002', 'test_session_005', 'test_session_003', 'test_session_regular', 'test_session_004', 'test_session_001']}
2025-06-24 11:11:32,030 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:ztl-test-1
2025-06-24 11:11:32,032 - __main__ - INFO - Deleted empty user_sessions collection for user ztl-test-1
2025-06-24 11:11:32,032 - __main__ - ERROR - 用户 ztl-test-1 的会话不存在
2025-06-24 11:11:32,036 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:ztl-test-1:2395e27a-b601-4461-952d-7e1a92047673
2025-06-24 11:11:32,038 - __main__ - INFO - Deleted empty user_sessions collection for user ztl-test-1
2025-06-24 11:11:32,038 - __main__ - ERROR - 用户 ztl-test-1:2395e27a-b601-4461-952d-7e1a92047673 的会话不存在
2025-06-24 11:11:35,499 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='ztl-test-1' session_id='2395e27a-b601-4461-952d-7e1a92047673' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:11:35,504 - __main__ - INFO - 成功获取用户ID: ztl-test-1 的长期记忆，内容长度: 0 字符
2025-06-24 11:11:35,504 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:11:35,505 - __main__ - INFO - Deleted empty user_sessions collection for user ztl-test-1
2025-06-24 11:11:36,616 - __main__ - INFO - 最终智能体回复结果:session_id='2395e27a-b601-4461-952d-7e1a92047673' status='completed' timestamp=1750734696.6163712 message=None result={'agent': {'messages': [AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--a1702190-e192-4eae-887e-a7bc75b426cb', usage_metadata={'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}} interrupt_data=None
2025-06-24 11:11:36,629 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:ztl-test-1:2395e27a-b601-4461-952d-7e1a92047673
2025-06-24 11:11:36,631 - __main__ - INFO - 返回当前用户的会话状态:user_id='ztl-test-1' session_id='2395e27a-b601-4461-952d-7e1a92047673' status='completed' message=None last_query='你好' last_updated=1750734696.6186738 last_response=AgentResponse(session_id='2395e27a-b601-4461-952d-7e1a92047673', status='completed', timestamp=1750734696.6163712, message=None, result={'agent': {'messages': [{'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--a1702190-e192-4eae-887e-a7bc75b426cb', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}}, interrupt_data=None)
2025-06-24 11:11:51,515 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='ztl-test-1' session_id='2395e27a-b601-4461-952d-7e1a92047673' query='给我写一首诗' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:11:51,520 - __main__ - INFO - 成功获取用户ID: ztl-test-1 的长期记忆，内容长度: 0 字符
2025-06-24 11:11:51,520 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:11:53,500 - __main__ - INFO - 最终智能体回复结果:session_id='2395e27a-b601-4461-952d-7e1a92047673' status='completed' timestamp=1750734713.5007532 message=None result={'agent': {'messages': [AIMessage(content='在晨曦中轻舞飞扬，  \n微风拂面似梦乡。  \n花开满地香气浓，  \n鸟鸣声声入心房。  \n\n月下独行思绪远，  \n星辰点点照夜长。  \n人生如诗逐梦行，  \n愿与君共赏天涯。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--ce81bf80-3ef6-493c-9b18-30123d25a9ec', usage_metadata={'input_tokens': 1426, 'output_tokens': 75, 'total_tokens': 1501, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}} interrupt_data=None
2025-06-24 11:11:53,512 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:ztl-test-1:2395e27a-b601-4461-952d-7e1a92047673
2025-06-24 11:11:53,513 - __main__ - INFO - 返回当前用户的会话状态:user_id='ztl-test-1' session_id='2395e27a-b601-4461-952d-7e1a92047673' status='completed' message=None last_query='给我写一首诗' last_updated=1750734713.5025518 last_response=AgentResponse(session_id='2395e27a-b601-4461-952d-7e1a92047673', status='completed', timestamp=1750734713.5007532, message=None, result={'agent': {'messages': [{'content': '在晨曦中轻舞飞扬，  \n微风拂面似梦乡。  \n花开满地香气浓，  \n鸟鸣声声入心房。  \n\n月下独行思绪远，  \n星辰点点照夜长。  \n人生如诗逐梦行，  \n愿与君共赏天涯。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--ce81bf80-3ef6-493c-9b18-30123d25a9ec', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1426, 'output_tokens': 75, 'total_tokens': 1501, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}}, interrupt_data=None)
2025-06-24 11:13:26,923 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 11:13:30,302 - __main__ - INFO - Redis初始化成功
2025-06-24 11:13:30,628 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 11:13:30,629 - __main__ - INFO - Chat模型初始化成功
2025-06-24 11:13:30,691 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 11:13:30,703 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 11:13:33,944 - __main__ - INFO - Agent初始化成功
2025-06-24 11:13:33,944 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 11:13:37,156 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 11:13:40,513 - __main__ - INFO - Redis初始化成功
2025-06-24 11:13:40,855 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 11:13:40,856 - __main__ - INFO - Chat模型初始化成功
2025-06-24 11:13:40,914 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 11:13:40,927 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 11:13:44,675 - __main__ - INFO - Agent初始化成功
2025-06-24 11:13:44,675 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 11:13:50,900 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 11:13:50,924 - __main__ - INFO - 返回当前系统状态信息:sessions_count=14 active_users={'user_1750733521': ['cda5c313-6c91-400c-b85a-7cad2a2e9548'], 'user_1750732496': ['281afed9-c8ca-4fff-8e22-8db79e29d6a0'], '你好': ['c3319805-49d6-4e6f-9a0c-21ef94b55d67'], 'user_1750734513': ['0677d90c-eb18-43ad-9e4a-355617689fe7'], 'ztl-1-2-3': ['6b900b9d-5a0d-4486-b078-9f7e8338672e'], 'ztl': ['3f4250c8-65c9-4015-916a-5e14f259abee'], 'ztl-test-1': ['2395e27a-b601-4461-952d-7e1a92047673'], 'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849'], 'test_user': ['test_session_regular', 'test_session_004', 'test_session_002', 'test_session_001', 'test_session_005', 'test_session_003']}
2025-06-24 11:13:54,328 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:test-ztl-02
2025-06-24 11:13:54,331 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-02
2025-06-24 11:13:54,331 - __main__ - ERROR - 用户 test-ztl-02 的会话不存在
2025-06-24 11:13:54,335 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-02:c364e952-43ab-4919-b23f-463343530a1b
2025-06-24 11:13:54,336 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-02
2025-06-24 11:13:54,337 - __main__ - ERROR - 用户 test-ztl-02:c364e952-43ab-4919-b23f-463343530a1b 的会话不存在
2025-06-24 11:13:57,072 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-02' session_id='c364e952-43ab-4919-b23f-463343530a1b' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:13:57,077 - __main__ - INFO - 成功获取用户ID: test-ztl-02 的长期记忆，内容长度: 0 字符
2025-06-24 11:13:57,078 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:13:57,079 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-02
2025-06-24 11:13:58,528 - __main__ - INFO - 最终智能体回复结果:session_id='c364e952-43ab-4919-b23f-463343530a1b' status='completed' timestamp=1750734838.5283756 message=None result={'agent': {'messages': [AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1382, 'total_tokens': 1393, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BloObgxPgfEyQ8J6w94rgKziQaF7l', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--f67d4ed7-72b2-4259-b24f-c21d95ba2402-0', usage_metadata={'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}} interrupt_data=None
2025-06-24 11:13:58,542 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-02:c364e952-43ab-4919-b23f-463343530a1b
2025-06-24 11:13:58,546 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-02' session_id='c364e952-43ab-4919-b23f-463343530a1b' status='completed' message=None last_query='你好' last_updated=1750734838.5305855 last_response=AgentResponse(session_id='c364e952-43ab-4919-b23f-463343530a1b', status='completed', timestamp=1750734838.5283756, message=None, result={'agent': {'messages': [{'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1382, 'total_tokens': 1393, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BloObgxPgfEyQ8J6w94rgKziQaF7l', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--f67d4ed7-72b2-4259-b24f-c21d95ba2402-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1382, 'output_tokens': 11, 'total_tokens': 1393, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}}, interrupt_data=None)
2025-06-24 11:14:14,582 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-02' session_id='c364e952-43ab-4919-b23f-463343530a1b' query='给我生成200字的小作文' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:14:14,588 - __main__ - INFO - 成功获取用户ID: test-ztl-02 的长期记忆，内容长度: 0 字符
2025-06-24 11:14:14,589 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:14:16,978 - __main__ - INFO - 最终智能体回复结果:session_id='c364e952-43ab-4919-b23f-463343530a1b' status='completed' timestamp=1750734856.9784987 message=None result={'agent': {'messages': [AIMessage(content='当然可以！请问你希望小作文的主题是什么？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 15, 'prompt_tokens': 1427, 'total_tokens': 1442, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BloOtYL1drz49kWXcWBhrgQ1FzClP', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--5347fc2d-0aee-422d-bfaf-16deb592e1b1-0', usage_metadata={'input_tokens': 1427, 'output_tokens': 15, 'total_tokens': 1442, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}} interrupt_data=None
2025-06-24 11:14:16,993 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-02:c364e952-43ab-4919-b23f-463343530a1b
2025-06-24 11:14:16,995 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-02' session_id='c364e952-43ab-4919-b23f-463343530a1b' status='completed' message=None last_query='给我生成200字的小作文' last_updated=1750734856.9809508 last_response=AgentResponse(session_id='c364e952-43ab-4919-b23f-463343530a1b', status='completed', timestamp=1750734856.9784987, message=None, result={'agent': {'messages': [{'content': '当然可以！请问你希望小作文的主题是什么？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 15, 'prompt_tokens': 1427, 'total_tokens': 1442, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BloOtYL1drz49kWXcWBhrgQ1FzClP', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--5347fc2d-0aee-422d-bfaf-16deb592e1b1-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1427, 'output_tokens': 15, 'total_tokens': 1442, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}}, interrupt_data=None)
2025-06-24 11:14:22,848 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-02' session_id='c364e952-43ab-4919-b23f-463343530a1b' query='科幻主题' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:14:22,853 - __main__ - INFO - 成功获取用户ID: test-ztl-02 的长期记忆，内容长度: 0 字符
2025-06-24 11:14:22,853 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:14:24,327 - __main__ - INFO - 当前触发工具调用中断:session_id='c364e952-43ab-4919-b23f-463343530a1b' status='interrupted' timestamp=1750734864.3271825 message=None result=None interrupt_data={'action_request': {'action': 'generate_image', 'args': {'prompt': 'A futuristic cityscape with flying cars, neon lights, and advanced technology. The skyline is filled with towering skyscrapers, and people are seen using holographic devices. In the foreground, a group of diverse individuals is discussing a new invention that could change the world. The atmosphere is vibrant and energetic, showcasing a blend of nature and technology.'}}, 'config': None, 'description': "准备调用 generate_image 工具：\n- 参数为: {'prompt': 'A futuristic cityscape with flying cars, neon lights, and advanced technology. The skyline is filled with towering skyscrapers, and people are seen using holographic devices. In the foreground, a group of diverse individuals is discussing a new invention that could change the world. The atmosphere is vibrant and energetic, showcasing a blend of nature and technology.'}\n\n是否允许继续？\n输入 'yes' 接受工具调用\n输入 'no' 拒绝工具调用\n输入 'edit' 修改工具参数后调用工具\n输入 'response' 不调用工具直接反馈信息", 'interrupt_type': 'unknown'}
2025-06-24 11:15:33,158 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 11:15:44,571 - __main__ - INFO - Redis初始化成功
2025-06-24 11:15:44,903 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 11:15:44,903 - __main__ - INFO - Chat模型初始化成功
2025-06-24 11:15:44,963 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 11:15:44,975 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 11:15:48,179 - __main__ - INFO - Agent初始化成功
2025-06-24 11:15:48,180 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 11:15:49,844 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 11:15:49,871 - __main__ - INFO - 返回当前系统状态信息:sessions_count=15 active_users={'user_1750733521': ['cda5c313-6c91-400c-b85a-7cad2a2e9548'], 'user_1750732496': ['281afed9-c8ca-4fff-8e22-8db79e29d6a0'], '你好': ['c3319805-49d6-4e6f-9a0c-21ef94b55d67'], 'test-ztl-02': ['c364e952-43ab-4919-b23f-463343530a1b'], 'user_1750734513': ['0677d90c-eb18-43ad-9e4a-355617689fe7'], 'ztl-1-2-3': ['6b900b9d-5a0d-4486-b078-9f7e8338672e'], 'ztl': ['3f4250c8-65c9-4015-916a-5e14f259abee'], 'ztl-test-1': ['2395e27a-b601-4461-952d-7e1a92047673'], 'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849'], 'test_user': ['test_session_005', 'test_session_003', 'test_session_002', 'test_session_001', 'test_session_004', 'test_session_regular']}
2025-06-24 11:15:53,401 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:test-ztl-03
2025-06-24 11:15:53,402 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-03
2025-06-24 11:15:53,403 - __main__ - ERROR - 用户 test-ztl-03 的会话不存在
2025-06-24 11:15:53,406 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-03:6732faca-a438-4d71-98be-4988fad6acb1
2025-06-24 11:15:53,408 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-03
2025-06-24 11:15:53,408 - __main__ - ERROR - 用户 test-ztl-03:6732faca-a438-4d71-98be-4988fad6acb1 的会话不存在
2025-06-24 11:15:56,910 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-03' session_id='6732faca-a438-4d71-98be-4988fad6acb1' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:15:56,916 - __main__ - INFO - 成功获取用户ID: test-ztl-03 的长期记忆，内容长度: 0 字符
2025-06-24 11:15:56,916 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:15:56,918 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-03
2025-06-24 11:15:58,183 - __main__ - INFO - 最终智能体回复结果:session_id='6732faca-a438-4d71-98be-4988fad6acb1' status='completed' timestamp=1750734958.1829972 message=None result={'agent': {'messages': [AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1403, 'total_tokens': 1414, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BloQXib27LHvyO9wXTuh98g6ANHOz', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--bd044592-3db7-4cb1-9aa0-e18708914c50-0', usage_metadata={'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}} interrupt_data=None
2025-06-24 11:15:58,197 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-03:6732faca-a438-4d71-98be-4988fad6acb1
2025-06-24 11:15:58,199 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-03' session_id='6732faca-a438-4d71-98be-4988fad6acb1' status='completed' message=None last_query='你好' last_updated=1750734958.1854758 last_response=AgentResponse(session_id='6732faca-a438-4d71-98be-4988fad6acb1', status='completed', timestamp=1750734958.1829972, message=None, result={'agent': {'messages': [{'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1403, 'total_tokens': 1414, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BloQXib27LHvyO9wXTuh98g6ANHOz', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--bd044592-3db7-4cb1-9aa0-e18708914c50-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}}, interrupt_data=None)
2025-06-24 11:16:02,661 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-03' session_id='6732faca-a438-4d71-98be-4988fad6acb1' query='给我生成200字小作文' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:16:02,667 - __main__ - INFO - 成功获取用户ID: test-ztl-03 的长期记忆，内容长度: 0 字符
2025-06-24 11:16:02,667 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:16:13,790 - __main__ - INFO - 最终智能体回复结果:session_id='6732faca-a438-4d71-98be-4988fad6acb1' status='completed' timestamp=1750734973.7907853 message=None result={'agent': {'messages': [AIMessage(content='当然可以！以下是一篇200字的小作文：\n\n在一个阳光明媚的早晨，我决定去公园散步。公园里花香四溢，鸟儿在枝头欢快地歌唱，仿佛在欢迎我的到来。我漫步在小径上，欣赏着五彩斑斓的花朵，心情愉悦。突然，我看到一群孩子在草地上追逐嬉戏，他们的笑声如同清脆的铃铛，感染了我。\n\n我找了个长椅坐下，静静地观察周围的景象。老人在树下下棋，年轻的情侣在湖边喂鸭子，甚至还有人带着狗在跑步。生活在这里是如此美好，人与自然和谐共处。此刻，我感受到了一种宁静与满足。\n\n时间在不知不觉中流逝，我依依不舍地离开了公园。回家的路上，我的心中充满了阳光和温暖。这次散步让我明白，生活中的小确幸往往就在身边，只需用心去发现。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 258, 'prompt_tokens': 1448, 'total_tokens': 1706, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BloQdbHm46AcHoHBAWOBedE4DKKHs', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--b7f5fdae-e39a-41be-8e54-9a5fb440b7d4-0', usage_metadata={'input_tokens': 1448, 'output_tokens': 258, 'total_tokens': 1706, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]}} interrupt_data=None
2025-06-24 11:16:13,810 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-03:6732faca-a438-4d71-98be-4988fad6acb1
2025-06-24 11:16:13,813 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-03' session_id='6732faca-a438-4d71-98be-4988fad6acb1' status='completed' message=None last_query='给我生成200字小作文' last_updated=1750734973.7932725 last_response=AgentResponse(session_id='6732faca-a438-4d71-98be-4988fad6acb1', status='completed', timestamp=1750734973.7907853, message=None, result={'agent': {'messages': [{'content': '当然可以！以下是一篇200字的小作文：\n\n在一个阳光明媚的早晨，我决定去公园散步。公园里花香四溢，鸟儿在枝头欢快地歌唱，仿佛在欢迎我的到来。我漫步在小径上，欣赏着五彩斑斓的花朵，心情愉悦。突然，我看到一群孩子在草地上追逐嬉戏，他们的笑声如同清脆的铃铛，感染了我。\n\n我找了个长椅坐下，静静地观察周围的景象。老人在树下下棋，年轻的情侣在湖边喂鸭子，甚至还有人带着狗在跑步。生活在这里是如此美好，人与自然和谐共处。此刻，我感受到了一种宁静与满足。\n\n时间在不知不觉中流逝，我依依不舍地离开了公园。回家的路上，我的心中充满了阳光和温暖。这次散步让我明白，生活中的小确幸往往就在身边，只需用心去发现。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 258, 'prompt_tokens': 1448, 'total_tokens': 1706, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c', 'id': 'chatcmpl-BloQdbHm46AcHoHBAWOBedE4DKKHs', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--b7f5fdae-e39a-41be-8e54-9a5fb440b7d4-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1448, 'output_tokens': 258, 'total_tokens': 1706, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}}, interrupt_data=None)
2025-06-24 11:19:53,000 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 11:20:02,388 - __main__ - INFO - Redis初始化成功
2025-06-24 11:20:02,739 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 11:20:02,740 - __main__ - INFO - Chat模型初始化成功
2025-06-24 11:20:02,781 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 11:20:02,812 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 11:20:06,541 - __main__ - INFO - Agent初始化成功
2025-06-24 11:20:06,542 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 11:20:08,389 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 11:20:08,418 - __main__ - INFO - 返回当前系统状态信息:sessions_count=16 active_users={'user_1750733521': ['cda5c313-6c91-400c-b85a-7cad2a2e9548'], 'user_1750732496': ['281afed9-c8ca-4fff-8e22-8db79e29d6a0'], 'test-ztl-03': ['6732faca-a438-4d71-98be-4988fad6acb1'], '你好': ['c3319805-49d6-4e6f-9a0c-21ef94b55d67'], 'test-ztl-02': ['c364e952-43ab-4919-b23f-463343530a1b'], 'user_1750734513': ['0677d90c-eb18-43ad-9e4a-355617689fe7'], 'ztl-1-2-3': ['6b900b9d-5a0d-4486-b078-9f7e8338672e'], 'ztl': ['3f4250c8-65c9-4015-916a-5e14f259abee'], 'ztl-test-1': ['2395e27a-b601-4461-952d-7e1a92047673'], 'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849'], 'test_user': ['test_session_004', 'test_session_003', 'test_session_regular', 'test_session_002', 'test_session_001', 'test_session_005']}
2025-06-24 11:20:15,596 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:test-ztl-04
2025-06-24 11:20:15,597 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-04
2025-06-24 11:20:15,598 - __main__ - ERROR - 用户 test-ztl-04 的会话不存在
2025-06-24 11:20:15,603 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-04:0faaab0c-243d-48da-9608-ca5d6ba10c82
2025-06-24 11:20:15,604 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-04
2025-06-24 11:20:15,605 - __main__ - ERROR - 用户 test-ztl-04:0faaab0c-243d-48da-9608-ca5d6ba10c82 的会话不存在
2025-06-24 11:20:19,072 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-04' session_id='0faaab0c-243d-48da-9608-ca5d6ba10c82' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:20:19,077 - __main__ - INFO - 成功获取用户ID: test-ztl-04 的长期记忆，内容长度: 0 字符
2025-06-24 11:20:19,078 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:20:19,079 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-04
2025-06-24 11:20:21,607 - __main__ - INFO - 最终智能体回复结果:session_id='0faaab0c-243d-48da-9608-ca5d6ba10c82' status='completed' timestamp=1750735221.6073596 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='263f0a02-bec1-489a-87be-5c4b581b89b7'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='dba47b07-94d8-42dc-9ab1-e9edfc4435fb'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--f6820fb6-6610-451a-a8c8-87624fc6cbf5', usage_metadata={'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='4870ad59-6984-40fe-9811-b6603eed2cce'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='80dcfbd0-5aef-486d-90cc-f5ca4137a009'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1442, 'total_tokens': 1453, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloUme6fTy1EJ7Ht9KlqWL7Czo6HD', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--aefabf90-4746-4a95-86d1-402b03f37fd5-0', usage_metadata={'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 11:20:21,617 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-04:0faaab0c-243d-48da-9608-ca5d6ba10c82
2025-06-24 11:20:21,619 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-04' session_id='0faaab0c-243d-48da-9608-ca5d6ba10c82' status='completed' message=None last_query='你好' last_updated=1750735221.609831 last_response=AgentResponse(session_id='0faaab0c-243d-48da-9608-ca5d6ba10c82', status='completed', timestamp=1750735221.6073596, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '263f0a02-bec1-489a-87be-5c4b581b89b7'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'dba47b07-94d8-42dc-9ab1-e9edfc4435fb', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--f6820fb6-6610-451a-a8c8-87624fc6cbf5', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '4870ad59-6984-40fe-9811-b6603eed2cce'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '80dcfbd0-5aef-486d-90cc-f5ca4137a009', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1442, 'total_tokens': 1453, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloUme6fTy1EJ7Ht9KlqWL7Czo6HD', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--aefabf90-4746-4a95-86d1-402b03f37fd5-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 11:20:36,682 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-04' session_id='0faaab0c-243d-48da-9608-ca5d6ba10c82' query='给我写200字的童话故事' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:20:36,686 - __main__ - INFO - 成功获取用户ID: test-ztl-04 的长期记忆，内容长度: 0 字符
2025-06-24 11:20:36,687 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:20:42,197 - __main__ - INFO - 最终智能体回复结果:session_id='0faaab0c-243d-48da-9608-ca5d6ba10c82' status='completed' timestamp=1750735242.197354 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='263f0a02-bec1-489a-87be-5c4b581b89b7'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='dba47b07-94d8-42dc-9ab1-e9edfc4435fb'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--f6820fb6-6610-451a-a8c8-87624fc6cbf5', usage_metadata={'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='4870ad59-6984-40fe-9811-b6603eed2cce'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='80dcfbd0-5aef-486d-90cc-f5ca4137a009'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1442, 'total_tokens': 1453, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloUme6fTy1EJ7Ht9KlqWL7Czo6HD', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--aefabf90-4746-4a95-86d1-402b03f37fd5-0', usage_metadata={'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='e1f09cc9-f530-48a6-8de0-740bc671772e'), HumanMessage(content='给我写200字的童话故事', additional_kwargs={}, response_metadata={}, id='92f8046f-94d2-4f78-93a6-e94fa1ef5607'), AIMessage(content='从前，在一个美丽的森林里，住着一只小兔子，名叫莉莉。莉莉非常喜欢冒险，每天都在森林里探索。有一天，她在一棵古老的橡树下发现了一扇神秘的门。好奇的莉莉推开门，走了进去，发现自己来到了一个五彩斑斓的梦幻世界。\n\n在这个世界里，动物们会说话，花朵会跳舞。莉莉结识了一只友好的小狐狸，名叫菲菲。菲菲告诉她，这个世界的颜色是由快乐和友谊构成的。可是，最近一只坏狼来到了这里，偷走了快乐的颜色，导致这个世界变得暗淡无光。\n\n莉莉和菲菲决定一起去找回颜色。他们勇敢地面对坏狼，利用智慧和友谊的力量，最终成功地把颜色夺回。梦幻世界恢复了生机，动物们欢呼雀跃。莉莉明白了，真正的快乐来自于朋友之间的团结与信任。\n\n从此，莉莉和菲菲成为了最好的朋友，继续在森林和梦幻世界中冒险。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--a01b4383-0188-4242-8a89-55b9426dae85', usage_metadata={'input_tokens': 1489, 'output_tokens': 269, 'total_tokens': 1758, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='630f3053-3dab-4e71-bb84-f76a9e3b535d'), HumanMessage(content='给我写200字的童话故事', additional_kwargs={}, response_metadata={}, id='6956f5f4-7f30-437f-bb82-f2e6cb2ce984'), AIMessage(content='从前，在一个宁静的村庄里，住着一位善良的女孩，名叫艾米。艾米每天都帮助村民们，照顾小动物，大家都非常喜欢她。一天，艾米在森林里散步时，发现了一只受伤的小鸟。她小心翼翼地把小鸟带回家，细心照料。\n\n几天后，小鸟的伤愈合了，变得活泼可爱。为了感谢艾米，小鸟告诉她一个秘密：在森林深处有一棵神奇的许愿树，能实现一个愿望。艾米心中充满了好奇，决定去寻找这棵树。\n\n经过一番努力，艾米终于找到了许愿树。她闭上眼睛，许下了一个愿望：“希望村庄里的每个人都能幸福快乐。”当她睁开眼睛时，树上绽放出五彩斑斓的花朵，村庄里的人们都感受到了幸福的气息。\n\n从那以后，村庄变得更加和谐美好，艾米也成为了大家心中的小英雄。她明白，真正的快乐来自于关心他人和无私的爱。', additional_kwargs={'refusal': None}, response_metadata={'token_usage': {'completion_tokens': 276, 'prompt_tokens': 1794, 'total_tokens': 2070, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloV5AdoqkfpyiL4z2gOo0QJtf6ky', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, id='run--e2b15df3-7c3d-4f24-aa8c-8c305d3d6654-0', usage_metadata={'input_tokens': 1794, 'output_tokens': 276, 'total_tokens': 2070, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 11:20:42,208 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-04:0faaab0c-243d-48da-9608-ca5d6ba10c82
2025-06-24 11:20:42,211 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-04' session_id='0faaab0c-243d-48da-9608-ca5d6ba10c82' status='completed' message=None last_query='给我写200字的童话故事' last_updated=1750735242.1999786 last_response=AgentResponse(session_id='0faaab0c-243d-48da-9608-ca5d6ba10c82', status='completed', timestamp=1750735242.197354, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '263f0a02-bec1-489a-87be-5c4b581b89b7'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'dba47b07-94d8-42dc-9ab1-e9edfc4435fb', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--f6820fb6-6610-451a-a8c8-87624fc6cbf5', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '4870ad59-6984-40fe-9811-b6603eed2cce'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '80dcfbd0-5aef-486d-90cc-f5ca4137a009', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 11, 'prompt_tokens': 1442, 'total_tokens': 1453, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 1024}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloUme6fTy1EJ7Ht9KlqWL7Czo6HD', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--aefabf90-4746-4a95-86d1-402b03f37fd5-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 1024}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'e1f09cc9-f530-48a6-8de0-740bc671772e'}, {'content': '给我写200字的童话故事', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '92f8046f-94d2-4f78-93a6-e94fa1ef5607', 'example': False}, {'content': '从前，在一个美丽的森林里，住着一只小兔子，名叫莉莉。莉莉非常喜欢冒险，每天都在森林里探索。有一天，她在一棵古老的橡树下发现了一扇神秘的门。好奇的莉莉推开门，走了进去，发现自己来到了一个五彩斑斓的梦幻世界。\n\n在这个世界里，动物们会说话，花朵会跳舞。莉莉结识了一只友好的小狐狸，名叫菲菲。菲菲告诉她，这个世界的颜色是由快乐和友谊构成的。可是，最近一只坏狼来到了这里，偷走了快乐的颜色，导致这个世界变得暗淡无光。\n\n莉莉和菲菲决定一起去找回颜色。他们勇敢地面对坏狼，利用智慧和友谊的力量，最终成功地把颜色夺回。梦幻世界恢复了生机，动物们欢呼雀跃。莉莉明白了，真正的快乐来自于朋友之间的团结与信任。\n\n从此，莉莉和菲菲成为了最好的朋友，继续在森林和梦幻世界中冒险。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--a01b4383-0188-4242-8a89-55b9426dae85', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1489, 'output_tokens': 269, 'total_tokens': 1758, 'input_token_details': {'audio': 0, 'cache_read': 1280}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '630f3053-3dab-4e71-bb84-f76a9e3b535d'}, {'content': '给我写200字的童话故事', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '6956f5f4-7f30-437f-bb82-f2e6cb2ce984', 'example': False}, {'content': '从前，在一个宁静的村庄里，住着一位善良的女孩，名叫艾米。艾米每天都帮助村民们，照顾小动物，大家都非常喜欢她。一天，艾米在森林里散步时，发现了一只受伤的小鸟。她小心翼翼地把小鸟带回家，细心照料。\n\n几天后，小鸟的伤愈合了，变得活泼可爱。为了感谢艾米，小鸟告诉她一个秘密：在森林深处有一棵神奇的许愿树，能实现一个愿望。艾米心中充满了好奇，决定去寻找这棵树。\n\n经过一番努力，艾米终于找到了许愿树。她闭上眼睛，许下了一个愿望：“希望村庄里的每个人都能幸福快乐。”当她睁开眼睛时，树上绽放出五彩斑斓的花朵，村庄里的人们都感受到了幸福的气息。\n\n从那以后，村庄变得更加和谐美好，艾米也成为了大家心中的小英雄。她明白，真正的快乐来自于关心他人和无私的爱。', 'additional_kwargs': {'refusal': None}, 'response_metadata': {'token_usage': {'completion_tokens': 276, 'prompt_tokens': 1794, 'total_tokens': 2070, 'completion_tokens_details': {'accepted_prediction_tokens': 0, 'audio_tokens': 0, 'reasoning_tokens': 0, 'rejected_prediction_tokens': 0}, 'prompt_tokens_details': {'audio_tokens': 0, 'cached_tokens': 0}}, 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2', 'id': 'chatcmpl-BloV5AdoqkfpyiL4z2gOo0QJtf6ky', 'service_tier': None, 'finish_reason': 'stop', 'logprobs': None}, 'type': 'ai', 'name': None, 'id': 'run--e2b15df3-7c3d-4f24-aa8c-8c305d3d6654-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1794, 'output_tokens': 276, 'total_tokens': 2070, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 11:26:09,283 - __main__ - INFO - 关闭服务并完成资源清理
2025-06-24 11:26:18,787 - __main__ - INFO - Redis初始化成功
2025-06-24 11:26:19,125 - utils.llms - INFO - 成功初始化 openai LLM
2025-06-24 11:26:19,126 - __main__ - INFO - Chat模型初始化成功
2025-06-24 11:26:19,191 - __main__ - INFO - 短期记忆Checkpointer初始化成功
2025-06-24 11:26:19,194 - __main__ - INFO - 长期记忆store初始化成功
2025-06-24 11:26:22,580 - __main__ - INFO - Agent初始化成功
2025-06-24 11:26:22,581 - __main__ - INFO - 服务完成初始化并启动服务
2025-06-24 11:26:25,288 - __main__ - INFO - 调用/system/info接口，获取当前系统内全部的会话状态信息
2025-06-24 11:26:25,319 - __main__ - INFO - 返回当前系统状态信息:sessions_count=17 active_users={'user_1750733521': ['cda5c313-6c91-400c-b85a-7cad2a2e9548'], 'user_1750732496': ['281afed9-c8ca-4fff-8e22-8db79e29d6a0'], 'test-ztl-03': ['6732faca-a438-4d71-98be-4988fad6acb1'], '你好': ['c3319805-49d6-4e6f-9a0c-21ef94b55d67'], 'test-ztl-02': ['c364e952-43ab-4919-b23f-463343530a1b'], 'user_1750734513': ['0677d90c-eb18-43ad-9e4a-355617689fe7'], 'ztl-1-2-3': ['6b900b9d-5a0d-4486-b078-9f7e8338672e'], 'ztl': ['3f4250c8-65c9-4015-916a-5e14f259abee'], 'ztl-test-1': ['2395e27a-b601-4461-952d-7e1a92047673'], 'user_1750731975': ['8dd00a70-dc21-4542-b632-962c7a8ec849'], 'test-ztl-04': ['0faaab0c-243d-48da-9608-ca5d6ba10c82'], 'test_user': ['test_session_002', 'test_session_003', 'test_session_004', 'test_session_001', 'test_session_005', 'test_session_regular']}
2025-06-24 11:26:32,054 - __main__ - INFO - 调用/agent/active/sessionid/接口，获取指定用户当前最近一次更新的会话ID，接受到前端用户请求:test-ztl-05
2025-06-24 11:26:32,056 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-05
2025-06-24 11:26:32,056 - __main__ - ERROR - 用户 test-ztl-05 的会话不存在
2025-06-24 11:26:32,060 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-05:8b70f4a8-779d-4df1-9b10-186cdc357b17
2025-06-24 11:26:32,062 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-05
2025-06-24 11:26:32,063 - __main__ - ERROR - 用户 test-ztl-05:8b70f4a8-779d-4df1-9b10-186cdc357b17 的会话不存在
2025-06-24 11:26:34,589 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-05' session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' query='你好' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:26:34,594 - __main__ - INFO - 成功获取用户ID: test-ztl-05 的长期记忆，内容长度: 0 字符
2025-06-24 11:26:34,595 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:26:34,596 - __main__ - INFO - Deleted empty user_sessions collection for user test-ztl-05
2025-06-24 11:26:36,688 - __main__ - INFO - 最终智能体回复结果:session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' status='completed' timestamp=1750735596.6880565 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='148ff5d2-5ed9-4215-8858-c5786186d42b'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='51b50e7f-937d-4f79-92e4-68a76b1a6d8f'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--370df195-201b-43e1-b269-014e34ffb584', usage_metadata={'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='107c5e4a-6ddd-4bcf-9919-1f90c11e3479'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='c37a4a4f-7688-4e01-8a28-f3ad5393719b'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--bda34cd7-5347-48bd-a72b-a2d38c25999f-0', usage_metadata={'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 11:26:36,696 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-05:8b70f4a8-779d-4df1-9b10-186cdc357b17
2025-06-24 11:26:36,699 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-05' session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' status='completed' message=None last_query='你好' last_updated=1750735596.6900904 last_response=AgentResponse(session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17', status='completed', timestamp=1750735596.6880565, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '148ff5d2-5ed9-4215-8858-c5786186d42b'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '51b50e7f-937d-4f79-92e4-68a76b1a6d8f', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--370df195-201b-43e1-b269-014e34ffb584', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '107c5e4a-6ddd-4bcf-9919-1f90c11e3479'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c37a4a4f-7688-4e01-8a28-f3ad5393719b', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--bda34cd7-5347-48bd-a72b-a2d38c25999f-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 11:26:49,246 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-05' session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' query='给我生成200字小作文，主题' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:26:49,250 - __main__ - INFO - 成功获取用户ID: test-ztl-05 的长期记忆，内容长度: 0 字符
2025-06-24 11:26:49,251 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:26:51,248 - __main__ - INFO - 最终智能体回复结果:session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' status='completed' timestamp=1750735611.2481616 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='148ff5d2-5ed9-4215-8858-c5786186d42b'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='51b50e7f-937d-4f79-92e4-68a76b1a6d8f'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--370df195-201b-43e1-b269-014e34ffb584', usage_metadata={'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='107c5e4a-6ddd-4bcf-9919-1f90c11e3479'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='c37a4a4f-7688-4e01-8a28-f3ad5393719b'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--bda34cd7-5347-48bd-a72b-a2d38c25999f-0', usage_metadata={'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='ee53c55e-6296-45a3-bcd5-ea60eeb4a731'), HumanMessage(content='给我生成200字小作文，主题', additional_kwargs={}, response_metadata={}, id='a686fc6b-a21f-472b-9b05-f64b62f9482a'), AIMessage(content='请提供一个主题，我将为您生成一篇200字的小作文。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--7633c32b-f9c6-40c3-ad21-cf56e7a37ed3', usage_metadata={'input_tokens': 1489, 'output_tokens': 18, 'total_tokens': 1507, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='3aa8935e-7f01-44ae-ab46-dd28bfdfac8d'), HumanMessage(content='给我生成200字小作文，主题', additional_kwargs={}, response_metadata={}, id='e210449c-baf0-454a-8d66-d48fb9e205da'), AIMessage(content='请提供一个具体的主题，我将为您生成一篇200字的小作文。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--f0f784c1-f5e2-48c6-b34e-bb8f31220677-0', usage_metadata={'input_tokens': 1543, 'output_tokens': 20, 'total_tokens': 1563, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 11:26:51,257 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-05:8b70f4a8-779d-4df1-9b10-186cdc357b17
2025-06-24 11:26:51,260 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-05' session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' status='completed' message=None last_query='给我生成200字小作文，主题' last_updated=1750735611.2505827 last_response=AgentResponse(session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17', status='completed', timestamp=1750735611.2481616, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '148ff5d2-5ed9-4215-8858-c5786186d42b'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '51b50e7f-937d-4f79-92e4-68a76b1a6d8f', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--370df195-201b-43e1-b269-014e34ffb584', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '107c5e4a-6ddd-4bcf-9919-1f90c11e3479'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c37a4a4f-7688-4e01-8a28-f3ad5393719b', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--bda34cd7-5347-48bd-a72b-a2d38c25999f-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'ee53c55e-6296-45a3-bcd5-ea60eeb4a731'}, {'content': '给我生成200字小作文，主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'a686fc6b-a21f-472b-9b05-f64b62f9482a', 'example': False}, {'content': '请提供一个主题，我将为您生成一篇200字的小作文。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--7633c32b-f9c6-40c3-ad21-cf56e7a37ed3', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1489, 'output_tokens': 18, 'total_tokens': 1507, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '3aa8935e-7f01-44ae-ab46-dd28bfdfac8d'}, {'content': '给我生成200字小作文，主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'e210449c-baf0-454a-8d66-d48fb9e205da', 'example': False}, {'content': '请提供一个具体的主题，我将为您生成一篇200字的小作文。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--f0f784c1-f5e2-48c6-b34e-bb8f31220677-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1543, 'output_tokens': 20, 'total_tokens': 1563, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 11:26:54,459 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-05' session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' query='爱情主题' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:26:54,462 - __main__ - INFO - 成功获取用户ID: test-ztl-05 的长期记忆，内容长度: 0 字符
2025-06-24 11:26:54,463 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:27:04,127 - __main__ - INFO - 当前触发工具调用中断:session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' status='interrupted' timestamp=1750735624.1270676 message=None result=None interrupt_data={'action_request': {'action': 'generate_image', 'args': {'prompt': 'A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection.'}}, 'config': None, 'description': "准备调用 generate_image 工具：\n- 参数为: {'prompt': 'A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection.'}\n\n是否允许继续？\n输入 'yes' 接受工具调用\n输入 'no' 拒绝工具调用\n输入 'edit' 修改工具参数后调用工具\n输入 'response' 不调用工具直接反馈信息", 'interrupt_type': 'unknown'}
2025-06-24 11:27:16,710 - __main__ - INFO - 调用/agent/resume接口，恢复被中断的智能体运行并等待运行完成或再次中断，接受到前端用户请求:user_id='test-ztl-05' session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' response_type='reject' args=None
2025-06-24 11:27:16,721 - utils.tools - INFO - response: {'type': 'reject'}
2025-06-24 11:27:16,721 - utils.tools - INFO - 工具调用被拒绝，等待用户输入...
2025-06-24 11:27:19,270 - __main__ - INFO - 最终智能体回复结果:session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' status='completed' timestamp=1750735639.2704008 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='148ff5d2-5ed9-4215-8858-c5786186d42b'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='51b50e7f-937d-4f79-92e4-68a76b1a6d8f'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--370df195-201b-43e1-b269-014e34ffb584', usage_metadata={'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='107c5e4a-6ddd-4bcf-9919-1f90c11e3479'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='c37a4a4f-7688-4e01-8a28-f3ad5393719b'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--bda34cd7-5347-48bd-a72b-a2d38c25999f-0', usage_metadata={'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='ee53c55e-6296-45a3-bcd5-ea60eeb4a731'), HumanMessage(content='给我生成200字小作文，主题', additional_kwargs={}, response_metadata={}, id='a686fc6b-a21f-472b-9b05-f64b62f9482a'), AIMessage(content='请提供一个主题，我将为您生成一篇200字的小作文。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--7633c32b-f9c6-40c3-ad21-cf56e7a37ed3', usage_metadata={'input_tokens': 1489, 'output_tokens': 18, 'total_tokens': 1507, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='3aa8935e-7f01-44ae-ab46-dd28bfdfac8d'), HumanMessage(content='给我生成200字小作文，主题', additional_kwargs={}, response_metadata={}, id='e210449c-baf0-454a-8d66-d48fb9e205da'), AIMessage(content='请提供一个具体的主题，我将为您生成一篇200字的小作文。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--f0f784c1-f5e2-48c6-b34e-bb8f31220677-0', usage_metadata={'input_tokens': 1543, 'output_tokens': 20, 'total_tokens': 1563, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='173b0a3a-2dc3-4e7f-90aa-66443ca2e9dd'), HumanMessage(content='爱情主题', additional_kwargs={}, response_metadata={}, id='e1f59a36-2e4b-4849-b906-59d8a6520507'), AIMessage(content='在这个喧嚣的城市中，爱情如同一缕清风，悄然无声地吹拂着每一个角落。初见时的心动，仿佛是春天的第一缕阳光，温暖而明亮。两个人的目光交汇，瞬间点燃了心底的火花。随着时间的推移，爱情的滋味愈发醇厚，像一杯陈年佳酿，愈久愈香。\n\n然而，爱情并非总是一帆风顺。生活的琐碎与压力，时常考验着彼此的信任与包容。争吵与误解在所难免，但正是这些波折，让我们更加珍惜彼此。每一次和解，都是心灵的重生，让爱情在磨砺中愈加坚韧。\n\n在这个快节奏的时代，爱情教会我们慢下来，去倾听对方的心声，去感受那份温暖。无论未来的路有多么曲折，只要心中有爱，便能携手共度每一个晨昏。爱情，是生命中最美的篇章，值得我们用心去书写。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--b6b9507b-ec1b-419b-9b8f-6cbc4ab87a09', usage_metadata={'input_tokens': 1592, 'output_tokens': 276, 'total_tokens': 1868, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='625485df-d63b-4a04-9eaa-53b1f42d67f1'), HumanMessage(content='爱情主题', additional_kwargs={}, response_metadata={}, id='ba59f124-9106-4f5f-b76a-dbbfc375ad8f'), AIMessage(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'function': {'arguments': '{"prompt":"A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection."}', 'name': 'generate_image'}, 'type': 'function'}]}, response_metadata={'finish_reason': 'tool_calls', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--82f5f9ad-6aba-4ffb-819e-b47d0118ee25-0', tool_calls=[{'name': 'generate_image', 'args': {'prompt': 'A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection.'}, 'id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1897, 'output_tokens': 41, 'total_tokens': 1938, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='该工具被拒绝使用，请尝试其他方法或拒绝回答问题。', name='generate_image', id='c1baca50-f453-4fdd-98e6-7ca334663e0c', tool_call_id='call_ekDvX0n8uqeQFb4BIDRL69rL'), AIMessage(content='在这个喧嚣的城市中，爱情如同一缕清风，悄然无声地吹拂着每一个角落。初见时的心动，仿佛是春天的第一缕阳光，温暖而明亮。两个人的目光交汇，瞬间点燃了心底的火花。随着时间的推移，爱情的滋味愈发醇厚，像一杯陈年佳酿，愈久愈香。\n\n然而，爱情并非总是一帆风顺。生活的琐碎与压力，时常考验着彼此的信任与包容。争吵与误解在所难免，但正是这些波折，让我们更加珍惜彼此。每一次和解，都是心灵的重生，让爱情在磨砺中愈加坚韧。\n\n在这个快节奏的时代，爱情教会我们慢下来，去倾听对方的心声，去感受那份温暖。无论未来的路有多么曲折，只要心中有爱，便能携手共度每一个晨昏。爱情，是生命中最美的篇章，值得我们用心去书写。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--41034c77-3431-4eaf-9bfc-60c53eb9578d-0', usage_metadata={'input_tokens': 1962, 'output_tokens': 276, 'total_tokens': 2238, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 11:27:19,281 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-05:8b70f4a8-779d-4df1-9b10-186cdc357b17
2025-06-24 11:27:19,284 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-05' session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' status='completed' message=None last_query='爱情主题' last_updated=1750735639.2728372 last_response=AgentResponse(session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17', status='completed', timestamp=1750735639.2704008, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '148ff5d2-5ed9-4215-8858-c5786186d42b'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '51b50e7f-937d-4f79-92e4-68a76b1a6d8f', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--370df195-201b-43e1-b269-014e34ffb584', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '107c5e4a-6ddd-4bcf-9919-1f90c11e3479'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c37a4a4f-7688-4e01-8a28-f3ad5393719b', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--bda34cd7-5347-48bd-a72b-a2d38c25999f-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'ee53c55e-6296-45a3-bcd5-ea60eeb4a731'}, {'content': '给我生成200字小作文，主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'a686fc6b-a21f-472b-9b05-f64b62f9482a', 'example': False}, {'content': '请提供一个主题，我将为您生成一篇200字的小作文。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--7633c32b-f9c6-40c3-ad21-cf56e7a37ed3', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1489, 'output_tokens': 18, 'total_tokens': 1507, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '3aa8935e-7f01-44ae-ab46-dd28bfdfac8d'}, {'content': '给我生成200字小作文，主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'e210449c-baf0-454a-8d66-d48fb9e205da', 'example': False}, {'content': '请提供一个具体的主题，我将为您生成一篇200字的小作文。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--f0f784c1-f5e2-48c6-b34e-bb8f31220677-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1543, 'output_tokens': 20, 'total_tokens': 1563, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '173b0a3a-2dc3-4e7f-90aa-66443ca2e9dd'}, {'content': '爱情主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'e1f59a36-2e4b-4849-b906-59d8a6520507', 'example': False}, {'content': '在这个喧嚣的城市中，爱情如同一缕清风，悄然无声地吹拂着每一个角落。初见时的心动，仿佛是春天的第一缕阳光，温暖而明亮。两个人的目光交汇，瞬间点燃了心底的火花。随着时间的推移，爱情的滋味愈发醇厚，像一杯陈年佳酿，愈久愈香。\n\n然而，爱情并非总是一帆风顺。生活的琐碎与压力，时常考验着彼此的信任与包容。争吵与误解在所难免，但正是这些波折，让我们更加珍惜彼此。每一次和解，都是心灵的重生，让爱情在磨砺中愈加坚韧。\n\n在这个快节奏的时代，爱情教会我们慢下来，去倾听对方的心声，去感受那份温暖。无论未来的路有多么曲折，只要心中有爱，便能携手共度每一个晨昏。爱情，是生命中最美的篇章，值得我们用心去书写。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--b6b9507b-ec1b-419b-9b8f-6cbc4ab87a09', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1592, 'output_tokens': 276, 'total_tokens': 1868, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '625485df-d63b-4a04-9eaa-53b1f42d67f1'}, {'content': '爱情主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'ba59f124-9106-4f5f-b76a-dbbfc375ad8f', 'example': False}, {'content': '', 'additional_kwargs': {'tool_calls': [{'index': 0, 'id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'function': {'arguments': '{"prompt":"A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection."}', 'name': 'generate_image'}, 'type': 'function'}]}, 'response_metadata': {'finish_reason': 'tool_calls', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--82f5f9ad-6aba-4ffb-819e-b47d0118ee25-0', 'example': False, 'tool_calls': [{'name': 'generate_image', 'args': {'prompt': 'A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection.'}, 'id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'type': 'tool_call'}], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1897, 'output_tokens': 41, 'total_tokens': 1938, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '该工具被拒绝使用，请尝试其他方法或拒绝回答问题。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'tool', 'name': 'generate_image', 'id': 'c1baca50-f453-4fdd-98e6-7ca334663e0c', 'tool_call_id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'artifact': None, 'status': 'success'}, {'content': '在这个喧嚣的城市中，爱情如同一缕清风，悄然无声地吹拂着每一个角落。初见时的心动，仿佛是春天的第一缕阳光，温暖而明亮。两个人的目光交汇，瞬间点燃了心底的火花。随着时间的推移，爱情的滋味愈发醇厚，像一杯陈年佳酿，愈久愈香。\n\n然而，爱情并非总是一帆风顺。生活的琐碎与压力，时常考验着彼此的信任与包容。争吵与误解在所难免，但正是这些波折，让我们更加珍惜彼此。每一次和解，都是心灵的重生，让爱情在磨砺中愈加坚韧。\n\n在这个快节奏的时代，爱情教会我们慢下来，去倾听对方的心声，去感受那份温暖。无论未来的路有多么曲折，只要心中有爱，便能携手共度每一个晨昏。爱情，是生命中最美的篇章，值得我们用心去书写。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--41034c77-3431-4eaf-9bfc-60c53eb9578d-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1962, 'output_tokens': 276, 'total_tokens': 2238, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 11:27:37,669 - __main__ - INFO - 调用/agent/invoke/stream接口，流式运行智能体，接受到前端用户请求:user_id='test-ztl-05' session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' query='我写一个纯文本的500字的故事' system_message='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。'
2025-06-24 11:27:37,674 - __main__ - INFO - 成功获取用户ID: test-ztl-05 的长期记忆，内容长度: 0 字符
2025-06-24 11:27:37,674 - __main__ - INFO - 未获取到用户偏好配置数据，system_message的信息为:你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。
2025-06-24 11:28:17,743 - __main__ - INFO - 最终智能体回复结果:session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' status='completed' timestamp=1750735697.7433329 message=None result={'messages': [SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='148ff5d2-5ed9-4215-8858-c5786186d42b'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='51b50e7f-937d-4f79-92e4-68a76b1a6d8f'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--370df195-201b-43e1-b269-014e34ffb584', usage_metadata={'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='107c5e4a-6ddd-4bcf-9919-1f90c11e3479'), HumanMessage(content='你好', additional_kwargs={}, response_metadata={}, id='c37a4a4f-7688-4e01-8a28-f3ad5393719b'), AIMessage(content='你好！有什么我可以帮助你的吗？', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--bda34cd7-5347-48bd-a72b-a2d38c25999f-0', usage_metadata={'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='ee53c55e-6296-45a3-bcd5-ea60eeb4a731'), HumanMessage(content='给我生成200字小作文，主题', additional_kwargs={}, response_metadata={}, id='a686fc6b-a21f-472b-9b05-f64b62f9482a'), AIMessage(content='请提供一个主题，我将为您生成一篇200字的小作文。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--7633c32b-f9c6-40c3-ad21-cf56e7a37ed3', usage_metadata={'input_tokens': 1489, 'output_tokens': 18, 'total_tokens': 1507, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='3aa8935e-7f01-44ae-ab46-dd28bfdfac8d'), HumanMessage(content='给我生成200字小作文，主题', additional_kwargs={}, response_metadata={}, id='e210449c-baf0-454a-8d66-d48fb9e205da'), AIMessage(content='请提供一个具体的主题，我将为您生成一篇200字的小作文。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--f0f784c1-f5e2-48c6-b34e-bb8f31220677-0', usage_metadata={'input_tokens': 1543, 'output_tokens': 20, 'total_tokens': 1563, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='173b0a3a-2dc3-4e7f-90aa-66443ca2e9dd'), HumanMessage(content='爱情主题', additional_kwargs={}, response_metadata={}, id='e1f59a36-2e4b-4849-b906-59d8a6520507'), AIMessage(content='在这个喧嚣的城市中，爱情如同一缕清风，悄然无声地吹拂着每一个角落。初见时的心动，仿佛是春天的第一缕阳光，温暖而明亮。两个人的目光交汇，瞬间点燃了心底的火花。随着时间的推移，爱情的滋味愈发醇厚，像一杯陈年佳酿，愈久愈香。\n\n然而，爱情并非总是一帆风顺。生活的琐碎与压力，时常考验着彼此的信任与包容。争吵与误解在所难免，但正是这些波折，让我们更加珍惜彼此。每一次和解，都是心灵的重生，让爱情在磨砺中愈加坚韧。\n\n在这个快节奏的时代，爱情教会我们慢下来，去倾听对方的心声，去感受那份温暖。无论未来的路有多么曲折，只要心中有爱，便能携手共度每一个晨昏。爱情，是生命中最美的篇章，值得我们用心去书写。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--b6b9507b-ec1b-419b-9b8f-6cbc4ab87a09', usage_metadata={'input_tokens': 1592, 'output_tokens': 276, 'total_tokens': 1868, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='625485df-d63b-4a04-9eaa-53b1f42d67f1'), HumanMessage(content='爱情主题', additional_kwargs={}, response_metadata={}, id='ba59f124-9106-4f5f-b76a-dbbfc375ad8f'), AIMessage(content='', additional_kwargs={'tool_calls': [{'index': 0, 'id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'function': {'arguments': '{"prompt":"A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection."}', 'name': 'generate_image'}, 'type': 'function'}]}, response_metadata={'finish_reason': 'tool_calls', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--82f5f9ad-6aba-4ffb-819e-b47d0118ee25-0', tool_calls=[{'name': 'generate_image', 'args': {'prompt': 'A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection.'}, 'id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'type': 'tool_call'}], usage_metadata={'input_tokens': 1897, 'output_tokens': 41, 'total_tokens': 1938, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), ToolMessage(content='该工具被拒绝使用，请尝试其他方法或拒绝回答问题。', name='generate_image', id='c1baca50-f453-4fdd-98e6-7ca334663e0c', tool_call_id='call_ekDvX0n8uqeQFb4BIDRL69rL'), AIMessage(content='在这个喧嚣的城市中，爱情如同一缕清风，悄然无声地吹拂着每一个角落。初见时的心动，仿佛是春天的第一缕阳光，温暖而明亮。两个人的目光交汇，瞬间点燃了心底的火花。随着时间的推移，爱情的滋味愈发醇厚，像一杯陈年佳酿，愈久愈香。\n\n然而，爱情并非总是一帆风顺。生活的琐碎与压力，时常考验着彼此的信任与包容。争吵与误解在所难免，但正是这些波折，让我们更加珍惜彼此。每一次和解，都是心灵的重生，让爱情在磨砺中愈加坚韧。\n\n在这个快节奏的时代，爱情教会我们慢下来，去倾听对方的心声，去感受那份温暖。无论未来的路有多么曲折，只要心中有爱，便能携手共度每一个晨昏。爱情，是生命中最美的篇章，值得我们用心去书写。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, id='run--41034c77-3431-4eaf-9bfc-60c53eb9578d-0', usage_metadata={'input_tokens': 1962, 'output_tokens': 276, 'total_tokens': 2238, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='5c1631dd-5991-46b6-81f4-efb4fd875bd3'), HumanMessage(content='我写一个纯文本的500字的故事', additional_kwargs={}, response_metadata={}, id='db991f9b-26d0-4d6d-9757-422992f5c046'), AIMessage(content='在一个宁静的小镇上，住着一个名叫小雨的女孩。小雨从小就喜欢画画，她的梦想是成为一名出色的画家。每天放学后，她都会拿着画板，来到镇边的小河边，静静地观察周围的景色，捕捉那些转瞬即逝的美丽。\n\n小镇的四季分明，春天，河边的樱花盛开，粉色的花瓣随风飘落，像是下了一场花雨；夏天，绿树成荫，阳光透过树叶洒在水面上，波光粼粼；秋天，金黄的落叶在地上铺成了一条金色的地毯；冬天，白雪覆盖了整个小镇，仿佛一切都被银装素裹。\n\n小雨的画作总是充满了生机与色彩，然而，她的父母却希望她能专注于学业，考上一所好大学。小雨感到很矛盾，她不想放弃自己的梦想，但又不想让父母失望。于是，她开始在学习与画画之间寻找平衡。\n\n有一天，小雨在河边画画时，遇到了一个同样热爱艺术的男孩，名叫小风。小风的画风与小雨截然不同，他喜欢用大胆的色彩和夸张的线条表达自己的情感。两人一见如故，开始一起画画，分享彼此的创作灵感。\n\n随着时间的推移，小雨和小风的友谊愈发深厚。他们一起参加了镇上的艺术比赛，虽然没有获奖，但他们的作品却受到了大家的喜爱。小雨的父母看到女儿在艺术上的热情与才华，渐渐开始理解她的梦想，支持她继续追求自己的艺术之路。\n\n在小镇的每一个季节里，小雨和小风都在一起创作，记录下他们眼中的美丽。小雨的画作逐渐被更多的人认可，她的梦想也在不断实现。最终，她决定报考艺术学院，追寻更广阔的艺术天地。\n\n小雨明白，追逐梦想的路上会有许多挑战，但只要心中有爱与坚持，就一定能找到属于自己的光芒。小镇的四季依旧在变换，而小雨的心中，早已绘制出了一幅属于她自己的美丽画卷。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--ed6af3ba-8602-419c-8db7-8ff2bbf50cc6', usage_metadata={'input_tokens': 2236, 'output_tokens': 562, 'total_tokens': 2798, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}), SystemMessage(content='你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', additional_kwargs={}, response_metadata={}, id='b5e410f1-0d3d-4e64-bb8d-e54fb93f44ec'), HumanMessage(content='我写一个纯文本的500字的故事', additional_kwargs={}, response_metadata={}, id='924de36d-8394-4ede-8227-7a4ebe3d820f'), AIMessage(content='在一个遥远的小村庄里，住着一个名叫阿明的年轻人。阿明从小就对天空充满了向往，他常常仰望星空，梦想着有一天能飞上天去探索那无尽的宇宙。村子里的人们都认为他是个异想天开的孩子，认为他应该脚踏实地，做一些更实际的事情。\n\n尽管如此，阿明的梦想从未动摇。他开始研究飞行的原理，阅读关于鸟类和飞行器的书籍，甚至在村子里收集废弃的木材和布料，尝试自己制作一架飞行器。村民们看到他的努力，开始嘲笑他，认为他是在浪费时间。然而，阿明并没有放弃，他相信只要努力，就一定能实现自己的梦想。\n\n经过几个月的努力，阿明终于完成了他的飞行器。那是一个用木头和布料制成的简单结构，虽然看起来不太可靠，但阿明的心中充满了期待和兴奋。为了测试他的飞行器，阿明选择了村子附近的一座小山丘。那天，阳光明媚，微风拂面，阿明的心跳加速，他知道这是他梦想成真的时刻。\n\n他把飞行器推到山丘的边缘，深吸一口气，心中默念着：“我一定能飞起来！”然后，他用力一推，飞行器顺势滑下山坡，阿明紧紧抓住把手，感受到风在耳边呼啸。起初，他感到一阵恐慌，但很快，他发现飞行器竟然真的离开了地面，缓缓升空。\n\n阿明的心中充满了无比的喜悦，他在空中俯瞰着村庄，看到那些曾经嘲笑他的人们都惊讶地望着他。就在他沉浸在飞翔的快乐中时，飞行器突然开始剧烈晃动，阿明意识到自己需要控制好方向。他努力调整着飞行器的姿态，终于稳住了身形。\n\n然而，飞行器的结构并不牢固，随着时间的推移，阿明感到一阵不安。最终，飞行器在空中发出一声巨响，开始急速下坠。阿明闭上眼睛，心中默念着：“无论结果如何，我都不后悔。”他重重地摔在了地上，虽然受了些伤，但他却笑了。\n\n村民们围上来，惊讶地看着阿明。他们终于明白，追逐梦想的勇气和坚持是多么重要。阿明用自己的经历告诉大家，梦想并不是遥不可及的，只要努力，就一定能飞得更高。', additional_kwargs={}, response_metadata={'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, id='run--d75508be-88ff-4e07-8d16-4cf62449c5c6-0', usage_metadata={'input_tokens': 2796, 'output_tokens': 642, 'total_tokens': 3438, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}})]} interrupt_data=None
2025-06-24 11:28:17,755 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-05:8b70f4a8-779d-4df1-9b10-186cdc357b17
2025-06-24 11:28:17,758 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-05' session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' status='completed' message=None last_query='我写一个纯文本的500字的故事' last_updated=1750735697.746238 last_response=AgentResponse(session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17', status='completed', timestamp=1750735697.7433329, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '148ff5d2-5ed9-4215-8858-c5786186d42b'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '51b50e7f-937d-4f79-92e4-68a76b1a6d8f', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--370df195-201b-43e1-b269-014e34ffb584', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '107c5e4a-6ddd-4bcf-9919-1f90c11e3479'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c37a4a4f-7688-4e01-8a28-f3ad5393719b', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--bda34cd7-5347-48bd-a72b-a2d38c25999f-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'ee53c55e-6296-45a3-bcd5-ea60eeb4a731'}, {'content': '给我生成200字小作文，主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'a686fc6b-a21f-472b-9b05-f64b62f9482a', 'example': False}, {'content': '请提供一个主题，我将为您生成一篇200字的小作文。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--7633c32b-f9c6-40c3-ad21-cf56e7a37ed3', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1489, 'output_tokens': 18, 'total_tokens': 1507, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '3aa8935e-7f01-44ae-ab46-dd28bfdfac8d'}, {'content': '给我生成200字小作文，主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'e210449c-baf0-454a-8d66-d48fb9e205da', 'example': False}, {'content': '请提供一个具体的主题，我将为您生成一篇200字的小作文。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--f0f784c1-f5e2-48c6-b34e-bb8f31220677-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1543, 'output_tokens': 20, 'total_tokens': 1563, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '173b0a3a-2dc3-4e7f-90aa-66443ca2e9dd'}, {'content': '爱情主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'e1f59a36-2e4b-4849-b906-59d8a6520507', 'example': False}, {'content': '在这个喧嚣的城市中，爱情如同一缕清风，悄然无声地吹拂着每一个角落。初见时的心动，仿佛是春天的第一缕阳光，温暖而明亮。两个人的目光交汇，瞬间点燃了心底的火花。随着时间的推移，爱情的滋味愈发醇厚，像一杯陈年佳酿，愈久愈香。\n\n然而，爱情并非总是一帆风顺。生活的琐碎与压力，时常考验着彼此的信任与包容。争吵与误解在所难免，但正是这些波折，让我们更加珍惜彼此。每一次和解，都是心灵的重生，让爱情在磨砺中愈加坚韧。\n\n在这个快节奏的时代，爱情教会我们慢下来，去倾听对方的心声，去感受那份温暖。无论未来的路有多么曲折，只要心中有爱，便能携手共度每一个晨昏。爱情，是生命中最美的篇章，值得我们用心去书写。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--b6b9507b-ec1b-419b-9b8f-6cbc4ab87a09', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1592, 'output_tokens': 276, 'total_tokens': 1868, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '625485df-d63b-4a04-9eaa-53b1f42d67f1'}, {'content': '爱情主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'ba59f124-9106-4f5f-b76a-dbbfc375ad8f', 'example': False}, {'content': '', 'additional_kwargs': {'tool_calls': [{'index': 0, 'id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'function': {'arguments': '{"prompt":"A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection."}', 'name': 'generate_image'}, 'type': 'function'}]}, 'response_metadata': {'finish_reason': 'tool_calls', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--82f5f9ad-6aba-4ffb-819e-b47d0118ee25-0', 'example': False, 'tool_calls': [{'name': 'generate_image', 'args': {'prompt': 'A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection.'}, 'id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'type': 'tool_call'}], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1897, 'output_tokens': 41, 'total_tokens': 1938, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '该工具被拒绝使用，请尝试其他方法或拒绝回答问题。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'tool', 'name': 'generate_image', 'id': 'c1baca50-f453-4fdd-98e6-7ca334663e0c', 'tool_call_id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'artifact': None, 'status': 'success'}, {'content': '在这个喧嚣的城市中，爱情如同一缕清风，悄然无声地吹拂着每一个角落。初见时的心动，仿佛是春天的第一缕阳光，温暖而明亮。两个人的目光交汇，瞬间点燃了心底的火花。随着时间的推移，爱情的滋味愈发醇厚，像一杯陈年佳酿，愈久愈香。\n\n然而，爱情并非总是一帆风顺。生活的琐碎与压力，时常考验着彼此的信任与包容。争吵与误解在所难免，但正是这些波折，让我们更加珍惜彼此。每一次和解，都是心灵的重生，让爱情在磨砺中愈加坚韧。\n\n在这个快节奏的时代，爱情教会我们慢下来，去倾听对方的心声，去感受那份温暖。无论未来的路有多么曲折，只要心中有爱，便能携手共度每一个晨昏。爱情，是生命中最美的篇章，值得我们用心去书写。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--41034c77-3431-4eaf-9bfc-60c53eb9578d-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1962, 'output_tokens': 276, 'total_tokens': 2238, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '5c1631dd-5991-46b6-81f4-efb4fd875bd3'}, {'content': '我写一个纯文本的500字的故事', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'db991f9b-26d0-4d6d-9757-422992f5c046', 'example': False}, {'content': '在一个宁静的小镇上，住着一个名叫小雨的女孩。小雨从小就喜欢画画，她的梦想是成为一名出色的画家。每天放学后，她都会拿着画板，来到镇边的小河边，静静地观察周围的景色，捕捉那些转瞬即逝的美丽。\n\n小镇的四季分明，春天，河边的樱花盛开，粉色的花瓣随风飘落，像是下了一场花雨；夏天，绿树成荫，阳光透过树叶洒在水面上，波光粼粼；秋天，金黄的落叶在地上铺成了一条金色的地毯；冬天，白雪覆盖了整个小镇，仿佛一切都被银装素裹。\n\n小雨的画作总是充满了生机与色彩，然而，她的父母却希望她能专注于学业，考上一所好大学。小雨感到很矛盾，她不想放弃自己的梦想，但又不想让父母失望。于是，她开始在学习与画画之间寻找平衡。\n\n有一天，小雨在河边画画时，遇到了一个同样热爱艺术的男孩，名叫小风。小风的画风与小雨截然不同，他喜欢用大胆的色彩和夸张的线条表达自己的情感。两人一见如故，开始一起画画，分享彼此的创作灵感。\n\n随着时间的推移，小雨和小风的友谊愈发深厚。他们一起参加了镇上的艺术比赛，虽然没有获奖，但他们的作品却受到了大家的喜爱。小雨的父母看到女儿在艺术上的热情与才华，渐渐开始理解她的梦想，支持她继续追求自己的艺术之路。\n\n在小镇的每一个季节里，小雨和小风都在一起创作，记录下他们眼中的美丽。小雨的画作逐渐被更多的人认可，她的梦想也在不断实现。最终，她决定报考艺术学院，追寻更广阔的艺术天地。\n\n小雨明白，追逐梦想的路上会有许多挑战，但只要心中有爱与坚持，就一定能找到属于自己的光芒。小镇的四季依旧在变换，而小雨的心中，早已绘制出了一幅属于她自己的美丽画卷。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--ed6af3ba-8602-419c-8db7-8ff2bbf50cc6', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 2236, 'output_tokens': 562, 'total_tokens': 2798, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'b5e410f1-0d3d-4e64-bb8d-e54fb93f44ec'}, {'content': '我写一个纯文本的500字的故事', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '924de36d-8394-4ede-8227-7a4ebe3d820f', 'example': False}, {'content': '在一个遥远的小村庄里，住着一个名叫阿明的年轻人。阿明从小就对天空充满了向往，他常常仰望星空，梦想着有一天能飞上天去探索那无尽的宇宙。村子里的人们都认为他是个异想天开的孩子，认为他应该脚踏实地，做一些更实际的事情。\n\n尽管如此，阿明的梦想从未动摇。他开始研究飞行的原理，阅读关于鸟类和飞行器的书籍，甚至在村子里收集废弃的木材和布料，尝试自己制作一架飞行器。村民们看到他的努力，开始嘲笑他，认为他是在浪费时间。然而，阿明并没有放弃，他相信只要努力，就一定能实现自己的梦想。\n\n经过几个月的努力，阿明终于完成了他的飞行器。那是一个用木头和布料制成的简单结构，虽然看起来不太可靠，但阿明的心中充满了期待和兴奋。为了测试他的飞行器，阿明选择了村子附近的一座小山丘。那天，阳光明媚，微风拂面，阿明的心跳加速，他知道这是他梦想成真的时刻。\n\n他把飞行器推到山丘的边缘，深吸一口气，心中默念着：“我一定能飞起来！”然后，他用力一推，飞行器顺势滑下山坡，阿明紧紧抓住把手，感受到风在耳边呼啸。起初，他感到一阵恐慌，但很快，他发现飞行器竟然真的离开了地面，缓缓升空。\n\n阿明的心中充满了无比的喜悦，他在空中俯瞰着村庄，看到那些曾经嘲笑他的人们都惊讶地望着他。就在他沉浸在飞翔的快乐中时，飞行器突然开始剧烈晃动，阿明意识到自己需要控制好方向。他努力调整着飞行器的姿态，终于稳住了身形。\n\n然而，飞行器的结构并不牢固，随着时间的推移，阿明感到一阵不安。最终，飞行器在空中发出一声巨响，开始急速下坠。阿明闭上眼睛，心中默念着：“无论结果如何，我都不后悔。”他重重地摔在了地上，虽然受了些伤，但他却笑了。\n\n村民们围上来，惊讶地看着阿明。他们终于明白，追逐梦想的勇气和坚持是多么重要。阿明用自己的经历告诉大家，梦想并不是遥不可及的，只要努力，就一定能飞得更高。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--d75508be-88ff-4e07-8d16-4cf62449c5c6-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 2796, 'output_tokens': 642, 'total_tokens': 3438, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
2025-06-24 11:28:29,152 - __main__ - INFO - 调用/agent/status/接口，获取指定用户当前会话的状态数据，接受到前端用户请求:test-ztl-05:8b70f4a8-779d-4df1-9b10-186cdc357b17
2025-06-24 11:28:29,155 - __main__ - INFO - 返回当前用户的会话状态:user_id='test-ztl-05' session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17' status='completed' message=None last_query='我写一个纯文本的500字的故事' last_updated=1750735697.746238 last_response=AgentResponse(session_id='8b70f4a8-779d-4df1-9b10-186cdc357b17', status='completed', timestamp=1750735697.7433329, message=None, result={'messages': [{'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '148ff5d2-5ed9-4215-8858-c5786186d42b'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '51b50e7f-937d-4f79-92e4-68a76b1a6d8f', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--370df195-201b-43e1-b269-014e34ffb584', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1403, 'output_tokens': 11, 'total_tokens': 1414, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '107c5e4a-6ddd-4bcf-9919-1f90c11e3479'}, {'content': '你好', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'c37a4a4f-7688-4e01-8a28-f3ad5393719b', 'example': False}, {'content': '你好！有什么我可以帮助你的吗？', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--bda34cd7-5347-48bd-a72b-a2d38c25999f-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1442, 'output_tokens': 11, 'total_tokens': 1453, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'ee53c55e-6296-45a3-bcd5-ea60eeb4a731'}, {'content': '给我生成200字小作文，主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'a686fc6b-a21f-472b-9b05-f64b62f9482a', 'example': False}, {'content': '请提供一个主题，我将为您生成一篇200字的小作文。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--7633c32b-f9c6-40c3-ad21-cf56e7a37ed3', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1489, 'output_tokens': 18, 'total_tokens': 1507, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '3aa8935e-7f01-44ae-ab46-dd28bfdfac8d'}, {'content': '给我生成200字小作文，主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'e210449c-baf0-454a-8d66-d48fb9e205da', 'example': False}, {'content': '请提供一个具体的主题，我将为您生成一篇200字的小作文。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--f0f784c1-f5e2-48c6-b34e-bb8f31220677-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1543, 'output_tokens': 20, 'total_tokens': 1563, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '173b0a3a-2dc3-4e7f-90aa-66443ca2e9dd'}, {'content': '爱情主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'e1f59a36-2e4b-4849-b906-59d8a6520507', 'example': False}, {'content': '在这个喧嚣的城市中，爱情如同一缕清风，悄然无声地吹拂着每一个角落。初见时的心动，仿佛是春天的第一缕阳光，温暖而明亮。两个人的目光交汇，瞬间点燃了心底的火花。随着时间的推移，爱情的滋味愈发醇厚，像一杯陈年佳酿，愈久愈香。\n\n然而，爱情并非总是一帆风顺。生活的琐碎与压力，时常考验着彼此的信任与包容。争吵与误解在所难免，但正是这些波折，让我们更加珍惜彼此。每一次和解，都是心灵的重生，让爱情在磨砺中愈加坚韧。\n\n在这个快节奏的时代，爱情教会我们慢下来，去倾听对方的心声，去感受那份温暖。无论未来的路有多么曲折，只要心中有爱，便能携手共度每一个晨昏。爱情，是生命中最美的篇章，值得我们用心去书写。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--b6b9507b-ec1b-419b-9b8f-6cbc4ab87a09', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1592, 'output_tokens': 276, 'total_tokens': 1868, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '625485df-d63b-4a04-9eaa-53b1f42d67f1'}, {'content': '爱情主题', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'ba59f124-9106-4f5f-b76a-dbbfc375ad8f', 'example': False}, {'content': '', 'additional_kwargs': {'tool_calls': [{'index': 0, 'id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'function': {'arguments': '{"prompt":"A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection."}', 'name': 'generate_image'}, 'type': 'function'}]}, 'response_metadata': {'finish_reason': 'tool_calls', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--82f5f9ad-6aba-4ffb-819e-b47d0118ee25-0', 'example': False, 'tool_calls': [{'name': 'generate_image', 'args': {'prompt': 'A romantic scene depicting love, with a couple holding hands under a sunset, surrounded by flowers and soft lighting, conveying warmth and affection.'}, 'id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'type': 'tool_call'}], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1897, 'output_tokens': 41, 'total_tokens': 1938, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '该工具被拒绝使用，请尝试其他方法或拒绝回答问题。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'tool', 'name': 'generate_image', 'id': 'c1baca50-f453-4fdd-98e6-7ca334663e0c', 'tool_call_id': 'call_ekDvX0n8uqeQFb4BIDRL69rL', 'artifact': None, 'status': 'success'}, {'content': '在这个喧嚣的城市中，爱情如同一缕清风，悄然无声地吹拂着每一个角落。初见时的心动，仿佛是春天的第一缕阳光，温暖而明亮。两个人的目光交汇，瞬间点燃了心底的火花。随着时间的推移，爱情的滋味愈发醇厚，像一杯陈年佳酿，愈久愈香。\n\n然而，爱情并非总是一帆风顺。生活的琐碎与压力，时常考验着彼此的信任与包容。争吵与误解在所难免，但正是这些波折，让我们更加珍惜彼此。每一次和解，都是心灵的重生，让爱情在磨砺中愈加坚韧。\n\n在这个快节奏的时代，爱情教会我们慢下来，去倾听对方的心声，去感受那份温暖。无论未来的路有多么曲折，只要心中有爱，便能携手共度每一个晨昏。爱情，是生命中最美的篇章，值得我们用心去书写。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_7a53abb7a2'}, 'type': 'ai', 'name': None, 'id': 'run--41034c77-3431-4eaf-9bfc-60c53eb9578d-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 1962, 'output_tokens': 276, 'total_tokens': 2238, 'input_token_details': {'audio': 0, 'cache_read': 1408}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': '5c1631dd-5991-46b6-81f4-efb4fd875bd3'}, {'content': '我写一个纯文本的500字的故事', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': 'db991f9b-26d0-4d6d-9757-422992f5c046', 'example': False}, {'content': '在一个宁静的小镇上，住着一个名叫小雨的女孩。小雨从小就喜欢画画，她的梦想是成为一名出色的画家。每天放学后，她都会拿着画板，来到镇边的小河边，静静地观察周围的景色，捕捉那些转瞬即逝的美丽。\n\n小镇的四季分明，春天，河边的樱花盛开，粉色的花瓣随风飘落，像是下了一场花雨；夏天，绿树成荫，阳光透过树叶洒在水面上，波光粼粼；秋天，金黄的落叶在地上铺成了一条金色的地毯；冬天，白雪覆盖了整个小镇，仿佛一切都被银装素裹。\n\n小雨的画作总是充满了生机与色彩，然而，她的父母却希望她能专注于学业，考上一所好大学。小雨感到很矛盾，她不想放弃自己的梦想，但又不想让父母失望。于是，她开始在学习与画画之间寻找平衡。\n\n有一天，小雨在河边画画时，遇到了一个同样热爱艺术的男孩，名叫小风。小风的画风与小雨截然不同，他喜欢用大胆的色彩和夸张的线条表达自己的情感。两人一见如故，开始一起画画，分享彼此的创作灵感。\n\n随着时间的推移，小雨和小风的友谊愈发深厚。他们一起参加了镇上的艺术比赛，虽然没有获奖，但他们的作品却受到了大家的喜爱。小雨的父母看到女儿在艺术上的热情与才华，渐渐开始理解她的梦想，支持她继续追求自己的艺术之路。\n\n在小镇的每一个季节里，小雨和小风都在一起创作，记录下他们眼中的美丽。小雨的画作逐渐被更多的人认可，她的梦想也在不断实现。最终，她决定报考艺术学院，追寻更广阔的艺术天地。\n\n小雨明白，追逐梦想的路上会有许多挑战，但只要心中有爱与坚持，就一定能找到属于自己的光芒。小镇的四季依旧在变换，而小雨的心中，早已绘制出了一幅属于她自己的美丽画卷。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--ed6af3ba-8602-419c-8db7-8ff2bbf50cc6', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 2236, 'output_tokens': 562, 'total_tokens': 2798, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}, {'content': '你会使用工具来帮助用户。如果工具使用被拒绝，请提示用户。', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'system', 'name': None, 'id': 'b5e410f1-0d3d-4e64-bb8d-e54fb93f44ec'}, {'content': '我写一个纯文本的500字的故事', 'additional_kwargs': {}, 'response_metadata': {}, 'type': 'human', 'name': None, 'id': '924de36d-8394-4ede-8227-7a4ebe3d820f', 'example': False}, {'content': '在一个遥远的小村庄里，住着一个名叫阿明的年轻人。阿明从小就对天空充满了向往，他常常仰望星空，梦想着有一天能飞上天去探索那无尽的宇宙。村子里的人们都认为他是个异想天开的孩子，认为他应该脚踏实地，做一些更实际的事情。\n\n尽管如此，阿明的梦想从未动摇。他开始研究飞行的原理，阅读关于鸟类和飞行器的书籍，甚至在村子里收集废弃的木材和布料，尝试自己制作一架飞行器。村民们看到他的努力，开始嘲笑他，认为他是在浪费时间。然而，阿明并没有放弃，他相信只要努力，就一定能实现自己的梦想。\n\n经过几个月的努力，阿明终于完成了他的飞行器。那是一个用木头和布料制成的简单结构，虽然看起来不太可靠，但阿明的心中充满了期待和兴奋。为了测试他的飞行器，阿明选择了村子附近的一座小山丘。那天，阳光明媚，微风拂面，阿明的心跳加速，他知道这是他梦想成真的时刻。\n\n他把飞行器推到山丘的边缘，深吸一口气，心中默念着：“我一定能飞起来！”然后，他用力一推，飞行器顺势滑下山坡，阿明紧紧抓住把手，感受到风在耳边呼啸。起初，他感到一阵恐慌，但很快，他发现飞行器竟然真的离开了地面，缓缓升空。\n\n阿明的心中充满了无比的喜悦，他在空中俯瞰着村庄，看到那些曾经嘲笑他的人们都惊讶地望着他。就在他沉浸在飞翔的快乐中时，飞行器突然开始剧烈晃动，阿明意识到自己需要控制好方向。他努力调整着飞行器的姿态，终于稳住了身形。\n\n然而，飞行器的结构并不牢固，随着时间的推移，阿明感到一阵不安。最终，飞行器在空中发出一声巨响，开始急速下坠。阿明闭上眼睛，心中默念着：“无论结果如何，我都不后悔。”他重重地摔在了地上，虽然受了些伤，但他却笑了。\n\n村民们围上来，惊讶地看着阿明。他们终于明白，追逐梦想的勇气和坚持是多么重要。阿明用自己的经历告诉大家，梦想并不是遥不可及的，只要努力，就一定能飞得更高。', 'additional_kwargs': {}, 'response_metadata': {'finish_reason': 'stop', 'model_name': 'gpt-4o-mini-2024-07-18', 'system_fingerprint': 'fp_57db37749c'}, 'type': 'ai', 'name': None, 'id': 'run--d75508be-88ff-4e07-8d16-4cf62449c5c6-0', 'example': False, 'tool_calls': [], 'invalid_tool_calls': [], 'usage_metadata': {'input_tokens': 2796, 'output_tokens': 642, 'total_tokens': 3438, 'input_token_details': {'audio': 0, 'cache_read': 0}, 'output_token_details': {'audio': 0, 'reasoning': 0}}}]}, interrupt_data=None)
